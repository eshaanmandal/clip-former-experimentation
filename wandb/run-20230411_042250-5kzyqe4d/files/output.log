################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1



100%|█████████████████████████████████████████| 200/200 [00:08<00:00, 22.62it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.7176795443147421





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 29.78it/s]
AUC score for epoch 1 : 0.8029501438140869
Saving the best model
Best AUC score is 0.8029501438140869
Epoch 2



100%|█████████████████████████████████████████| 200/200 [00:06<00:00, 30.29it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.18402404006104917





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 28.76it/s]
AUC score for epoch 2 : 0.813930332660675
Saving the best model
Best AUC score is 0.813930332660675
Epoch 3



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.97it/s]
train loss = 0.08935072727850639
Performing evaluation of epoch 3





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 27.96it/s]
AUC score for epoch 3 : 0.8196600675582886
Saving the best model
Best AUC score is 0.8196600675582886
Epoch 4



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.33it/s]
train loss = 0.06055746724188794
Performing evaluation of epoch 4




100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 31.42it/s]
AUC score for epoch 4 : 0.8201622366905212
Saving the best model
Best AUC score is 0.8201622366905212
Epoch 5



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.59it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.045605711778334806





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 28.96it/s]
AUC score for epoch 5 : 0.8193413019180298
Best AUC score is 0.8201622366905212
Epoch 6



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.43it/s]
train loss = 0.03593524256706587
Performing evaluation of epoch 6





100%|█████████████████████████████████████████| 290/290 [00:11<00:00, 25.97it/s]
AUC score for epoch 6 : 0.828676164150238
Saving the best model
Best AUC score is 0.828676164150238
Epoch 7




100%|█████████████████████████████████████████| 200/200 [00:08<00:00, 24.62it/s]
train loss = 0.04678205897085718
Performing evaluation of epoch 7





100%|█████████████████████████████████████████| 290/290 [00:11<00:00, 24.82it/s]
AUC score for epoch 7 : 0.8266183137893677
Best AUC score is 0.828676164150238
Epoch 8



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.46it/s]
train loss = 0.03673326702308259
Performing evaluation of epoch 8





100%|█████████████████████████████████████████| 290/290 [00:11<00:00, 24.42it/s]
AUC score for epoch 8 : 0.8267113566398621
Best AUC score is 0.828676164150238
Epoch 9



100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.09it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.0424588250942179





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 27.41it/s]
AUC score for epoch 9 : 0.8273234963417053
Best AUC score is 0.828676164150238
Epoch 10



100%|████████████████████████████████████████▊| 199/200 [00:06<00:00, 54.98it/s]
100%|█████████████████████████████████████████| 200/200 [00:07<00:00, 27.48it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.21it/s]
  0%|                                                   | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.8313897252082825
Saving the best model
Best AUC score is 0.8313897252082825
BEST TEST AUC:  0.8313897252082825
Loading the best model

100%|█████████████████████████████████████████| 197/197 [00:03<00:00, 54.69it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████| 210/210 [00:06<00:00, 33.28it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.026603026744227723




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 36.37it/s]
AUC score for epoch 1 : 0.8335332274436951
Saving the best model
Best AUC score is 0.8335332274436951
Epoch 2


100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 29.61it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.022528834342249737




100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 32.19it/s]
AUC score for epoch 2 : 0.8332842588424683
Best AUC score is 0.8335332274436951
Epoch 3



100%|█████████████████████████████████████████| 210/210 [00:06<00:00, 30.11it/s]
train loss = 0.022990778015706124
Performing evaluation of epoch 3




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.84it/s]
AUC score for epoch 3 : 0.8352939486503601
Saving the best model
Best AUC score is 0.8352939486503601
Epoch 4



 95%|███████████████████████████████████████  | 200/210 [00:06<00:00, 39.35it/s]
train loss = 0.01796128117452359
100%|█████████████████████████████████████████| 210/210 [00:06<00:00, 30.41it/s]





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 29.54it/s]
AUC score for epoch 4 : 0.8340343832969666
Best AUC score is 0.8352939486503601
Epoch 5



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 26.55it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.018344981640915477






100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 21.74it/s]
AUC score for epoch 5 : 0.8364817500114441
Saving the best model
Best AUC score is 0.8364817500114441
Epoch 6




100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 26.23it/s]
train loss = 0.02390700108475617
Performing evaluation of epoch 6






100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 20.55it/s]
AUC score for epoch 6 : 0.8333290219306946
Best AUC score is 0.8364817500114441
Epoch 7



 98%|████████████████████████████████████████▏| 206/210 [00:07<00:00, 41.53it/s]
100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 25.93it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]






100%|█████████████████████████████████████████| 290/290 [00:11<00:00, 24.46it/s]
AUC score for epoch 7 : 0.8329895734786987
Best AUC score is 0.8364817500114441
Epoch 8



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 26.42it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.020675490359142366






100%|█████████████████████████████████████████| 290/290 [00:15<00:00, 18.54it/s]
AUC score for epoch 8 : 0.8338302373886108
Best AUC score is 0.8364817500114441
Epoch 9




100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 24.28it/s]
train loss = 0.009930533631337486
Performing evaluation of epoch 9







100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 20.51it/s]
AUC score for epoch 9 : 0.8316475749015808
Best AUC score is 0.8364817500114441
Epoch 10




100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 24.97it/s]
train loss = 0.011007194214159556
Performing evaluation of epoch 10






100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 19.79it/s]
AUC score for epoch 10 : 0.835722804069519
Best AUC score is 0.8364817500114441
BEST TEST AUC:  0.8364817500114441
Loading the best model
Getting prediction on unlabelled dataset:

100%|█████████████████████████████████████████| 197/197 [00:05<00:00, 36.02it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 28.57it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.031634109439411466






100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 21.54it/s]
AUC score for epoch 1 : 0.8327049016952515
Best AUC score is 0.8364817500114441
Epoch 2



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 26.59it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.01557523966496644






100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 20.93it/s]
AUC score for epoch 2 : 0.8366031050682068
Saving the best model
Best AUC score is 0.8366031050682068
Epoch 3



100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 24.72it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.011882256759417942





100%|█████████████████████████████████████████| 290/290 [00:11<00:00, 24.69it/s]
AUC score for epoch 3 : 0.8376659154891968
Saving the best model
Best AUC score is 0.8376659154891968
Epoch 4



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 26.29it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.028611996475124864







100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 19.52it/s]
AUC score for epoch 4 : 0.8416475653648376
Saving the best model
Best AUC score is 0.8416475653648376
Epoch 5




100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 27.50it/s]
train loss = 0.020484827528673036
Performing evaluation of epoch 5







100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 19.90it/s]
AUC score for epoch 5 : 0.8397282361984253
Best AUC score is 0.8416475653648376
Epoch 6




100%|█████████████████████████████████████████| 210/210 [00:09<00:00, 23.32it/s]
train loss = 0.009363965533581601
Performing evaluation of epoch 6







100%|█████████████████████████████████████████| 290/290 [00:14<00:00, 20.65it/s]
AUC score for epoch 6 : 0.837559700012207
Best AUC score is 0.8416475653648376
Epoch 7



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 27.69it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.03369925857528176






100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 22.29it/s]
AUC score for epoch 7 : 0.839876651763916
Best AUC score is 0.8416475653648376
Epoch 8



100%|█████████████████████████████████████████| 210/210 [00:08<00:00, 26.24it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.022651042001719666






100%|█████████████████████████████████████████| 290/290 [00:12<00:00, 22.50it/s]
AUC score for epoch 8 : 0.8381611108779907
Best AUC score is 0.8416475653648376
Epoch 9



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 29.14it/s]
train loss = 0.02289736933900193
Performing evaluation of epoch 9







100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 21.00it/s]
AUC score for epoch 9 : 0.8364672660827637
Best AUC score is 0.8416475653648376
Epoch 10



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 29.24it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.015573124932121747





100%|█████████████████████████████████████████| 290/290 [00:12<00:00, 23.51it/s]
  0%|                                                   | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.8405801057815552
Best AUC score is 0.8416475653648376
BEST TEST AUC:  0.8416475653648376
Loading the best model

 74%|█████████████████████████████▍          | 145/197 [00:04<00:00, 112.52it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████| 197/197 [00:05<00:00, 35.56it/s]



100%|█████████████████████████████████████████| 210/210 [00:07<00:00, 27.78it/s]
train loss = 0.024915907251315296
Performing evaluation of epoch 1






100%|█████████████████████████████████████████| 290/290 [00:13<00:00, 20.91it/s]
AUC score for epoch 1 : 0.8358535170555115
Best AUC score is 0.8416475653648376
Epoch 2
  0%|▏                                     | 1/210 [18:41<65:06:41, 1121.54s/it]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 141, in train_once
    loss = train(epoch, model, optimizer, device, [train_anomaly_dl, train_normal_dl], train_bs)
  File "main.py", line 33, in train
    for anomaly, normal in tqdm(zip(anomaly_dl, normal_dl), total=l):
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1272, in _get_data
    success, data = self._try_get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
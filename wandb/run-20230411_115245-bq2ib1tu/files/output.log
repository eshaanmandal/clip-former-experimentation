################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 23/25 [00:05<00:00, 14.33it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.40it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.62it/s]
AUC score for epoch 1 : 0.7815144658088684
Saving the best model
Best AUC score is 0.7815144658088684
Epoch 2

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:03<00:00,  6.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.8875037503242492





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.45it/s]
AUC score for epoch 2 : 0.7933095693588257
Saving the best model
Best AUC score is 0.7933095693588257
Epoch 3



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.99it/s]
train loss = 0.7405526661872863
Performing evaluation of epoch 3





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.53it/s]
AUC score for epoch 3 : 0.7972840666770935
Saving the best model
Best AUC score is 0.7972840666770935
Epoch 4

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00, 18.11it/s]
train loss = 0.5199940168857574
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.24it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.69it/s]
AUC score for epoch 4 : 0.7991620302200317
Saving the best model
Best AUC score is 0.7991620302200317
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.44it/s]
train loss = 0.29731170475482943
Performing evaluation of epoch 5





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.31it/s]
AUC score for epoch 5 : 0.797488808631897
Best AUC score is 0.7991620302200317
Epoch 6

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.41it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15414229810237884






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.05it/s]
AUC score for epoch 6 : 0.7963986396789551
Best AUC score is 0.7991620302200317
Epoch 7

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:03<00:00,  6.75it/s]
train loss = 0.0740753185749054
Performing evaluation of epoch 7





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.02it/s]
AUC score for epoch 7 : 0.8004165887832642
Saving the best model
Best AUC score is 0.8004165887832642
Epoch 8

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.76it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.043611357659101485





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.83it/s]
AUC score for epoch 8 : 0.7993730902671814
Best AUC score is 0.8004165887832642
Epoch 9


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:03<00:00,  7.27it/s]
train loss = 0.02402502667158842
Performing evaluation of epoch 9




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.89it/s]
AUC score for epoch 9 : 0.7977498769760132
Best AUC score is 0.8004165887832642
Epoch 10


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.08it/s]
train loss = 0.016420411132276058
Performing evaluation of epoch 10




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.90it/s]
AUC score for epoch 10 : 0.7976365089416504
Best AUC score is 0.8004165887832642
Epoch 11


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.05it/s]
train loss = 0.011347856167703866
Performing evaluation of epoch 11






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.56it/s]
AUC score for epoch 11 : 0.7987912893295288
Best AUC score is 0.8004165887832642
Epoch 12

 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                           | 21/25 [00:06<00:00, 12.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.64it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.97it/s]
AUC score for epoch 12 : 0.7987895011901855
Best AUC score is 0.8004165887832642
Epoch 13


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.93it/s]
train loss = 0.008542985515668988
Performing evaluation of epoch 13





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.13it/s]
AUC score for epoch 13 : 0.7975285649299622
Best AUC score is 0.8004165887832642
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.69it/s]
train loss = 0.006682490725070238
Performing evaluation of epoch 14




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.65it/s]
AUC score for epoch 14 : 0.7994723320007324
Best AUC score is 0.8004165887832642
Epoch 15


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.32it/s]
train loss = 0.005833998238667846
Performing evaluation of epoch 15





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.20it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7990604639053345
Best AUC score is 0.8004165887832642
BEST TEST AUC:  0.8004165887832642
Loading the best model

 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████                                                                     | 118/197 [00:02<00:00, 90.95it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 51.62it/s]

 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 13.24it/s]
train loss = 0.047346355327005894
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.43it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.66it/s]
AUC score for epoch 1 : 0.799186646938324
Best AUC score is 0.8004165887832642
Epoch 2


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.07it/s]
train loss = 0.025332042814365456
Performing evaluation of epoch 2




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.67it/s]
AUC score for epoch 2 : 0.7982704639434814
Best AUC score is 0.8004165887832642
Epoch 3

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.08it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.01699658754348223





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.85it/s]
AUC score for epoch 3 : 0.79802405834198
Best AUC score is 0.8004165887832642
Epoch 4


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.09it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.008301046011703355




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.78it/s]
AUC score for epoch 4 : 0.7979608178138733
Best AUC score is 0.8004165887832642
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.34it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.011096338176035456




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.38it/s]
AUC score for epoch 5 : 0.7997344136238098
Best AUC score is 0.8004165887832642
Epoch 6


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.79it/s]
train loss = 0.005373796439796154
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.29it/s]
AUC score for epoch 6 : 0.7974996566772461
Best AUC score is 0.8004165887832642
Epoch 7


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.84it/s]
train loss = 0.004919915285427123
Performing evaluation of epoch 7




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.01it/s]
AUC score for epoch 7 : 0.796607255935669
Best AUC score is 0.8004165887832642
Epoch 8

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.37it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.004194265015290252





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.40it/s]
AUC score for epoch 8 : 0.7968718409538269
Best AUC score is 0.8004165887832642
Epoch 9

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.69it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003092018750196855






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.17it/s]
AUC score for epoch 9 : 0.79765784740448
Best AUC score is 0.8004165887832642
Epoch 10


 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:03<00:00, 13.62it/s]
train loss = 0.0031095520451864494
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.87it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.62it/s]
AUC score for epoch 10 : 0.7968413829803467
Best AUC score is 0.8004165887832642
Epoch 11



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
train loss = 0.002912710907237072
Performing evaluation of epoch 11




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.67it/s]
AUC score for epoch 11 : 0.796554684638977
Best AUC score is 0.8004165887832642
Epoch 12


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002551668236264959




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.39it/s]
AUC score for epoch 12 : 0.7969033122062683
Best AUC score is 0.8004165887832642
Epoch 13

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.62it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002051194048752742





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.55it/s]
AUC score for epoch 13 : 0.7970293760299683
Best AUC score is 0.8004165887832642
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.28it/s]
train loss = 0.0020470707594150944
Performing evaluation of epoch 14





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.62it/s]
AUC score for epoch 14 : 0.7968733310699463
Best AUC score is 0.8004165887832642
Epoch 15

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.50it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002277242888729753

  8%|█████████████▋                                                                                                                                                               | 23/290 [00:03<00:40,  6.64it/s]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 143, in train_once
    auc = test(epoch, model, optimizer, device, val_dl, valid_bs, num_feats)
  File "main.py", line 69, in test
    for clip_fts, num_frames, video_gt in tqdm(val_dl):
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1282, in _get_data
    success, data = self._try_get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/queues.py", line 116, in get
    return _ForkingPickler.loads(res)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/multiprocessing/reductions.py", line 305, in rebuild_storage_fd
    fd = df.detach()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/resource_sharer.py", line 87, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/connection.py", line 508, in Client
    answer_challenge(c, authkey)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/connection.py", line 756, in answer_challenge
    connection.send_bytes(digest)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/connection.py", line 200, in send_bytes
    self._send_bytes(m[offset:offset + size])
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/connection.py", line 411, in _send_bytes
    self._send(header + buf)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/multiprocessing/connection.py", line 368, in _send
    n = write(self._handle, buf)
KeyboardInterrupt
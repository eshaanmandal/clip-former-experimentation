################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 31.57it/s]
train loss = 0.540665981870261
Performing evaluation of epoch 1




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.06it/s]
AUC score for epoch 1 : 0.82524174451828
Saving the best model
Best AUC score is 0.82524174451828
Epoch 2









100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:20<00:00, 38.62it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.2689746670464228




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.01it/s]
AUC score for epoch 2 : 0.8404194712638855
Saving the best model
Best AUC score is 0.8404194712638855
Epoch 3











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:23<00:00, 33.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.23289943164490978




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.53it/s]
AUC score for epoch 3 : 0.8445367813110352
Saving the best model
Best AUC score is 0.8445367813110352
Epoch 4











 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 784/800 [00:24<00:00, 40.98it/s]
train loss = 0.21186340330370512
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:24<00:00, 32.49it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.54it/s]
AUC score for epoch 4 : 0.8480603694915771
Saving the best model
Best AUC score is 0.8480603694915771
Epoch 5










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:22<00:00, 36.34it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.18957677091730146





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.32it/s]
AUC score for epoch 5 : 0.8482797145843506
Saving the best model
Best AUC score is 0.8482797145843506
Epoch 6











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:22<00:00, 35.25it/s]
train loss = 0.181800799344237
Performing evaluation of epoch 6





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.23it/s]
AUC score for epoch 6 : 0.8502848744392395
Saving the best model
Best AUC score is 0.8502848744392395
Epoch 7








 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎          | 750/800 [00:16<00:01, 47.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:17<00:00, 46.06it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.92it/s]
AUC score for epoch 7 : 0.8474341630935669
Best AUC score is 0.8502848744392395
Epoch 8










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:22<00:00, 36.34it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15598006265779077






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.84it/s]
AUC score for epoch 8 : 0.8501495718955994
Best AUC score is 0.8502848744392395
Epoch 9











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:22<00:00, 35.65it/s]
train loss = 0.15457055390894653
Performing evaluation of epoch 9




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.50it/s]
AUC score for epoch 9 : 0.8398453593254089
Best AUC score is 0.8502848744392395
Epoch 10
  0%|▍                                                                                                                                                                         | 2/800 [09:08<60:47:49, 274.27s/it]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 141, in train_once
    loss = train(epoch, model, optimizer, device, [train_anomaly_dl, train_normal_dl], train_bs)
  File "main.py", line 33, in train
    for anomaly, normal in tqdm(zip(anomaly_dl, normal_dl), total=l):
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1272, in _get_data
    success, data = self._try_get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1













 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊  | 790/800 [00:27<00:00, 44.83it/s]

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:28<00:00, 28.35it/s]
Performing evaluation of epoch 1






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.50it/s]
AUC score for epoch 1 : 0.7850629091262817
Saving the best model
Best AUC score is 0.7850629091262817
Epoch 2












 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 779/800 [00:25<00:00, 47.36it/s]
train loss = 0.8720768348127603
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:26<00:00, 30.61it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.69it/s]
AUC score for epoch 2 : 0.7981864809989929
Saving the best model
Best AUC score is 0.7981864809989929
Epoch 3













 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉         | 758/800 [00:26<00:01, 26.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:27<00:00, 28.68it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.59it/s]
AUC score for epoch 3 : 0.8042142987251282
Saving the best model
Best AUC score is 0.8042142987251282
Epoch 4












 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊     | 776/800 [00:24<00:00, 43.44it/s]
train loss = 0.5692456581257284
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 31.37it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.48it/s]
AUC score for epoch 4 : 0.8085119128227234
Saving the best model
Best AUC score is 0.8085119128227234
Epoch 5













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:26<00:00, 30.41it/s]
train loss = 0.46859216844663026
Performing evaluation of epoch 5




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.99it/s]
AUC score for epoch 5 : 0.8117358088493347
Saving the best model
Best AUC score is 0.8117358088493347
Epoch 6












 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍ | 793/800 [00:25<00:00, 64.52it/s]
train loss = 0.4096264161169529
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 30.94it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.84it/s]
AUC score for epoch 6 : 0.8152663111686707
Saving the best model
Best AUC score is 0.8152663111686707
Epoch 7












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 31.73it/s]
train loss = 0.3747043566661887
Performing evaluation of epoch 7






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.50it/s]
AUC score for epoch 7 : 0.8183035850524902
Saving the best model
Best AUC score is 0.8183035850524902
Epoch 8













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:26<00:00, 29.94it/s]
train loss = 0.34745120056439194
Performing evaluation of epoch 8






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.30it/s]
AUC score for epoch 8 : 0.8213117122650146
Saving the best model
Best AUC score is 0.8213117122650146
Epoch 9














 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 795/800 [00:28<00:00, 36.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:29<00:00, 27.30it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.22it/s]
AUC score for epoch 9 : 0.8237749338150024
Saving the best model
Best AUC score is 0.8237749338150024
Epoch 10













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 47.18it/s]
train loss = 0.313120120257372
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 30.95it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.83it/s]
AUC score for epoch 10 : 0.8263225555419922
Saving the best model
Best AUC score is 0.8263225555419922
Epoch 11












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 31.38it/s]
train loss = 0.3008269460365409
Performing evaluation of epoch 11





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.48it/s]
AUC score for epoch 11 : 0.8286439180374146
Saving the best model
Best AUC score is 0.8286439180374146
Epoch 12













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 30.90it/s]
train loss = 0.28949745539401195
Performing evaluation of epoch 12






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.26it/s]
AUC score for epoch 12 : 0.8298458456993103
Saving the best model
Best AUC score is 0.8298458456993103
Epoch 13











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:24<00:00, 32.06it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.27865308582782744





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.19it/s]
AUC score for epoch 13 : 0.8319543600082397
Saving the best model
Best AUC score is 0.8319543600082397
Epoch 14












100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏| 796/800 [00:24<00:00, 41.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:25<00:00, 31.93it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.95it/s]
AUC score for epoch 14 : 0.8332085609436035
Saving the best model
Best AUC score is 0.8332085609436035
Epoch 15













 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎      | 769/800 [00:26<00:00, 34.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 800/800 [00:27<00:00, 28.65it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.36it/s]
AUC score for epoch 15 : 0.8346909880638123
Saving the best model
Best AUC score is 0.8346909880638123
BEST TEST AUC:  0.8346909880638123
Loading the best model
Getting prediction on unlabelled dataset:


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 38.11it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:26<00:00, 31.14it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.25287251386772597






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.65it/s]
AUC score for epoch 1 : 0.8358691334724426
Saving the best model
Best AUC score is 0.8358691334724426
Epoch 2















100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:29<00:00, 28.11it/s]
train loss = 0.24513620725198493
Performing evaluation of epoch 2






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.06it/s]
AUC score for epoch 2 : 0.8372859954833984
Saving the best model
Best AUC score is 0.8372859954833984
Epoch 3














100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:28<00:00, 29.62it/s]
train loss = 0.23631287044559687
Performing evaluation of epoch 3






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.75it/s]
AUC score for epoch 3 : 0.8384107351303101
Saving the best model
Best AUC score is 0.8384107351303101
Epoch 4














100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:28<00:00, 29.50it/s]
train loss = 0.23011746221106538
Performing evaluation of epoch 4





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.06it/s]
AUC score for epoch 4 : 0.8395756483078003
Saving the best model
Best AUC score is 0.8395756483078003
Epoch 5












 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 832/839 [00:25<00:00, 50.66it/s]
train loss = 0.22250355776808423
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:25<00:00, 32.80it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.76it/s]
AUC score for epoch 5 : 0.8407718539237976
Saving the best model
Best AUC score is 0.8407718539237976
Epoch 6














 95%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 793/839 [00:28<00:00, 46.26it/s]
train loss = 0.2182836110451252
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:29<00:00, 28.04it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.01it/s]
AUC score for epoch 6 : 0.8414022922515869
Saving the best model
Best AUC score is 0.8414022922515869
Epoch 7












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:26<00:00, 31.86it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.209287594562811






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.92it/s]
AUC score for epoch 7 : 0.8424274325370789
Saving the best model
Best AUC score is 0.8424274325370789
Epoch 8














100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:27<00:00, 30.57it/s]
train loss = 0.2064281828620047
Performing evaluation of epoch 8





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.74it/s]
AUC score for epoch 8 : 0.8434855341911316
Saving the best model
Best AUC score is 0.8434855341911316
Epoch 9













 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎ | 831/839 [00:26<00:00, 33.40it/s]
train loss = 0.20154574646008688
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:27<00:00, 30.99it/s]







100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.90it/s]
AUC score for epoch 9 : 0.8437362909317017
Saving the best model
Best AUC score is 0.8437362909317017
Epoch 10











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:23<00:00, 36.05it/s]
train loss = 0.1999545231905818
Performing evaluation of epoch 10





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.55it/s]
AUC score for epoch 10 : 0.8443402051925659
Saving the best model
Best AUC score is 0.8443402051925659
Epoch 11










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:22<00:00, 37.21it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.19211492910130612






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.06it/s]
AUC score for epoch 11 : 0.8446628451347351
Saving the best model
Best AUC score is 0.8446628451347351
Epoch 12













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:27<00:00, 31.02it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.1921798800444272






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.99it/s]
AUC score for epoch 12 : 0.844812273979187
Saving the best model
Best AUC score is 0.844812273979187
Epoch 13












 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌ | 832/839 [00:25<00:00, 43.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:26<00:00, 32.23it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.44it/s]
AUC score for epoch 13 : 0.8451901078224182
Saving the best model
Best AUC score is 0.8451901078224182
Epoch 14














100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌| 837/839 [00:29<00:00, 58.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:30<00:00, 27.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.79it/s]
AUC score for epoch 14 : 0.8454336524009705
Saving the best model
Best AUC score is 0.8454336524009705
Epoch 15










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:21<00:00, 38.16it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.17738226221224151






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.63it/s]
AUC score for epoch 15 : 0.8452489972114563
Best AUC score is 0.8454336524009705
BEST TEST AUC:  0.8454336524009705
Loading the best model
Getting prediction on unlabelled dataset:

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 129.26it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 48.23it/s]













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:27<00:00, 31.06it/s]
train loss = 0.18211125529178193
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.22it/s]
AUC score for epoch 1 : 0.845490574836731
Saving the best model
Best AUC score is 0.845490574836731
Epoch 2














100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 836/839 [00:28<00:00, 49.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:28<00:00, 29.56it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]







100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.97it/s]
AUC score for epoch 2 : 0.8453992605209351
Best AUC score is 0.845490574836731
Epoch 3












 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 834/839 [00:25<00:00, 54.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:25<00:00, 32.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.71it/s]
AUC score for epoch 3 : 0.8455500602722168
Saving the best model
Best AUC score is 0.8455500602722168
Epoch 4













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:26<00:00, 31.40it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.17251481200626725






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 24.01it/s]
AUC score for epoch 4 : 0.84581059217453
Saving the best model
Best AUC score is 0.84581059217453
Epoch 5













100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:27<00:00, 30.97it/s]
train loss = 0.16471950138985797
Performing evaluation of epoch 5






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.10it/s]
AUC score for epoch 5 : 0.8457240462303162
Best AUC score is 0.84581059217453
Epoch 6












100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:26<00:00, 31.70it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.16385634046222272




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.67it/s]
AUC score for epoch 6 : 0.8459057211875916
Saving the best model
Best AUC score is 0.8459057211875916
Epoch 7










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:21<00:00, 38.67it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.16103917700222223




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.71it/s]
AUC score for epoch 7 : 0.8463935852050781
Saving the best model
Best AUC score is 0.8463935852050781
Epoch 8











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:23<00:00, 36.14it/s]
train loss = 0.16278132682380209
Performing evaluation of epoch 8



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.50it/s]
AUC score for epoch 8 : 0.8466576933860779
Saving the best model
Best AUC score is 0.8466576933860779
Epoch 9











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:23<00:00, 35.92it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15714606211960377




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.65it/s]
AUC score for epoch 9 : 0.8461394906044006
Best AUC score is 0.8466576933860779
Epoch 10










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:22<00:00, 36.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15542957742096433






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.17it/s]
AUC score for epoch 10 : 0.8465743064880371
Best AUC score is 0.8466576933860779
Epoch 11










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:22<00:00, 37.56it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15512379102331322





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.74it/s]
AUC score for epoch 11 : 0.8466272354125977
Best AUC score is 0.8466576933860779
Epoch 12











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:23<00:00, 35.52it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.1533756934758012




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.43it/s]
AUC score for epoch 12 : 0.8470239639282227
Saving the best model
Best AUC score is 0.8470239639282227
Epoch 13










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:21<00:00, 39.13it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.14742392797653145




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.43it/s]
AUC score for epoch 13 : 0.8472727537155151
Saving the best model
Best AUC score is 0.8472727537155151
Epoch 14










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:21<00:00, 38.96it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.15192175375725933




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.49it/s]
AUC score for epoch 14 : 0.8473098874092102
Saving the best model
Best AUC score is 0.8473098874092102
Epoch 15










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:21<00:00, 39.89it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.1493156144043172






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.30it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8472638130187988
Best AUC score is 0.8473098874092102
BEST TEST AUC:  0.8473098874092102
Loading the best model


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 64.72it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:22<00:00, 37.02it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.14740917011529678




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.11it/s]
AUC score for epoch 1 : 0.847856342792511
Saving the best model
Best AUC score is 0.847856342792511
Epoch 2











100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:22<00:00, 36.48it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.14704183696758633






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.80it/s]
AUC score for epoch 2 : 0.8472965955734253
Best AUC score is 0.847856342792511
Epoch 3









 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌       | 803/839 [00:19<00:00, 49.87it/s]
train loss = 0.14330168490643452
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:20<00:00, 40.34it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.85it/s]
AUC score for epoch 3 : 0.847595751285553
Best AUC score is 0.847856342792511
Epoch 4










100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:20<00:00, 40.22it/s]
train loss = 0.14139755753524688
Performing evaluation of epoch 4
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:03<00:07, 31.42it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:05<00:03, 37.31it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 218/290 [00:07<00:01, 47.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.12it/s]
AUC score for epoch 4 : 0.8475760221481323
Best AUC score is 0.847856342792511
  2%|███                                                                                                                                                                          | 15/839 [00:00<00:27, 29.47it/s]
  9%|███████████████▎                                                                                                                                                             | 74/839 [00:02<00:18, 42.18it/s]
 18%|██████████████████████████████▌                                                                                                                                             | 149/839 [00:04<00:19, 34.53it/s]
 26%|████████████████████████████████████████████▍                                                                                                                               | 217/839 [00:06<00:20, 31.03it/s]
 36%|█████████████████████████████████████████████████████████████                                                                                                               | 298/839 [00:08<00:14, 37.61it/s]
 43%|██████████████████████████████████████████████████████████████████████████▍                                                                                                 | 363/839 [00:10<00:16, 28.01it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 425/839 [00:12<00:12, 33.72it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 512/839 [00:14<00:06, 50.32it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                              | 612/839 [00:16<00:04, 49.44it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                              | 691/839 [00:18<00:04, 34.13it/s]
 89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                   | 746/839 [00:20<00:03, 24.51it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 817/839 [00:22<00:00, 43.26it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 817/839 [00:22<00:00, 43.26it/s]
train loss = 0.14250859266031904
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:08, 29.41it/s]
 41%|███████████████████████████████████████████████████████████████████████▏                                                                                                    | 120/290 [00:04<00:03, 49.90it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:06<00:02, 41.25it/s]
 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 266/290 [00:08<00:00, 33.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.95it/s]
AUC score for epoch 5 : 0.8475345373153687
Best AUC score is 0.847856342792511
  8%|██████████████▍                                                                                                                                                              | 70/839 [00:01<00:14, 51.66it/s]
 20%|█████████████████████████████████▌                                                                                                                                          | 164/839 [00:03<00:14, 45.96it/s]
 30%|███████████████████████████████████████████████████▊                                                                                                                        | 253/839 [00:05<00:11, 49.95it/s]
 41%|██████████████████████████████████████████████████████████████████████▎                                                                                                     | 343/839 [00:07<00:12, 38.69it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 425/839 [00:09<00:08, 46.56it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                | 526/839 [00:11<00:07, 43.78it/s]
 72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                | 605/839 [00:13<00:08, 28.19it/s]
 84%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                            | 701/839 [00:15<00:02, 47.66it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 775/839 [00:17<00:01, 34.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 42.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 42.98it/s]
train loss = 0.1377533081714222
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:03<00:04, 45.82it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:05<00:04, 32.59it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 243/290 [00:07<00:00, 52.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.96it/s]
AUC score for epoch 6 : 0.8474650382995605
Best AUC score is 0.847856342792511
  8%|█████████████▏                                                                                                                                                               | 64/839 [00:01<00:15, 49.30it/s]
 18%|██████████████████████████████▎                                                                                                                                             | 148/839 [00:03<00:16, 41.45it/s]
 28%|████████████████████████████████████████████████▊                                                                                                                           | 238/839 [00:05<00:14, 41.07it/s]
 40%|████████████████████████████████████████████████████████████████████▍                                                                                                       | 334/839 [00:07<00:11, 43.22it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████                                                                              | 459/839 [00:09<00:05, 63.35it/s]
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                         | 558/839 [00:11<00:07, 38.42it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                         | 637/839 [00:13<00:06, 29.21it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 717/839 [00:15<00:03, 33.54it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 784/839 [00:17<00:01, 31.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 43.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 43.41it/s]
train loss = 0.13540778707185827
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:03<00:05, 42.37it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:05<00:02, 61.46it/s]
 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 215/290 [00:07<00:01, 67.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
AUC score for epoch 7 : 0.8472630977630615
Best AUC score is 0.847856342792511
  7%|███████████▉                                                                                                                                                                 | 58/839 [00:01<00:16, 47.42it/s]
 16%|███████████████████████████▋                                                                                                                                                | 135/839 [00:03<00:13, 50.66it/s]
 28%|████████████████████████████████████████████████▍                                                                                                                           | 236/839 [00:05<00:11, 52.24it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 318/839 [00:07<00:12, 42.00it/s]
 46%|███████████████████████████████████████████████████████████████████████████████▏                                                                                            | 386/839 [00:09<00:12, 36.98it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                   | 511/839 [00:11<00:05, 64.84it/s]
 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                            | 621/839 [00:13<00:04, 53.37it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                         | 717/839 [00:15<00:02, 47.33it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 802/839 [00:17<00:00, 44.56it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍       | 802/839 [00:17<00:00, 44.56it/s]
train loss = 0.13416845075725686
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:02<00:04, 51.41it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 157/290 [00:04<00:02, 54.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 64.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.74it/s]
AUC score for epoch 8 : 0.8476171493530273
Best AUC score is 0.847856342792511
  7%|███████████▎                                                                                                                                                                 | 55/839 [00:01<00:16, 47.48it/s]
 17%|████████████████████████████▋                                                                                                                                               | 140/839 [00:03<00:12, 55.22it/s]
 28%|████████████████████████████████████████████████▉                                                                                                                           | 239/839 [00:05<00:12, 47.51it/s]
 40%|█████████████████████████████████████████████████████████████████████                                                                                                       | 337/839 [00:07<00:08, 58.20it/s]
 49%|███████████████████████████████████████████████████████████████████████████████████▊                                                                                        | 409/839 [00:09<00:12, 34.54it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                  | 514/839 [00:11<00:06, 53.19it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                           | 626/839 [00:13<00:03, 57.88it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 748/839 [00:15<00:01, 63.63it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 748/839 [00:15<00:01, 63.63it/s]
train loss = 0.1310916511313294
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:01<00:07, 33.04it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▉                                                                                | 155/290 [00:04<00:01, 75.28it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:06<00:00, 34.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.87it/s]
AUC score for epoch 9 : 0.8473241925239563
Best AUC score is 0.847856342792511
  0%|                                                                                                                                                                                      | 0/839 [00:00<?, ?it/s]
  7%|███████████▉                                                                                                                                                                 | 58/839 [00:02<00:19, 39.26it/s]
 18%|███████████████████████████████▏                                                                                                                                            | 152/839 [00:04<00:14, 46.21it/s]
 28%|████████████████████████████████████████████████▉                                                                                                                           | 239/839 [00:06<00:12, 49.47it/s]
 38%|████████████████████████████████████████████████████████████████▊                                                                                                           | 316/839 [00:08<00:12, 42.71it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▌                                                                                           | 393/839 [00:10<00:09, 46.34it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 475/839 [00:12<00:10, 35.57it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                        | 562/839 [00:14<00:05, 46.92it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 676/839 [00:16<00:02, 61.75it/s]
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 785/839 [00:18<00:00, 65.07it/s]
 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉           | 785/839 [00:18<00:00, 65.07it/s]
train loss = 0.12901269060261109
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|██████████████▉                                                                                                                                                              | 25/290 [00:02<00:13, 19.35it/s]
 44%|████████████████████████████████████████████████████████████████████████████▌                                                                                               | 129/290 [00:04<00:02, 63.95it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:06<00:01, 52.68it/s]
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 264/290 [00:08<00:00, 36.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.25it/s]
AUC score for epoch 10 : 0.8474769592285156
Best AUC score is 0.847856342792511
  4%|██████▌                                                                                                                                                                      | 32/839 [00:01<00:29, 27.55it/s]
 17%|█████████████████████████████▎                                                                                                                                              | 143/839 [00:03<00:13, 49.81it/s]
 28%|███████████████████████████████████████████████▉                                                                                                                            | 234/839 [00:05<00:13, 45.61it/s]
 37%|███████████████████████████████████████████████████████████████▏                                                                                                            | 308/839 [00:07<00:13, 40.69it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▉                                                                                           | 395/839 [00:09<00:10, 43.54it/s]
 57%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                         | 480/839 [00:11<00:07, 46.21it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                        | 562/839 [00:13<00:05, 55.22it/s]
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                      | 650/839 [00:15<00:03, 48.66it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 748/839 [00:17<00:01, 52.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 43.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 43.12it/s]
train loss = 0.12979008313065754
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:03<00:12, 19.83it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:05<00:02, 60.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:07<00:00, 101.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.19it/s]
AUC score for epoch 11 : 0.8471617102622986
Best AUC score is 0.847856342792511
  2%|██▉                                                                                                                                                                          | 14/839 [00:00<00:25, 32.41it/s]
 15%|█████████████████████████                                                                                                                                                   | 122/839 [00:02<00:16, 42.63it/s]
 26%|█████████████████████████████████████████████▌                                                                                                                              | 222/839 [00:04<00:12, 50.85it/s]
 38%|████████████████████████████████████████████████████████████████▉                                                                                                           | 317/839 [00:06<00:11, 45.03it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▍                                                                                       | 412/839 [00:08<00:10, 42.56it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                      | 494/839 [00:10<00:08, 39.20it/s]
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                     | 581/839 [00:12<00:05, 49.47it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                | 679/839 [00:14<00:03, 50.34it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 786/839 [00:16<00:00, 60.77it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏          | 786/839 [00:16<00:00, 60.77it/s]
train loss = 0.12976973351478688
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:02<00:08, 28.51it/s]
 42%|████████████████████████████████████████████████████████████████████████▎                                                                                                   | 122/290 [00:04<00:05, 30.90it/s]
 72%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                               | 210/290 [00:06<00:01, 63.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.05it/s]
AUC score for epoch 12 : 0.847129225730896
Best AUC score is 0.847856342792511
  0%|                                                                                                                                                                                      | 0/839 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 84/839 [00:02<00:16, 47.16it/s]
 20%|██████████████████████████████████▊                                                                                                                                         | 170/839 [00:04<00:17, 37.46it/s]
 31%|████████████████████████████████████████████████████▍                                                                                                                       | 256/839 [00:06<00:12, 47.26it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 339/839 [00:08<00:12, 40.57it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▉                                                                                    | 429/839 [00:10<00:08, 47.67it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                    | 504/839 [00:12<00:07, 43.62it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 603/839 [00:14<00:04, 56.04it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                              | 690/839 [00:16<00:03, 44.16it/s]
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 760/839 [00:17<00:01, 51.54it/s]
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                | 760/839 [00:17<00:01, 51.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 44.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:19<00:00, 44.05it/s]
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:02<00:06, 37.67it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:03<00:02, 69.81it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                             | 241/290 [00:05<00:00, 55.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.06it/s]
AUC score for epoch 13 : 0.8473296761512756
Best AUC score is 0.847856342792511
  1%|██                                                                                                                                                                           | 10/839 [00:00<00:26, 30.80it/s]
 11%|███████████████████▊                                                                                                                                                         | 96/839 [00:02<00:16, 44.38it/s]
 21%|███████████████████████████████████▎                                                                                                                                        | 172/839 [00:04<00:18, 36.56it/s]
 30%|███████████████████████████████████████████████████                                                                                                                         | 249/839 [00:06<00:14, 41.25it/s]
 39%|███████████████████████████████████████████████████████████████████▏                                                                                                        | 328/839 [00:08<00:12, 39.41it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▊                                                                                       | 414/839 [00:10<00:08, 47.50it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                    | 505/839 [00:12<00:07, 45.22it/s]
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 592/839 [00:14<00:06, 40.31it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 674/839 [00:16<00:03, 46.49it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 772/839 [00:18<00:01, 42.09it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 772/839 [00:18<00:01, 42.09it/s]
train loss = 0.12858141753845026
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:02<00:05, 45.31it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:04<00:02, 54.56it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:06<00:00, 88.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.11it/s]
AUC score for epoch 14 : 0.8475815653800964
Best AUC score is 0.847856342792511
  2%|███▌                                                                                                                                                                         | 17/839 [00:00<00:20, 40.16it/s]
 13%|█████████████████████▋                                                                                                                                                      | 106/839 [00:02<00:16, 43.58it/s]
 22%|██████████████████████████████████████▏                                                                                                                                     | 186/839 [00:04<00:17, 37.02it/s]
 33%|████████████████████████████████████████████████████████▏                                                                                                                   | 274/839 [00:06<00:12, 44.64it/s]
 43%|██████████████████████████████████████████████████████████████████████████▍                                                                                                 | 363/839 [00:08<00:10, 45.31it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▊                                                                                  | 438/839 [00:10<00:11, 33.51it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                | 527/839 [00:12<00:07, 40.18it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                          | 630/839 [00:14<00:04, 46.20it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                | 682/839 [00:16<00:03, 45.02it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 797/839 [00:18<00:00, 52.39it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍        | 797/839 [00:18<00:00, 52.39it/s]
train loss = 0.125128697002946
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  5%|████████▉                                                                                                                                                                    | 15/290 [00:02<00:27,  9.93it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:04<00:01, 85.41it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:06<00:01, 51.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.39it/s]
AUC score for epoch 15 : 0.8479293584823608
Saving the best model
Best AUC score is 0.8479293584823608
BEST TEST AUC:  0.8479293584823608
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 193/197 [00:02<00:00, 147.18it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌   | 193/197 [00:02<00:00, 147.18it/s]
################################
TOTAL EPOCH:  5
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 59.25it/s]
  5%|█████████▎                                                                                                                                                                   | 45/839 [00:01<00:20, 38.75it/s]
 18%|██████████████████████████████▉                                                                                                                                             | 151/839 [00:03<00:13, 51.35it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                       | 259/839 [00:05<00:11, 48.84it/s]
 42%|███████████████████████████████████████████████████████████████████████▉                                                                                                    | 351/839 [00:07<00:10, 47.34it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▏                                                                                  | 435/839 [00:09<00:12, 33.12it/s]
 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                | 523/839 [00:11<00:06, 46.63it/s]
 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                             | 617/839 [00:13<00:05, 42.79it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                              | 693/839 [00:15<00:02, 55.78it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 784/839 [00:17<00:01, 38.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.44it/s]
train loss = 0.12410752875365644
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:03<00:04, 45.85it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 162/290 [00:05<00:03, 41.78it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:07<00:00, 80.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.84it/s]
AUC score for epoch 1 : 0.8481651544570923
Saving the best model
Best AUC score is 0.8481651544570923
  0%|                                                                                                                                                                                      | 0/839 [00:00<?, ?it/s]
  9%|███████████████▉                                                                                                                                                             | 77/839 [00:01<00:18, 41.63it/s]
 20%|██████████████████████████████████▊                                                                                                                                         | 170/839 [00:04<00:16, 40.81it/s]
 32%|██████████████████████████████████████████████████████▎                                                                                                                     | 265/839 [00:06<00:11, 49.38it/s]
 42%|███████████████████████████████████████████████████████████████████████▌                                                                                                    | 349/839 [00:08<00:09, 49.93it/s]
 55%|███████████████████████████████████████████████████████████████████████████████████████████████▎                                                                            | 465/839 [00:10<00:06, 56.88it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 561/839 [00:12<00:05, 46.83it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                  | 672/839 [00:14<00:02, 62.11it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 788/839 [00:16<00:00, 68.29it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌          | 788/839 [00:16<00:00, 68.29it/s]
train loss = 0.12652215046796816
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▊                                                                                                                                            | 55/290 [00:02<00:05, 44.69it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:04<00:02, 58.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 65.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.89it/s]
AUC score for epoch 2 : 0.8481500148773193
Best AUC score is 0.8481651544570923
  4%|███████▋                                                                                                                                                                     | 37/839 [00:01<00:27, 29.60it/s]
 15%|█████████████████████████▏                                                                                                                                                  | 123/839 [00:03<00:18, 38.62it/s]
 23%|███████████████████████████████████████▌                                                                                                                                    | 193/839 [00:05<00:18, 34.94it/s]
 33%|████████████████████████████████████████████████████████▏                                                                                                                   | 274/839 [00:07<00:17, 32.89it/s]
 40%|█████████████████████████████████████████████████████████████████████▎                                                                                                      | 338/839 [00:09<00:15, 32.35it/s]
 48%|███████████████████████████████████████████████████████████████████████████████████                                                                                         | 405/839 [00:11<00:12, 35.96it/s]
 59%|████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                       | 491/839 [00:13<00:07, 45.22it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 567/839 [00:15<00:07, 38.47it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 654/839 [00:17<00:03, 49.42it/s]
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏               | 762/839 [00:19<00:01, 58.75it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.12060620748876909
  4%|██████▌                                                                                                                                                                      | 11/290 [00:02<00:30,  9.01it/s]
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:03<00:04, 47.57it/s]
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 221/290 [00:06<00:01, 54.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.93it/s]
AUC score for epoch 3 : 0.848027229309082
Best AUC score is 0.8481651544570923
  7%|███████████▎                                                                                                                                                                 | 55/839 [00:01<00:15, 51.09it/s]
 21%|███████████████████████████████████▍                                                                                                                                        | 173/839 [00:03<00:10, 65.22it/s]
 31%|█████████████████████████████████████████████████████▎                                                                                                                      | 260/839 [00:05<00:12, 45.88it/s]
 41%|██████████████████████████████████████████████████████████████████████▋                                                                                                     | 345/839 [00:07<00:15, 32.15it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 420/839 [00:09<00:11, 36.24it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                     | 502/839 [00:11<00:07, 42.39it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                   | 586/839 [00:13<00:06, 40.63it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                      | 652/839 [00:14<00:04, 39.63it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 729/839 [00:16<00:02, 38.63it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 817/839 [00:18<00:00, 57.57it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍    | 817/839 [00:18<00:00, 57.57it/s]
train loss = 0.12206975348594558
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:02<00:05, 44.33it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                    | 174/290 [00:04<00:01, 65.77it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:06<00:00, 94.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.68it/s]
AUC score for epoch 4 : 0.8483593463897705
Saving the best model
Best AUC score is 0.8483593463897705
  1%|█▏                                                                                                                                                                            | 6/839 [00:00<00:27, 29.77it/s]
 12%|████████████████████▌                                                                                                                                                       | 100/839 [00:02<00:14, 51.41it/s]
 20%|███████████████████████████████████                                                                                                                                         | 171/839 [00:04<00:21, 30.99it/s]
 29%|██████████████████████████████████████████████████▍                                                                                                                         | 246/839 [00:06<00:12, 45.73it/s]
 41%|█████████████████████████████████████████████████████████████████████▋                                                                                                      | 340/839 [00:08<00:11, 42.25it/s]
 49%|███████████████████████████████████████████████████████████████████████████████████▍                                                                                        | 407/839 [00:10<00:16, 25.94it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                        | 484/839 [00:12<00:09, 36.34it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                           | 549/839 [00:14<00:08, 34.88it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                          | 633/839 [00:16<00:04, 45.96it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                       | 724/839 [00:18<00:02, 52.93it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 827/839 [00:20<00:00, 77.16it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌  | 827/839 [00:20<00:00, 77.16it/s]
train loss = 0.11981033779622513
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:02<00:05, 40.60it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                      | 171/290 [00:04<00:01, 59.75it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 275/290 [00:06<00:00, 81.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.00it/s]
AUC score for epoch 5 : 0.8481974601745605
Best AUC score is 0.8483593463897705
  0%|▊                                                                                                                                                                             | 4/839 [00:00<00:42, 19.76it/s]
 14%|███████████████████████▎                                                                                                                                                    | 114/839 [00:02<00:12, 56.15it/s]
 24%|██████████████████████████████████████████                                                                                                                                  | 205/839 [00:04<00:12, 48.92it/s]
 37%|███████████████████████████████████████████████████████████████▉                                                                                                            | 312/839 [00:06<00:10, 49.04it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▎                                                                                           | 392/839 [00:08<00:10, 42.35it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 475/839 [00:10<00:10, 35.25it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 556/839 [00:12<00:06, 41.84it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                       | 647/839 [00:14<00:04, 43.52it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                     | 736/839 [00:16<00:02, 46.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.82it/s]
train loss = 0.11904045853900419
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:03<00:03, 62.03it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 199/290 [00:05<00:02, 36.42it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 273/290 [00:07<00:00, 74.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.85it/s]
AUC score for epoch 6 : 0.8483062982559204
Best AUC score is 0.8483593463897705
  3%|█████▎                                                                                                                                                                       | 26/839 [00:00<00:21, 37.61it/s]
 14%|████████████████████████▍                                                                                                                                                   | 119/839 [00:02<00:16, 43.40it/s]
 26%|███████████████████████████████████████████▊                                                                                                                                | 214/839 [00:04<00:13, 45.30it/s]
 35%|████████████████████████████████████████████████████████████▍                                                                                                               | 295/839 [00:06<00:15, 34.43it/s]
 44%|███████████████████████████████████████████████████████████████████████████▍                                                                                                | 368/839 [00:08<00:13, 35.43it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▋                                                                                | 447/839 [00:10<00:09, 39.36it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 518/839 [00:12<00:07, 40.78it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                | 603/839 [00:14<00:05, 39.91it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                    | 664/839 [00:16<00:03, 43.96it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 771/839 [00:18<00:01, 49.78it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 771/839 [00:18<00:01, 49.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:10, 25.10it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:04<00:06, 29.72it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 173/290 [00:06<00:01, 64.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:07<00:00, 105.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.08it/s]
AUC score for epoch 7 : 0.847705602645874
Best AUC score is 0.8483593463897705
  2%|███▋                                                                                                                                                                         | 18/839 [00:00<00:18, 44.38it/s]
 11%|███████████████████▍                                                                                                                                                         | 94/839 [00:02<00:20, 35.57it/s]
 22%|█████████████████████████████████████                                                                                                                                       | 181/839 [00:04<00:14, 45.75it/s]
 33%|████████████████████████████████████████████████████████▍                                                                                                                   | 275/839 [00:06<00:11, 48.68it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 356/839 [00:08<00:13, 36.55it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▋                                                                               | 452/839 [00:10<00:08, 43.24it/s]
 65%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                            | 543/839 [00:12<00:07, 42.23it/s]
 77%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                       | 649/839 [00:14<00:03, 52.56it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 757/839 [00:16<00:01, 60.38it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                | 757/839 [00:16<00:01, 60.38it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 18%|███████████████████████████████▌                                                                                                                                             | 53/290 [00:02<00:04, 49.26it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:04<00:01, 68.62it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:05<00:00, 94.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.69it/s]
AUC score for epoch 8 : 0.847884476184845
Best AUC score is 0.8483593463897705
  3%|████▎                                                                                                                                                                        | 21/839 [00:00<00:20, 40.03it/s]
 13%|██████████████████████▊                                                                                                                                                     | 111/839 [00:02<00:16, 43.14it/s]
 25%|███████████████████████████████████████████▎                                                                                                                                | 211/839 [00:04<00:13, 48.12it/s]
 36%|█████████████████████████████████████████████████████████████                                                                                                               | 298/839 [00:06<00:11, 46.31it/s]
 45%|████████████████████████████████████████████████████████████████████████████▋                                                                                               | 374/839 [00:08<00:12, 36.25it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▎                                                                               | 450/839 [00:10<00:08, 43.60it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                | 527/839 [00:12<00:08, 38.19it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                | 602/839 [00:14<00:05, 41.07it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                 | 676/839 [00:16<00:04, 39.69it/s]
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 764/839 [00:18<00:01, 50.23it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.11494637838565286
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:01<00:09, 28.34it/s]
 38%|█████████████████████████████████████████████████████████████████▊                                                                                                          | 111/290 [00:04<00:03, 53.35it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:05<00:01, 55.95it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:07<00:00, 61.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.76it/s]
AUC score for epoch 9 : 0.8479722738265991
Best AUC score is 0.8483593463897705
  4%|██████▍                                                                                                                                                                      | 31/839 [00:00<00:25, 32.19it/s]
 14%|████████████████████████▍                                                                                                                                                   | 119/839 [00:02<00:15, 46.07it/s]
 25%|███████████████████████████████████████████▋                                                                                                                                | 213/839 [00:04<00:15, 40.74it/s]
 36%|██████████████████████████████████████████████████████████████                                                                                                              | 303/839 [00:06<00:10, 53.58it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▉                                                                                           | 395/839 [00:08<00:09, 46.34it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████                                                                       | 493/839 [00:10<00:07, 44.28it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                       | 571/839 [00:13<00:09, 27.74it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                       | 647/839 [00:14<00:03, 53.64it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                    | 738/839 [00:16<00:02, 49.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 839/839 [00:18<00:00, 45.56it/s]
train loss = 0.11425082058635742
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 23%|███████████████████████████████████████▉                                                                                                                                     | 67/290 [00:03<00:04, 46.78it/s]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                                                      | 172/290 [00:05<00:01, 75.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.12it/s]
AUC score for epoch 10 : 0.8487160801887512
Saving the best model
Best AUC score is 0.8487160801887512
  0%|▏                                                                                                                                                                             | 1/839 [00:00<01:41,  8.26it/s]
KeyboardInterruptr.acquire(True, timeout)niconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in waitataloader.py", line 1120, in _try_get_data                | 1/839 [2:24:18<2015:26:52, 8658.25s/it]
KeyboardInterruptr.acquire(True, timeout)niconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in waitataloader.py", line 1120, in _try_get_data                | 1/839 [2:24:18<2015:26:52, 8658.25s/it]
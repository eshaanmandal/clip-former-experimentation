################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 20.63it/s]
train loss = 0.8669114947319031
  0%|                                                   | 0/290 [00:00<?, ?it/s]




100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 42.40it/s]
AUC score for epoch 1 : 0.7982815504074097
Saving the best model
Best AUC score is 0.7982815504074097
Epoch 2

100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 23.45it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.3574486217647791




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 39.12it/s]
AUC score for epoch 2 : 0.8035589456558228
Saving the best model
Best AUC score is 0.8035589456558228
Epoch 3


100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 21.33it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.08994477590546011




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.44it/s]
AUC score for epoch 3 : 0.8085812330245972
Saving the best model
Best AUC score is 0.8085812330245972
Epoch 4


100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 22.85it/s]
  7%|██▊                                       | 19/290 [00:01<00:13, 20.17it/s]
train loss = 0.0339740681136027



100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 40.10it/s]
AUC score for epoch 4 : 0.808181881904602
Best AUC score is 0.8085812330245972
Epoch 5


100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 20.45it/s]
  2%|▉                                          | 6/290 [00:01<01:03,  4.47it/s]
train loss = 0.025588456881232558




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.21it/s]
AUC score for epoch 5 : 0.810539186000824
Saving the best model
Best AUC score is 0.810539186000824
Epoch 6


100%|█████████████████████████████████████████| 100/100 [00:05<00:00, 16.89it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.013064058147137984





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.68it/s]
AUC score for epoch 6 : 0.8105207681655884
Best AUC score is 0.810539186000824
Epoch 7

100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 21.82it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.012331140393507667




100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 42.20it/s]
AUC score for epoch 7 : 0.8126806616783142
Saving the best model
Best AUC score is 0.8126806616783142
Epoch 8


100%|█████████████████████████████████████████| 100/100 [00:05<00:00, 18.18it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.021045102676725946





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 28.56it/s]
AUC score for epoch 8 : 0.81645667552948
Saving the best model
Best AUC score is 0.81645667552948
Epoch 9

100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 21.87it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.015913267105352135




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 37.37it/s]
AUC score for epoch 9 : 0.8154157400131226
Best AUC score is 0.81645667552948
Epoch 10

100%|█████████████████████████████████████████| 100/100 [00:04<00:00, 20.19it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.0107045556983212





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 29.11it/s]
  0%|                                                   | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.820410430431366
Saving the best model
Best AUC score is 0.820410430431366
BEST TEST AUC:  0.820410430431366
Loading the best model


100%|█████████████████████████████████████████| 197/197 [00:02<00:00, 71.40it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1

100%|█████████████████████████████████████████| 105/105 [00:04<00:00, 22.63it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.01619795280386738





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 32.87it/s]
AUC score for epoch 1 : 0.8201755285263062
Best AUC score is 0.820410430431366
Epoch 2


100%|█████████████████████████████████████████| 105/105 [00:04<00:00, 23.60it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.004481944895260746




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.23it/s]
AUC score for epoch 2 : 0.8192586898803711
Best AUC score is 0.820410430431366
Epoch 3

100%|█████████████████████████████████████████| 105/105 [00:04<00:00, 22.60it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.013859288787491443



100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 37.64it/s]
AUC score for epoch 3 : 0.8198584318161011
Best AUC score is 0.820410430431366
Epoch 4


100%|█████████████████████████████████████████| 105/105 [00:05<00:00, 19.03it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.002335065603533405





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.65it/s]
AUC score for epoch 4 : 0.8217747211456299
Saving the best model
Best AUC score is 0.8217747211456299
Epoch 5


100%|█████████████████████████████████████████| 105/105 [00:04<00:00, 22.50it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.003953099528804333




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.04it/s]
AUC score for epoch 5 : 0.8223924040794373
Saving the best model
Best AUC score is 0.8223924040794373
Epoch 6


100%|█████████████████████████████████████████| 105/105 [00:06<00:00, 15.14it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.010168984877167359




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.24it/s]
AUC score for epoch 6 : 0.8185628056526184
Best AUC score is 0.8223924040794373
Epoch 7

100%|█████████████████████████████████████████| 105/105 [00:05<00:00, 20.72it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.003088819213388931




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 37.25it/s]
AUC score for epoch 7 : 0.8233228921890259
Saving the best model
Best AUC score is 0.8233228921890259
Epoch 8


100%|█████████████████████████████████████████| 105/105 [00:05<00:00, 19.24it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.012320238466574145




100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 31.73it/s]
AUC score for epoch 8 : 0.8256021738052368
Saving the best model
Best AUC score is 0.8256021738052368
Epoch 9



100%|█████████████████████████████████████████████████████████████████| 105/105 [00:06<00:00, 15.72it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.008594311952003322





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.99it/s]
AUC score for epoch 9 : 0.8212157487869263
Best AUC score is 0.8256021738052368
Epoch 10


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.26it/s]
train loss = 0.003500688262699571
Performing evaluation of epoch 10




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.55it/s]
AUC score for epoch 10 : 0.8249008655548096
Best AUC score is 0.8256021738052368
BEST TEST AUC:  0.8256021738052368
Loading the best model
  0%|                                                                           | 0/197 [00:00<?, ?it/s]


100%|█████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 59.15it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.32it/s]
train loss = 0.043591828007871904
Performing evaluation of epoch 1




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.96it/s]
AUC score for epoch 1 : 0.8118488788604736
Best AUC score is 0.8256021738052368
Epoch 2


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:06<00:00, 16.12it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.01897924860518071




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.81it/s]
AUC score for epoch 2 : 0.8134667873382568
Best AUC score is 0.8256021738052368
Epoch 3


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.02it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.017536176299853694




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.94it/s]
AUC score for epoch 3 : 0.8158433437347412
Best AUC score is 0.8256021738052368
Epoch 4


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 24.00it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.02409933266545912




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.55it/s]
AUC score for epoch 4 : 0.8177017569541931
Best AUC score is 0.8256021738052368
Epoch 5


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.48it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.01378521397072334




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.55it/s]
AUC score for epoch 5 : 0.8167372941970825
Best AUC score is 0.8256021738052368
Epoch 6


 73%|████████████████████████████████████████████████▍                 | 77/105 [00:04<00:01, 20.27it/s]
train loss = 0.015271825705921012
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.42it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.60it/s]
AUC score for epoch 6 : 0.8201404809951782
Best AUC score is 0.8256021738052368
Epoch 7


 90%|███████████████████████████████████████████████████████████▋      | 95/105 [00:04<00:00, 38.26it/s]
train loss = 0.012193110273940311
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.69it/s]





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.27it/s]
AUC score for epoch 7 : 0.8173015713691711
Best AUC score is 0.8256021738052368
Epoch 8

100%|█████████████████████████████████████████████████████████████████| 105/105 [00:03<00:00, 26.59it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.009632581950946977




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.17it/s]
AUC score for epoch 8 : 0.8210483193397522
Best AUC score is 0.8256021738052368
Epoch 9


 96%|██████████████████████████████████████████████████████████████▌  | 101/105 [00:04<00:00, 45.02it/s]
train loss = 0.012128261129310843
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.08it/s]





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.80it/s]
AUC score for epoch 9 : 0.8214579224586487
Best AUC score is 0.8256021738052368
Epoch 10

 58%|██████████████████████████████████████▎                           | 61/105 [00:03<00:02, 21.11it/s]
train loss = 0.006518007129974042
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.56it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.12it/s]
AUC score for epoch 10 : 0.8224555253982544
Best AUC score is 0.8256021738052368
BEST TEST AUC:  0.8256021738052368
Loading the best model
Getting prediction on unlabelled dataset:

 86%|███████████████████████████████████████████████████████▏        | 170/197 [00:03<00:00, 129.88it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 52.31it/s]


 96%|██████████████████████████████████████████████████████████████▌  | 101/105 [00:04<00:00, 45.43it/s]
train loss = 0.048338696174323556
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 22.61it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.31it/s]
AUC score for epoch 1 : 0.8134111166000366
Best AUC score is 0.8256021738052368
Epoch 2


 61%|████████████████████████████████████████▏                         | 64/105 [00:04<00:03, 12.36it/s]

100%|█████████████████████████████████████████████████████████████████| 105/105 [00:06<00:00, 16.27it/s]
Performing evaluation of epoch 2




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.31it/s]
AUC score for epoch 2 : 0.81705641746521
Best AUC score is 0.8256021738052368
Epoch 3


 87%|█████████████████████████████████████████████████████████▏        | 91/105 [00:04<00:00, 33.57it/s]
train loss = 0.027940143025591082
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.93it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.41it/s]
AUC score for epoch 3 : 0.8166288137435913
Best AUC score is 0.8256021738052368
Epoch 4


 96%|██████████████████████████████████████████████████████████████▌  | 101/105 [00:05<00:00, 37.94it/s]
train loss = 0.009436887134853307
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.67it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.55it/s]
AUC score for epoch 4 : 0.8157073855400085
Best AUC score is 0.8256021738052368
Epoch 5


 94%|██████████████████████████████████████████████████████████████▏   | 99/105 [00:05<00:00, 29.92it/s]
train loss = 0.01026759917260192
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 17.79it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.24it/s]
AUC score for epoch 5 : 0.8169121742248535
Best AUC score is 0.8256021738052368
Epoch 6


 94%|██████████████████████████████████████████████████████████████▏   | 99/105 [00:04<00:00, 54.02it/s]
train loss = 0.011896321816380978
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.87it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.35it/s]
AUC score for epoch 6 : 0.8171525001525879
Best AUC score is 0.8256021738052368
Epoch 7


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.69it/s]
train loss = 0.013838794649512107
Performing evaluation of epoch 7




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.32it/s]
AUC score for epoch 7 : 0.816862165927887
Best AUC score is 0.8256021738052368
Epoch 8


 73%|████████████████████████████████████████████████▍                 | 77/105 [00:04<00:01, 23.00it/s]
train loss = 0.007573063073713067
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.82it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.41it/s]
AUC score for epoch 8 : 0.8187008500099182
Best AUC score is 0.8256021738052368
Epoch 9


 90%|███████████████████████████████████████████████████████████▋      | 95/105 [00:04<00:00, 47.60it/s]
train loss = 0.0023347030634925303
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.06it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.61it/s]
AUC score for epoch 9 : 0.8188256025314331
Best AUC score is 0.8256021738052368
Epoch 10


 96%|██████████████████████████████████████████████████████████████▌  | 101/105 [00:05<00:00, 46.09it/s]
train loss = 0.005265391827283782
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 17.51it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.95it/s]
AUC score for epoch 10 : 0.8174757361412048
Best AUC score is 0.8256021738052368
BEST TEST AUC:  0.8256021738052368
Loading the best model
Getting prediction on unlabelled dataset:
  0%|                                                                           | 0/197 [00:00<?, ?it/s]
################################
TOTAL EPOCH:  5
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 81.26it/s]
  1%|▌                                                         | 1/105 [3:00:15<312:26:40, 10815.39s/it]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 141, in train_once
    loss = train(epoch, model, optimizer, device, [train_anomaly_dl, train_normal_dl], train_bs)
  File "main.py", line 33, in train
    for anomaly, normal in tqdm(zip(anomaly_dl, normal_dl), total=l):
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1272, in _get_data
    success, data = self._try_get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt
################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1










100%|████████████████████████████████████████▉| 798/800 [00:21<00:00, 65.78it/s]
train loss = 0.540665981870261
100%|█████████████████████████████████████████| 800/800 [00:21<00:00, 36.85it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 38.12it/s]
AUC score for epoch 1 : 0.82524174451828
Saving the best model
Best AUC score is 0.82524174451828
Epoch 2







100%|█████████████████████████████████████████| 800/800 [00:17<00:00, 46.67it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.2689746670464228




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 40.62it/s]
AUC score for epoch 2 : 0.8404194712638855
Saving the best model
Best AUC score is 0.8404194712638855
Epoch 3









 94%|██████████████████████████████████████▍  | 750/800 [00:19<00:01, 37.91it/s]
train loss = 0.23289943164490978
100%|█████████████████████████████████████████| 800/800 [00:20<00:00, 39.04it/s]





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 32.81it/s]
AUC score for epoch 3 : 0.8445367813110352
Saving the best model
Best AUC score is 0.8445367813110352
Epoch 4








100%|█████████████████████████████████████████| 800/800 [00:18<00:00, 42.68it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.21186340330370512





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.58it/s]
AUC score for epoch 4 : 0.8480603694915771
Saving the best model
Best AUC score is 0.8480603694915771
Epoch 5







 91%|█████████████████████████████████████▎   | 727/800 [00:15<00:01, 62.82it/s]
train loss = 0.18957677091730146
100%|█████████████████████████████████████████| 800/800 [00:16<00:00, 48.43it/s]



100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 44.58it/s]
AUC score for epoch 5 : 0.8482797145843506
Saving the best model
Best AUC score is 0.8482797145843506
Epoch 6









 97%|███████████████████████████████████████▌ | 773/800 [00:18<00:00, 53.74it/s]
train loss = 0.181800799344237
100%|█████████████████████████████████████████| 800/800 [00:19<00:00, 41.29it/s]



100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 41.17it/s]
AUC score for epoch 6 : 0.8502848744392395
Saving the best model
Best AUC score is 0.8502848744392395
Epoch 7









 94%|██████████████████████████████████████▍  | 750/800 [00:19<00:01, 40.74it/s]
100%|█████████████████████████████████████████| 800/800 [00:21<00:00, 37.59it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 36.33it/s]
AUC score for epoch 7 : 0.8474341630935669
Best AUC score is 0.8502848744392395
Epoch 8








100%|█████████████████████████████████████████| 800/800 [00:16<00:00, 47.77it/s]
train loss = 0.15598006265779077
Performing evaluation of epoch 8




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.18it/s]
AUC score for epoch 8 : 0.8501495718955994
Best AUC score is 0.8502848744392395
Epoch 9










100%|█████████████████████████████████████████| 800/800 [00:21<00:00, 37.44it/s]
train loss = 0.15457055390894653
Performing evaluation of epoch 9




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.26it/s]
AUC score for epoch 9 : 0.8398453593254089
Best AUC score is 0.8502848744392395
Epoch 10










100%|█████████████████████████████████████████| 800/800 [00:20<00:00, 38.56it/s]
train loss = 0.137615675232596
Performing evaluation of epoch 10




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 36.52it/s]
AUC score for epoch 10 : 0.8477731943130493
Best AUC score is 0.8502848744392395
BEST TEST AUC:  0.8502848744392395
Getting prediction on unlabelled dataset:
  0%|                                                   | 0/197 [00:00<?, ?it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████| 197/197 [00:02<00:00, 96.62it/s]









 98%|████████████████████████████████████████▎| 826/839 [00:19<00:00, 37.75it/s]
train loss = 0.13139526322248013
100%|█████████████████████████████████████████| 839/839 [00:19<00:00, 41.99it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 39.66it/s]
AUC score for epoch 1 : 0.8458430767059326
Best AUC score is 0.8502848744392395
Epoch 2











 98%|████████████████████████████████████████▏| 823/839 [00:22<00:00, 42.86it/s]
train loss = 0.12842078868831228
100%|█████████████████████████████████████████| 839/839 [00:23<00:00, 36.41it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 39.49it/s]
AUC score for epoch 2 : 0.8442695140838623
Best AUC score is 0.8502848744392395
Epoch 3










 93%|██████████████████████████████████████   | 779/839 [00:20<00:01, 33.69it/s]
train loss = 0.11873440910417274
100%|█████████████████████████████████████████| 839/839 [00:21<00:00, 39.03it/s]



100%|█████████████████████████████████████████| 290/290 [00:05<00:00, 51.25it/s]
AUC score for epoch 3 : 0.8435873985290527
Best AUC score is 0.8502848744392395
Epoch 4









 93%|██████████████████████████████████████▎  | 784/839 [00:18<00:01, 47.30it/s]
train loss = 0.11581133902635375
100%|█████████████████████████████████████████| 839/839 [00:19<00:00, 43.09it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 37.06it/s]
AUC score for epoch 4 : 0.842455267906189
Best AUC score is 0.8502848744392395
Epoch 5










 98%|████████████████████████████████████████▏| 823/839 [00:21<00:00, 44.63it/s]
train loss = 0.10944531428734015
100%|█████████████████████████████████████████| 839/839 [00:21<00:00, 39.01it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.42it/s]
AUC score for epoch 5 : 0.846453845500946
Best AUC score is 0.8502848744392395
Epoch 6









 98%|████████████████████████████████████████▏| 823/839 [00:18<00:00, 71.79it/s]
train loss = 0.10015331834257049
100%|█████████████████████████████████████████| 839/839 [00:19<00:00, 43.78it/s]




100%|█████████████████████████████████████████| 290/290 [00:07<00:00, 36.26it/s]
AUC score for epoch 6 : 0.8468592762947083
Best AUC score is 0.8502848744392395
Epoch 7











 96%|███████████████████████████████████████▍ | 808/839 [00:23<00:01, 28.06it/s]
train loss = 0.10324658671713717
100%|█████████████████████████████████████████| 839/839 [00:24<00:00, 34.49it/s]





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 30.30it/s]
AUC score for epoch 7 : 0.8423281908035278
Best AUC score is 0.8502848744392395
Epoch 8












 99%|████████████████████████████████████████▋| 833/839 [00:23<00:00, 55.91it/s]
train loss = 0.10846473427556676
100%|█████████████████████████████████████████| 839/839 [00:24<00:00, 34.76it/s]



100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 41.47it/s]
AUC score for epoch 8 : 0.8450109958648682
Best AUC score is 0.8502848744392395
Epoch 9










 99%|████████████████████████████████████████▍| 827/839 [00:21<00:00, 55.73it/s]
train loss = 0.09426235664564966
100%|█████████████████████████████████████████| 839/839 [00:21<00:00, 38.71it/s]





100%|█████████████████████████████████████████| 290/290 [00:10<00:00, 27.72it/s]
AUC score for epoch 9 : 0.8423887491226196
Best AUC score is 0.8502848744392395
Epoch 10












100%|█████████████████████████████████████████| 839/839 [00:25<00:00, 32.92it/s]
train loss = 0.08949951037768018
Performing evaluation of epoch 10





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 29.09it/s]
AUC score for epoch 10 : 0.8447733521461487
Best AUC score is 0.8502848744392395
BEST TEST AUC:  0.8502848744392395
Getting prediction on unlabelled dataset:

 77%|██████████████████████████████▊         | 152/197 [00:03<00:00, 102.16it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████| 197/197 [00:03<00:00, 51.17it/s]










 98%|████████████████████████████████████████ | 820/839 [00:21<00:00, 50.47it/s]
train loss = 0.10120654333467426
100%|█████████████████████████████████████████| 839/839 [00:22<00:00, 37.22it/s]





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 31.97it/s]
AUC score for epoch 1 : 0.8411555290222168
Best AUC score is 0.8502848744392395
Epoch 2










 95%|███████████████████████████████████████  | 800/839 [00:21<00:00, 40.82it/s]
100%|█████████████████████████████████████████| 839/839 [00:22<00:00, 37.62it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.40it/s]
AUC score for epoch 2 : 0.8387640118598938
Best AUC score is 0.8502848744392395
Epoch 3









 95%|██████████████████████████████████████▉  | 798/839 [00:18<00:00, 53.16it/s]
train loss = 0.0926365689523083
100%|█████████████████████████████████████████| 839/839 [00:18<00:00, 44.24it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.21it/s]
AUC score for epoch 3 : 0.8435062170028687
Best AUC score is 0.8502848744392395
Epoch 4










 92%|█████████████████████████████████████▋   | 771/839 [00:20<00:00, 71.02it/s]
train loss = 0.0907131462238607
100%|█████████████████████████████████████████| 839/839 [00:22<00:00, 37.94it/s]





100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 32.33it/s]
AUC score for epoch 4 : 0.8394770622253418
Best AUC score is 0.8502848744392395
Epoch 5









100%|█████████████████████████████████████████| 839/839 [00:20<00:00, 40.05it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.09952086671771776




100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 42.57it/s]
AUC score for epoch 5 : 0.8410360217094421
Best AUC score is 0.8502848744392395
Epoch 6











100%|████████████████████████████████████████▉| 837/839 [00:23<00:00, 41.66it/s]
train loss = 0.09520978209169727
100%|█████████████████████████████████████████| 839/839 [00:23<00:00, 35.78it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.75it/s]
AUC score for epoch 6 : 0.8431693315505981
Best AUC score is 0.8502848744392395
Epoch 7










100%|█████████████████████████████████████████| 839/839 [00:21<00:00, 38.74it/s]
train loss = 0.08421761343582763
Performing evaluation of epoch 7




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 33.00it/s]
AUC score for epoch 7 : 0.8381677865982056
Best AUC score is 0.8502848744392395
Epoch 8









 98%|████████████████████████████████████████ | 819/839 [00:19<00:00, 40.02it/s]
train loss = 0.08275452483624995
100%|█████████████████████████████████████████| 839/839 [00:20<00:00, 41.89it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.60it/s]
AUC score for epoch 8 : 0.8416768312454224
Best AUC score is 0.8502848744392395
Epoch 9










100%|█████████████████████████████████████████| 839/839 [00:21<00:00, 38.89it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.08049534776656606




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 35.43it/s]
AUC score for epoch 9 : 0.8402439951896667
Best AUC score is 0.8502848744392395
Epoch 10









100%|█████████████████████████████████████████| 839/839 [00:20<00:00, 41.34it/s]
  0%|                                                   | 0/290 [00:00<?, ?it/s]
train loss = 0.08849287662637122



100%|█████████████████████████████████████████| 290/290 [00:06<00:00, 47.12it/s]
  0%|                                                   | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.8423073887825012
Best AUC score is 0.8502848744392395
BEST TEST AUC:  0.8502848744392395

 85%|██████████████████████████████████      | 168/197 [00:02<00:00, 181.13it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197

100%|█████████████████████████████████████████| 197/197 [00:02<00:00, 81.72it/s]










 99%|████████████████████████████████████████▌| 829/839 [00:21<00:00, 53.55it/s]
train loss = 0.07958097779781406
100%|█████████████████████████████████████████| 839/839 [00:22<00:00, 37.58it/s]





100%|█████████████████████████████████████████| 290/290 [00:09<00:00, 29.79it/s]
AUC score for epoch 1 : 0.8365119695663452
Best AUC score is 0.8502848744392395
Epoch 2











 99%|████████████████████████████████████████▊| 834/839 [00:22<00:00, 50.56it/s]
train loss = 0.07862109878015781
100%|█████████████████████████████████████████| 839/839 [00:22<00:00, 36.82it/s]




100%|█████████████████████████████████████████| 290/290 [00:08<00:00, 34.39it/s]
AUC score for epoch 2 : 0.8384769558906555
Best AUC score is 0.8502848744392395
Epoch 3







 80%|████████████████████████████████▋        | 670/839 [00:15<00:03, 43.86it/s]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 141, in train_once
    loss = train(epoch, model, optimizer, device, [train_anomaly_dl, train_normal_dl], train_bs)
  File "main.py", line 49, in train
    optim.step()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/optim/optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/optim/optimizer.py", line 23, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/optim/adam.py", line 234, in step
    adam(params_with_grad,
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/optim/adam.py", line 300, in adam
    func(params,
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/optim/adam.py", line 354, in _single_tensor_adam
    grad = grad.add(param, alpha=weight_decay)
KeyboardInterrupt
################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:14<00:00,  1.71it/s]
train loss = 0.9717305707931518
Performing evaluation of epoch 1




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.70it/s]
AUC score for epoch 1 : 0.7815144658088684
Saving the best model
Best AUC score is 0.7815144658088684
Epoch 2


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.92it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.8875037503242492





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.33it/s]
AUC score for epoch 2 : 0.7933095693588257
Saving the best model
Best AUC score is 0.7933095693588257
Epoch 3

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.42it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.7405526661872863






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.53it/s]
AUC score for epoch 3 : 0.7972840666770935
Saving the best model
Best AUC score is 0.7972840666770935
Epoch 4

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.91it/s]
train loss = 0.5199940168857574
Performing evaluation of epoch 4





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.54it/s]
AUC score for epoch 4 : 0.7991620302200317
Saving the best model
Best AUC score is 0.7991620302200317
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.14it/s]
train loss = 0.29731170475482943
Performing evaluation of epoch 5




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.86it/s]
AUC score for epoch 5 : 0.797488808631897
Best AUC score is 0.7991620302200317
Epoch 6



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  7.76it/s]
train loss = 0.15414229810237884
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.09it/s]







100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 18.27it/s]
AUC score for epoch 6 : 0.7963986396789551
Best AUC score is 0.7991620302200317
Epoch 7



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  8.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.32it/s]
AUC score for epoch 7 : 0.8004165887832642
Saving the best model
Best AUC score is 0.8004165887832642
Epoch 8



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  8.09it/s]
train loss = 0.043611357659101485
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  3.05it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.39it/s]
AUC score for epoch 8 : 0.7993730902671814
Best AUC score is 0.8004165887832642
Epoch 9


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00, 10.17it/s]
train loss = 0.02402502667158842
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.04it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.43it/s]
AUC score for epoch 9 : 0.7977498769760132
Best AUC score is 0.8004165887832642
Epoch 10

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 23/25 [00:07<00:00, 10.06it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:08<00:00,  2.98it/s]
Performing evaluation of epoch 10





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.60it/s]
AUC score for epoch 10 : 0.7976365089416504
Best AUC score is 0.8004165887832642
Epoch 11



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  3.63it/s]
train loss = 0.011347856167703866
Performing evaluation of epoch 11






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.88it/s]
AUC score for epoch 11 : 0.7987912893295288
Best AUC score is 0.8004165887832642
Epoch 12


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.29it/s]
train loss = 0.011504528354853391
Performing evaluation of epoch 12





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.81it/s]
AUC score for epoch 12 : 0.7987895011901855
Best AUC score is 0.8004165887832642
Epoch 13

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00, 11.95it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.41it/s]
Performing evaluation of epoch 13





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.25it/s]
AUC score for epoch 13 : 0.7975285649299622
Best AUC score is 0.8004165887832642
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:06<00:00,  4.09it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.006682490725070238





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.67it/s]
AUC score for epoch 14 : 0.7994723320007324
Best AUC score is 0.8004165887832642
Epoch 15

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:09<00:00,  2.52it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005833998238667846





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.94it/s]
AUC score for epoch 15 : 0.7990604639053345
Best AUC score is 0.8004165887832642
BEST TEST AUC:  0.8004165887832642
Loading the best model
Getting prediction on unlabelled dataset:

 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                            | 164/197 [00:03<00:00, 104.13it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 46.16it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.01it/s]
train loss = 0.047346355327005894
Performing evaluation of epoch 1






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.94it/s]
AUC score for epoch 1 : 0.799186646938324
Best AUC score is 0.8004165887832642
Epoch 2


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.025332042814365456





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.67it/s]
AUC score for epoch 2 : 0.7982704639434814
Best AUC score is 0.8004165887832642
Epoch 3

 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 17.81it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.91it/s]
Performing evaluation of epoch 3





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.60it/s]
AUC score for epoch 3 : 0.79802405834198
Best AUC score is 0.8004165887832642
Epoch 4



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.03it/s]
train loss = 0.008301046011703355
Performing evaluation of epoch 4




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.36it/s]
AUC score for epoch 4 : 0.7979608178138733
Best AUC score is 0.8004165887832642
Epoch 5



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00, 12.51it/s]
train loss = 0.011096338176035456
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.48it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.61it/s]
AUC score for epoch 5 : 0.7997344136238098
Best AUC score is 0.8004165887832642
Epoch 6


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.57it/s]
train loss = 0.005373796439796154
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.38it/s]
AUC score for epoch 6 : 0.7974996566772461
Best AUC score is 0.8004165887832642
Epoch 7



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.004919915285427123






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.58it/s]
AUC score for epoch 7 : 0.796607255935669
Best AUC score is 0.8004165887832642
Epoch 8

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.44it/s]
train loss = 0.004194265015290252
Performing evaluation of epoch 8




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.22it/s]
AUC score for epoch 8 : 0.7968718409538269
Best AUC score is 0.8004165887832642
Epoch 9


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.39it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003092018750196855





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.22it/s]
AUC score for epoch 9 : 0.79765784740448
Best AUC score is 0.8004165887832642
Epoch 10

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.05it/s]
train loss = 0.0031095520451864494
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.03it/s]
AUC score for epoch 10 : 0.7968413829803467
Best AUC score is 0.8004165887832642
Epoch 11



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.07it/s]
train loss = 0.002912710907237072
Performing evaluation of epoch 11





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.16it/s]
AUC score for epoch 11 : 0.796554684638977
Best AUC score is 0.8004165887832642
Epoch 12


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.39it/s]
train loss = 0.002551668236264959
Performing evaluation of epoch 12







100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:16<00:00, 17.72it/s]
AUC score for epoch 12 : 0.7969033122062683
Best AUC score is 0.8004165887832642
Epoch 13



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.94it/s]
train loss = 0.002051194048752742
Performing evaluation of epoch 13





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.31it/s]
AUC score for epoch 13 : 0.7970293760299683
Best AUC score is 0.8004165887832642
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.60it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0020470707594150944




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.58it/s]
AUC score for epoch 14 : 0.7968733310699463
Best AUC score is 0.8004165887832642
Epoch 15

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.19it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002277242888729753





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.64it/s]
AUC score for epoch 15 : 0.7969427108764648
Best AUC score is 0.8004165887832642
BEST TEST AUC:  0.8004165887832642
Loading the best model
Getting prediction on unlabelled dataset:

 86%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 169/197 [00:03<00:00, 132.24it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 50.09it/s]


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.20it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0459073913017554




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.93it/s]
AUC score for epoch 1 : 0.7993454933166504
Best AUC score is 0.8004165887832642
Epoch 2



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.93it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.02152772615331092





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.59it/s]
AUC score for epoch 2 : 0.7977035045623779
Best AUC score is 0.8004165887832642
Epoch 3



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.07it/s]
train loss = 0.009517579888259726
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.02it/s]
AUC score for epoch 3 : 0.7975503206253052
Best AUC score is 0.8004165887832642
Epoch 4


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.45it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.01449526527929785





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.55it/s]
AUC score for epoch 4 : 0.8026854395866394
Saving the best model
Best AUC score is 0.8026854395866394
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.38it/s]
train loss = 0.004323615060587015
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.25it/s]
AUC score for epoch 5 : 0.7994427680969238
Best AUC score is 0.8026854395866394
Epoch 6


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.73it/s]
train loss = 0.004174723298222359
Performing evaluation of epoch 6




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.36it/s]
AUC score for epoch 6 : 0.7991607189178467
Best AUC score is 0.8026854395866394
Epoch 7


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003350517670956573




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.23it/s]
AUC score for epoch 7 : 0.7996101379394531
Best AUC score is 0.8026854395866394
Epoch 8


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003501669961094324





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.95it/s]
AUC score for epoch 8 : 0.7974874377250671
Best AUC score is 0.8026854395866394
Epoch 9


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.29it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0038076623708807994





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.26it/s]
AUC score for epoch 9 : 0.798407793045044
Best AUC score is 0.8026854395866394
Epoch 10



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
train loss = 0.0023741581452278687
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.03it/s]
AUC score for epoch 10 : 0.7996093034744263
Best AUC score is 0.8026854395866394
Epoch 11


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.02it/s]
train loss = 0.002115447581413069
Performing evaluation of epoch 11





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.83it/s]
AUC score for epoch 11 : 0.7988283038139343
Best AUC score is 0.8026854395866394
Epoch 12



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.46it/s]
train loss = 0.0020564149599522352
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.21it/s]
AUC score for epoch 12 : 0.7990154027938843
Best AUC score is 0.8026854395866394
Epoch 13

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.90it/s]
train loss = 0.001988121233547905
Performing evaluation of epoch 13





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.76it/s]
AUC score for epoch 13 : 0.7987632751464844
Best AUC score is 0.8026854395866394
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.53it/s]
train loss = 0.0018862618245683344
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.16it/s]
AUC score for epoch 14 : 0.7981197237968445
Best AUC score is 0.8026854395866394
Epoch 15



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
train loss = 0.0022774776693300475
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.29it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7978793978691101
Best AUC score is 0.8026854395866394
BEST TEST AUC:  0.8026854395866394
Loading the best model


100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 61.09it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
Epoch 1

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.58it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005571506875899753





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.88it/s]
AUC score for epoch 1 : 0.7975083589553833
Best AUC score is 0.8026854395866394
Epoch 2


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.33it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0047656479790540674






100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.32it/s]
AUC score for epoch 2 : 0.7997788786888123
Best AUC score is 0.8026854395866394
Epoch 3



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.78it/s]
train loss = 0.0034579139901325107
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.26it/s]
AUC score for epoch 3 : 0.7968872785568237
Best AUC score is 0.8026854395866394
Epoch 4


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.26it/s]
train loss = 0.003746652647220929
Performing evaluation of epoch 4
 22%|█████████████████████████████████████▌                                                                                                                                       | 63/290 [00:03<00:06, 35.82it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:05<00:02, 48.32it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:07<00:04, 19.66it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:09<00:00, 55.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.14it/s]
AUC score for epoch 4 : 0.799207329750061
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:09,  2.59s/it]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:04<00:05,  3.44it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:06<00:00, 14.31it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0031480053439736366
  4%|███████▏                                                                                                                                                                     | 12/290 [00:02<00:42,  6.57it/s]
 26%|████████████████████████████████████████████▏                                                                                                                                | 74/290 [00:04<00:08, 26.50it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:06<00:03, 41.94it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:08<00:02, 34.67it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:10<00:02, 17.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.93it/s]
AUC score for epoch 5 : 0.8007793426513672
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:16,  1.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
train loss = 0.002381861683846052
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 31%|█████████████████████████████████████████████████████▋                                                                                                                       | 90/290 [00:03<00:05, 38.46it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:05<00:02, 46.78it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 236/290 [00:07<00:01, 30.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.81it/s]
AUC score for epoch 6 : 0.7981488704681396
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:03<00:02,  6.75it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00,  6.32it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0017673712822475604
  0%|▌                                                                                                                                                                             | 1/290 [00:02<11:31,  2.39s/it]
 25%|███████████████████████████████████████████▌                                                                                                                                 | 73/290 [00:04<00:07, 29.64it/s]
 40%|████████████████████████████████████████████████████████████████████▊                                                                                                       | 116/290 [00:06<00:07, 22.32it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:08<00:02, 37.59it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 248/290 [00:10<00:01, 32.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.96it/s]
AUC score for epoch 7 : 0.7974660396575928
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:05<02:20,  5.21s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.98it/s]
train loss = 0.0016733300331647374
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:03<00:11, 20.86it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:05<00:08, 22.31it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:07<00:02, 49.09it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 220/290 [00:09<00:02, 29.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.24it/s]
AUC score for epoch 8 : 0.7976664304733276
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 12.15it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0018399514083284885
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:02<00:10, 24.49it/s]
 43%|██████████████████████████████████████████████████████████████████████████▏                                                                                                 | 125/290 [00:04<00:03, 41.52it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:06<00:01, 43.09it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:08<00:00, 39.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.90it/s]
AUC score for epoch 9 : 0.7973147630691528
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:01<00:04,  5.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.66it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001401862341611247
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:03<00:13, 18.63it/s]
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:05<00:05, 35.64it/s]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                                                      | 172/290 [00:07<00:02, 39.60it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:09<00:02, 28.64it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:11<00:00, 31.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.37it/s]
AUC score for epoch 10 : 0.7968502044677734
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:01, 10.01it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 11.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.08it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:03<00:12, 20.52it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:04<00:04, 40.46it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 184/290 [00:07<00:01, 55.83it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:09<00:00, 81.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
AUC score for epoch 11 : 0.7967942953109741
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:17,  2.87s/it]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:05<00:09,  2.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.03it/s]
train loss = 0.0021153314758391517
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:03<00:14, 17.93it/s]
 35%|███████████████████████████████████████████████████████████▉                                                                                                                | 101/290 [00:05<00:05, 36.67it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:07<00:07, 19.40it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 230/290 [00:09<00:01, 42.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.97it/s]
AUC score for epoch 12 : 0.7959333062171936
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:06<00:00, 11.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.03it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:02<00:08, 28.73it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:05<00:02, 64.57it/s]
 74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 216/290 [00:06<00:02, 32.95it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:08<00:00, 43.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.48it/s]
AUC score for epoch 13 : 0.7957587838172913
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:02<00:03,  6.01it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00,  8.70it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0020253176605495226
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:02<00:12, 21.44it/s]
 29%|██████████████████████████████████████████████████                                                                                                                           | 84/290 [00:04<00:08, 24.19it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:06<00:02, 50.63it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:09<00:00, 64.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.50it/s]
AUC score for epoch 14 : 0.7987499833106995
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:03<01:38,  3.63s/it]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 13.22it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0012761227283460488
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:02<00:11, 22.94it/s]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:05<00:05, 36.99it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                    | 174/290 [00:06<00:03, 31.08it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:09<00:00, 55.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.99it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7983415722846985
Best AUC score is 0.8026854395866394
BEST TEST AUC:  0.8026854395866394
Loading the best model
 23%|███████████████████████████████████████▌                                                                                                                                     | 45/197 [00:02<00:04, 35.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 47.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 47.87it/s]
################################
TOTAL EPOCH:  5
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:14,  2.75s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 20.76it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.006547873124613294
 25%|██████████████████████████████████████████▉                                                                                                                                  | 72/290 [00:04<00:07, 30.51it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:07<00:04, 33.37it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 225/290 [00:09<00:01, 42.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.94it/s]
AUC score for epoch 1 : 0.7957584261894226
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:03<00:03,  5.54it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:01,  5.23it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005444355612520927
  8%|██████████████▎                                                                                                                                                              | 24/290 [00:02<00:17, 15.57it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:04<00:06, 26.74it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:06<00:03, 37.85it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:08<00:02, 24.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.72it/s]
AUC score for epoch 2 : 0.7996317744255066
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:14,  1.72it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 10.77it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 10.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.83it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▊                                                                                                                                            | 55/290 [00:03<00:06, 37.70it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 145/290 [00:05<00:03, 45.91it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:07<00:01, 41.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.70it/s]
AUC score for epoch 3 : 0.7983946800231934
Best AUC score is 0.8026854395866394
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:25,  1.05it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:13,  1.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.76it/s]
train loss = 0.0020568709088755505
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|███████████████████████▎                                                                                                                                                     | 39/290 [00:02<00:09, 27.85it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:04<00:06, 32.19it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:06<00:01, 59.90it/s]
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 269/290 [00:08<00:00, 50.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.74it/s]
AUC score for epoch 4 : 0.7993142604827881
Best AUC score is 0.8026854395866394
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:09,  2.68it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:05<00:00, 11.33it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:05<00:00, 11.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.45it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:03<00:07, 32.52it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:04<00:04, 44.09it/s]
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 221/290 [00:07<00:01, 55.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.14it/s]
AUC score for epoch 5 : 0.7983396053314209
Best AUC score is 0.8026854395866394
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:49,  1.83s/it]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:19,  1.29it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 13.99it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 13.99it/s]
train loss = 0.0030790527068477657
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:03<00:11, 22.71it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:05<00:04, 40.16it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:06<00:02, 45.34it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 273/290 [00:09<00:00, 73.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.10it/s]
AUC score for epoch 6 : 0.7983923554420471
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:02,  5.72it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:02,  5.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:02<00:09, 27.18it/s]
 40%|████████████████████████████████████████████████████████████████████▏                                                                                                       | 115/290 [00:04<00:04, 35.29it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 220/290 [00:06<00:01, 55.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.02it/s]
AUC score for epoch 7 : 0.79851233959198
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:04<00:00,  9.61it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:04<00:00,  9.61it/s]
train loss = 0.001516101773761745
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████                                                                                                                                                          | 32/290 [00:02<00:11, 22.54it/s]
 43%|██████████████████████████████████████████████████████████████████████████▏                                                                                                 | 125/290 [00:04<00:03, 52.66it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 220/290 [00:06<00:01, 49.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.75it/s]
AUC score for epoch 8 : 0.797967791557312
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:01<00:12, 21.72it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:04<00:03, 51.52it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:06<00:00, 119.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.68it/s]
AUC score for epoch 9 : 0.7972861528396606
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:02<00:05,  4.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 15.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 15.95it/s]
train loss = 0.0015378422519591237
  0%|▌                                                                                                                                                                             | 1/290 [00:01<07:06,  1.48s/it]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:03<00:04, 42.48it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                                                              | 158/290 [00:05<00:02, 58.94it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:07<00:00, 93.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.14it/s]
AUC score for epoch 10 : 0.7998297810554504
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:03<00:10,  1.98it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 11.55it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 11.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.51it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████                                                                                                                                                          | 32/290 [00:03<00:18, 14.12it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 178/290 [00:05<00:01, 80.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.33it/s]
AUC score for epoch 11 : 0.7980402112007141
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.53it/s]
train loss = 0.0017039706186291628
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:03<00:06, 39.21it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 165/290 [00:05<00:01, 72.94it/s]
 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 251/290 [00:07<00:00, 46.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.95it/s]
AUC score for epoch 12 : 0.7973012924194336
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:05<02:28,  5.52s/it]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:05<02:28,  5.52s/it]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:02<00:14, 18.53it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:04<00:01, 65.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.69it/s]
AUC score for epoch 13 : 0.7988758087158203
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:53,  1.98s/it]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:04<00:01,  7.87it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:04<00:01,  7.87it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<09:46,  2.03s/it]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:04<00:03, 49.91it/s]
 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 251/290 [00:06<00:00, 55.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.60it/s]
AUC score for epoch 14 : 0.7960249185562134
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:32,  1.22s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:00, 11.82it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:00, 11.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.70it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|██████▌                                                                                                                                                                      | 11/290 [00:02<00:42,  6.57it/s]
 39%|██████████████████████████████████████████████████████████████████▍                                                                                                         | 112/290 [00:04<00:03, 52.47it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 195/290 [00:05<00:01, 73.94it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:07<00:00, 72.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.97it/s]
AUC score for epoch 15 : 0.7933042049407959
Best AUC score is 0.8026854395866394
BEST TEST AUC:  0.8026854395866394
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 163/197 [00:03<00:00, 119.96it/s]
 83%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                             | 163/197 [00:03<00:00, 119.96it/s]
################################
TOTAL EPOCH:  6
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 57.89it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:30,  1.16s/it]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:23,  1.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.16it/s]
train loss = 0.005040584556159696
  3%|████▊                                                                                                                                                                         | 8/290 [00:01<00:45,  6.22it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:03<00:04, 42.86it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:05<00:02, 37.79it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:07<00:00, 83.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.53it/s]
AUC score for epoch 1 : 0.800286054611206
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:16,  1.44it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:16,  1.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.94it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  6%|██████████▏                                                                                                                                                                  | 17/290 [00:02<00:19, 13.99it/s]
 33%|████████████████████████████████████████████████████████▋                                                                                                                    | 95/290 [00:04<00:06, 32.27it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 225/290 [00:06<00:00, 76.81it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:08<00:00, 39.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.97it/s]
AUC score for epoch 2 : 0.7987350225448608
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:59,  2.19s/it]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:29,  1.20s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00, 15.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00, 15.99it/s]
train loss = 0.0027335556223988533
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:03<00:06, 33.41it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:05<00:01, 78.13it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:06<00:00, 69.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.15it/s]
AUC score for epoch 3 : 0.7982478141784668
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00, 12.04it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00, 12.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.38it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:03<00:04, 45.11it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:05<00:01, 52.80it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:06<00:00, 76.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.31it/s]
AUC score for epoch 4 : 0.798526406288147
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:03,  5.01it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:03,  5.01it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▍                                                                                                                                                                        | 9/290 [00:01<00:37,  7.40it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:04<00:03, 54.44it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 209/290 [00:06<00:02, 35.74it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:08<00:00, 37.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.71it/s]
AUC score for epoch 5 : 0.798323929309845
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:05<00:01,  7.73it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:05<00:01,  7.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.10it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|█████████████                                                                                                                                                                | 22/290 [00:02<00:16, 16.63it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:04<00:03, 50.59it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:06<00:00, 71.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.17it/s]
AUC score for epoch 6 : 0.7986975312232971
Best AUC score is 0.8026854395866394
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:25,  1.05it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:12,  1.87it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:01, 10.59it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:01, 10.59it/s]
train loss = 0.00143256746481971
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▍                                                                                                                                                                        | 9/290 [00:02<00:56,  4.97it/s]
 24%|█████████████████████████████████████████▊                                                                                                                                   | 70/290 [00:04<00:06, 36.37it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:06<00:03, 44.41it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:08<00:00, 95.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.51it/s]
AUC score for epoch 7 : 0.7981315851211548
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
train loss = 0.001634762522631458
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:03<00:04, 45.08it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 175/290 [00:05<00:02, 46.34it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:07<00:00, 104.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.01it/s]
AUC score for epoch 8 : 0.79800945520401
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:14,  2.75s/it]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:03,  5.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.40it/s]
train loss = 0.002123539907708099
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|█████████████████████████████████████████████▉                                                                                                                               | 77/290 [00:03<00:06, 32.84it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                             | 187/290 [00:05<00:01, 59.09it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:07<00:00, 73.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.51it/s]
AUC score for epoch 9 : 0.7982746362686157
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.91it/s]
train loss = 0.001320971334020474
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:03<00:03, 60.12it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:05<00:02, 59.86it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:07<00:00, 97.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.98it/s]
AUC score for epoch 10 : 0.7982175350189209
Best AUC score is 0.8026854395866394
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:16,  1.54it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:15,  1.57it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 14.17it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 14.17it/s]
train loss = 0.0016058193411611552
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:03<00:10, 24.41it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:05<00:03, 47.29it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 212/290 [00:07<00:01, 44.98it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:09<00:00, 51.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.93it/s]
AUC score for epoch 11 : 0.7984549403190613
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:04,  3.72it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:04,  3.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.11it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.11it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:03<00:03, 59.45it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:05<00:01, 65.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 52.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.03it/s]
AUC score for epoch 12 : 0.798861026763916
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:04<00:01,  7.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.34it/s]
train loss = 0.0024115592054191177
  0%|▌                                                                                                                                                                             | 1/290 [00:01<08:02,  1.67s/it]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:03<00:03, 52.72it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 184/290 [00:05<00:03, 34.55it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:07<00:00, 83.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.91it/s]
AUC score for epoch 13 : 0.7975727319717407
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.97it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.97it/s]
  6%|█████████▌                                                                                                                                                                   | 16/290 [00:01<00:20, 13.14it/s]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:03<00:03, 59.28it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 239/290 [00:05<00:00, 67.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.13it/s]
AUC score for epoch 14 : 0.7958784699440002
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:04<00:26,  1.06s/it]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:06<00:00,  8.65it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:06<00:00,  8.65it/s]
train loss = 0.0015388590213011152
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:03<00:07, 31.12it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:04<00:02, 55.06it/s]
 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 245/290 [00:07<00:00, 45.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.45it/s]
AUC score for epoch 15 : 0.7986767292022705
Best AUC score is 0.8026854395866394
BEST TEST AUC:  0.8026854395866394
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████▉                                                                                                                          | 58/197 [00:02<00:03, 39.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 50.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 50.53it/s]
################################
TOTAL EPOCH:  7
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005678148757267211
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:14, 18.63it/s]
 44%|████████████████████████████████████████████████████████████████████████████▌                                                                                               | 129/290 [00:04<00:02, 57.95it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 184/290 [00:06<00:03, 31.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 59.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.87it/s]
AUC score for epoch 1 : 0.7997350096702576
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01, 10.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.10it/s]
train loss = 0.0034927541107338455
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:03<00:07, 32.71it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 208/290 [00:05<00:01, 81.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.81it/s]
AUC score for epoch 2 : 0.7996679544448853
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 13.22it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 13.22it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:12, 21.25it/s]
 39%|██████████████████████████████████████████████████████████████████▍                                                                                                         | 112/290 [00:04<00:04, 43.53it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 233/290 [00:06<00:00, 81.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.39it/s]
AUC score for epoch 3 : 0.7994242906570435
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:02<00:04,  4.05it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0023229951122110443
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:07, 32.73it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:03<00:05, 33.60it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 230/290 [00:06<00:00, 74.57it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:07<00:00, 37.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.52it/s]
AUC score for epoch 4 : 0.8000049591064453
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 16.07it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 16.07it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  2%|███▌                                                                                                                                                                          | 6/290 [00:02<01:27,  3.25it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 145/290 [00:04<00:01, 73.40it/s]
 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                          | 245/290 [00:06<00:00, 47.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.11it/s]
AUC score for epoch 5 : 0.7989725470542908
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:04<00:08,  2.43it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00,  9.89it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00,  9.89it/s]
train loss = 0.0013714536513102108
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:03<00:07, 31.35it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                                                | 154/290 [00:05<00:02, 64.54it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:07<00:00, 77.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.66it/s]
AUC score for epoch 6 : 0.7984727621078491
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.93it/s]
train loss = 0.0017018803815257602
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|███████████████████████▊                                                                                                                                                     | 40/290 [00:02<00:07, 32.97it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:04<00:07, 26.15it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 186/290 [00:06<00:01, 60.62it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:08<00:00, 66.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.27it/s]
AUC score for epoch 7 : 0.7997248768806458
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:05<00:16,  1.43it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0018619921091677888
  0%|▌                                                                                                                                                                             | 1/290 [00:02<10:12,  2.12s/it]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:04<00:05, 38.35it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:06<00:00, 69.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 32.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.07it/s]
AUC score for epoch 8 : 0.7967902421951294
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
train loss = 0.0013571149819264455
  0%|▌                                                                                                                                                                             | 1/290 [00:01<08:36,  1.79s/it]
 31%|█████████████████████████████████████████████████████▋                                                                                                                       | 90/290 [00:03<00:04, 40.84it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:05<00:02, 47.79it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:07<00:00, 73.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.85it/s]
AUC score for epoch 9 : 0.7976421117782593
Best AUC score is 0.8026854395866394
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:01<00:04,  5.00it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00, 14.55it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.35it/s]
train loss = 0.02271870785833536
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                    | 42/290 [00:03<00:12, 20.58it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:05<00:02, 58.10it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:07<00:00, 76.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.25it/s]
AUC score for epoch 10 : 0.7975319027900696
Best AUC score is 0.8026854395866394
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:07<00:00, 14.64it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:07<00:00, 14.64it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:02<00:10, 25.02it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:04<00:01, 64.82it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 237/290 [00:06<00:01, 45.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.94it/s]
AUC score for epoch 11 : 0.8029850721359253
Saving the best model
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:11,  2.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.87it/s]
train loss = 0.0016885051050589287
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:03<00:02, 68.07it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:05<00:01, 71.07it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:07<00:00, 66.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.93it/s]
AUC score for epoch 12 : 0.7995383143424988
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 15.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 15.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|█████████████                                                                                                                                                                | 22/290 [00:02<00:14, 19.11it/s]
 38%|████████████████████████████████████████████████████████████████▋                                                                                                           | 109/290 [00:04<00:05, 33.32it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:06<00:03, 31.27it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:08<00:00, 80.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.52it/s]
AUC score for epoch 13 : 0.798400342464447
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:08,  2.53s/it]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:03,  4.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.39it/s]
train loss = 0.0008476302443471338
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:03<00:03, 50.42it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:05<00:02, 44.98it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 277/290 [00:07<00:00, 60.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.66it/s]
AUC score for epoch 14 : 0.7988132834434509
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:05<00:08,  2.40it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:05<00:08,  2.40it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:04<00:08, 28.03it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:05<00:04, 31.41it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 233/290 [00:08<00:01, 49.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.75it/s]
AUC score for epoch 15 : 0.7997696995735168
Best AUC score is 0.8029850721359253
BEST TEST AUC:  0.8029850721359253
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                      | 153/197 [00:02<00:00, 128.37it/s]
 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                      | 153/197 [00:02<00:00, 128.37it/s]
################################
TOTAL EPOCH:  8
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 56.45it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 13.38it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 13.38it/s]
train loss = 0.0035185707446154474
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▍                                                                                                                                                                        | 9/290 [00:02<01:01,  4.54it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:04<00:03, 56.61it/s]
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                           | 190/290 [00:06<00:01, 83.33it/s]
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 274/290 [00:08<00:00, 39.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.71it/s]
AUC score for epoch 1 : 0.8008145093917847
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 17.69it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 17.69it/s]
train loss = 0.0007789681653126276
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:03<00:03, 63.91it/s]
 59%|████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                       | 170/290 [00:04<00:02, 59.82it/s]
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 279/290 [00:07<00:00, 52.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.08it/s]
AUC score for epoch 2 : 0.7987073063850403
Best AUC score is 0.8029850721359253
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:11,  2.14it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:01,  9.39it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009569357976683282
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:13, 20.08it/s]
 40%|████████████████████████████████████████████████████████████████████▏                                                                                                       | 115/290 [00:04<00:04, 35.99it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:06<00:02, 35.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.47it/s]
AUC score for epoch 3 : 0.7988274097442627
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 13.52it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 13.52it/s]
train loss = 0.0011630512370694695
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:03<00:06, 35.73it/s]
 41%|██████████████████████████████████████████████████████████████████████▌                                                                                                     | 119/290 [00:04<00:03, 44.70it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:06<00:02, 43.43it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:08<00:00, 91.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.93it/s]
AUC score for epoch 4 : 0.797696053981781
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:23,  1.13it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:27,  1.12s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:06<00:01,  8.92it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:06<00:01,  8.92it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:10, 25.04it/s]
 44%|████████████████████████████████████████████████████████████████████████████▌                                                                                               | 129/290 [00:04<00:02, 55.96it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 234/290 [00:06<00:00, 62.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.45it/s]
AUC score for epoch 5 : 0.7976520657539368
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:05<02:26,  5.41s/it]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0012058565813016944
  1%|█▊                                                                                                                                                                            | 3/290 [00:02<02:45,  1.73it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:04<00:03, 60.07it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 184/290 [00:06<00:01, 58.92it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:07<00:00, 95.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.13it/s]
AUC score for epoch 6 : 0.7988628149032593
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:03<00:48,  1.85s/it]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 13.03it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 13.03it/s]
train loss = 0.001087635163068106
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  6%|██████████▋                                                                                                                                                                  | 18/290 [00:02<00:23, 11.37it/s]
 26%|████████████████████████████████████████████▋                                                                                                                                | 75/290 [00:04<00:08, 24.87it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 159/290 [00:07<00:03, 37.88it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                           | 244/290 [00:08<00:00, 78.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.48it/s]
AUC score for epoch 7 : 0.7976842522621155
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 14.08it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 14.08it/s]
train loss = 0.0007073875624753002
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:03<00:09, 25.36it/s]
 45%|█████████████████████████████████████████████████████████████████████████████                                                                                               | 130/290 [00:05<00:03, 47.94it/s]
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 201/290 [00:06<00:01, 58.68it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 278/290 [00:08<00:00, 47.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.59it/s]
AUC score for epoch 8 : 0.7968929409980774
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:12,  1.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008250878173774774
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:02<00:10, 24.61it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:04<00:04, 37.75it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 195/290 [00:06<00:01, 52.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.40it/s]
AUC score for epoch 9 : 0.797089695930481
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:03<00:01,  9.01it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009535437306372582
  6%|█████████▌                                                                                                                                                                   | 16/290 [00:02<00:21, 12.96it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:04<00:03, 44.26it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 240/290 [00:06<00:00, 84.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.13it/s]
AUC score for epoch 10 : 0.797886073589325
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:23,  1.10it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.13it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.13it/s]
train loss = 0.0007232941685028241
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:03<00:08, 27.48it/s]
 59%|████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                       | 170/290 [00:05<00:02, 57.89it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:07<00:00, 58.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.23it/s]
AUC score for epoch 11 : 0.7974326014518738
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:05<00:00, 11.76it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007752570589738232
 14%|███████████████████████▊                                                                                                                                                     | 40/290 [00:02<00:07, 33.97it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:04<00:03, 43.29it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 198/290 [00:06<00:04, 22.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.53it/s]
AUC score for epoch 12 : 0.7972147464752197
Best AUC score is 0.8029850721359253
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:21,  1.28it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:04<00:01,  9.72it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007503656691239614
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:02<00:11, 22.73it/s]
 48%|██████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 139/290 [00:04<00:02, 59.76it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:06<00:05, 22.19it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:08<00:00, 53.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.47it/s]
AUC score for epoch 13 : 0.796960175037384
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:16,  1.47it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:06<00:00,  8.43it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007623515349613237
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:04<00:06, 36.49it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:06<00:05, 32.90it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 157/290 [00:07<00:05, 23.47it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 243/290 [00:10<00:00, 58.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 24.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 24.00it/s]
AUC score for epoch 14 : 0.7968811988830566
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:09,  2.51it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:05<00:02,  5.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.68it/s]
train loss = 0.0017480050488042512
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<13:54,  2.89s/it]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:05<00:04, 48.10it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:07<00:02, 49.31it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:09<00:00, 71.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.85it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8004246354103088
Best AUC score is 0.8029850721359253
BEST TEST AUC:  0.8029850721359253
Loading the best model
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 172/197 [00:04<00:00, 130.46it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                     | 172/197 [00:04<00:00, 130.46it/s]
################################
TOTAL EPOCH:  9
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 36.37it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:04<00:00, 14.15it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0015445391005154566
 14%|█████████████████████████                                                                                                                                                    | 42/290 [00:03<00:07, 32.11it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:04<00:06, 32.18it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:07<00:01, 54.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 40.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.21it/s]
AUC score for epoch 1 : 0.8004138469696045
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:05<00:01, 10.14it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000895627003046684
 15%|█████████████████████████▋                                                                                                                                                   | 43/290 [00:02<00:08, 30.76it/s]
 35%|████████████████████████████████████████████████████████████▍                                                                                                               | 102/290 [00:03<00:06, 30.22it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:06<00:02, 40.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 48.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.15it/s]
AUC score for epoch 2 : 0.7992022633552551
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:02<00:02,  8.36it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.15it/s]
train loss = 0.0008954051528624925
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:03<00:07, 30.87it/s]
 53%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 153/290 [00:05<00:03, 38.11it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:07<00:00, 90.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.07it/s]
AUC score for epoch 3 : 0.7990239858627319
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:04<00:06,  3.12it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0011029867309844121
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:04<00:03, 57.19it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:06<00:02, 42.50it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 260/290 [00:08<00:00, 53.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.50it/s]
AUC score for epoch 4 : 0.8003288507461548
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:04<00:04,  4.40it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 12.86it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 12.86it/s]
train loss = 0.000928877416299656
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▊                                                                                                                                               | 50/290 [00:03<00:07, 31.10it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:05<00:03, 42.35it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:07<00:00, 88.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.03it/s]
AUC score for epoch 5 : 0.7992343902587891
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:06,  2.47s/it]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:04<00:01,  9.04it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008503804658955362
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:02<00:06, 37.15it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:04<00:03, 38.71it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:06<00:00, 44.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.21it/s]
AUC score for epoch 6 : 0.7989234924316406
Best AUC score is 0.8029850721359253
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:26,  1.00it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:05<00:00, 10.36it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0035438606947926538
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:09, 26.57it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:03<00:02, 59.41it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:06<00:00, 65.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.72it/s]
AUC score for epoch 7 : 0.7990856766700745
Best AUC score is 0.8029850721359253
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:13,  2.73s/it]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:04<00:02,  5.15it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 11.20it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 11.20it/s]
train loss = 0.002094652139930986
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  6%|█████████▌                                                                                                                                                                   | 16/290 [00:03<00:26, 10.28it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:04<00:04, 47.16it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:07<00:03, 43.20it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:09<00:01, 34.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.33it/s]
AUC score for epoch 8 : 0.8047065734863281
Saving the best model
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 15.34it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 15.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.16it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                           | 84/290 [00:03<00:04, 45.65it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                              | 211/290 [00:05<00:01, 70.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.01it/s]
AUC score for epoch 9 : 0.7999719381332397
Best AUC score is 0.8047065734863281
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:23,  1.09it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 15.54it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 15.54it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|█████████████████████▍                                                                                                                                                       | 36/290 [00:03<00:11, 21.37it/s]
 37%|██████████████████████████████████████████████████████████████▊                                                                                                             | 106/290 [00:05<00:05, 36.80it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 217/290 [00:06<00:00, 77.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.09it/s]
AUC score for epoch 10 : 0.7989931702613831
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:03<00:00, 21.04it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006734411113679276
  2%|████▏                                                                                                                                                                         | 7/290 [00:02<01:02,  4.56it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:03<00:03, 63.07it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:05<00:01, 73.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.82it/s]
AUC score for epoch 11 : 0.7990754246711731
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:10,  2.61s/it]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:24,  1.04s/it]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006744607412006839
  0%|▌                                                                                                                                                                             | 1/290 [00:02<10:02,  2.08s/it]
 24%|█████████████████████████████████████████▊                                                                                                                                   | 70/290 [00:04<00:06, 32.98it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:06<00:05, 29.41it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:08<00:01, 42.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.77it/s]
AUC score for epoch 12 : 0.7990346550941467
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:04<00:00, 10.29it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006911036523108903
  5%|████████▉                                                                                                                                                                    | 15/290 [00:02<00:27, 10.15it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:04<00:05, 36.75it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 173/290 [00:05<00:03, 38.01it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:07<00:00, 61.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.45it/s]
AUC score for epoch 13 : 0.798831582069397
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:54,  2.04s/it]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:04<00:00, 10.55it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007939667172779861
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:02<00:06, 39.11it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:04<00:03, 46.72it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:06<00:01, 51.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.18it/s]
AUC score for epoch 14 : 0.7986013293266296
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 12.89it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008148601274504992
  7%|███████████▉                                                                                                                                                                 | 20/290 [00:02<00:21, 12.82it/s]
 24%|██████████████████████████████████████████▎                                                                                                                                  | 71/290 [00:04<00:06, 34.62it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:06<00:02, 60.44it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 218/290 [00:08<00:01, 48.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.49it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7992952466011047
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
 51%|███████████████████████████████████████████████████████████████████████████████████████▎                                                                                    | 100/197 [00:04<00:01, 61.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 34.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 34.02it/s]
################################
TOTAL EPOCH:  10
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|█████████████████████████████████████▌                                                                                                                                       | 63/290 [00:04<00:04, 46.46it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:06<00:06, 23.95it/s]
 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 222/290 [00:08<00:01, 39.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.64it/s]
AUC score for epoch 1 : 0.801323652267456
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:04<00:49,  1.90s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00, 12.03it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00, 12.03it/s]
train loss = 0.0010463389688603847
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:03<00:07, 34.20it/s]
 40%|████████████████████████████████████████████████████████████████████▏                                                                                                       | 115/290 [00:05<00:04, 40.37it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 203/290 [00:07<00:01, 58.26it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:09<00:00, 50.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.38it/s]
AUC score for epoch 2 : 0.7988032102584839
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:03<00:07,  3.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
train loss = 0.0007303457563726365
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:03<00:08, 29.12it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:05<00:03, 40.11it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 203/290 [00:07<00:02, 43.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.55it/s]
AUC score for epoch 3 : 0.8003188371658325
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:16,  1.56it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:01,  6.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006726208968237708
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:02<00:03, 53.45it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:04<00:02, 45.19it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:06<00:00, 112.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.91it/s]
AUC score for epoch 4 : 0.7998727560043335
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:07,  3.14it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.52it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:05<00:06, 33.70it/s]
 48%|███████████████████████████████████████████████████████████████████████████████████                                                                                         | 140/290 [00:07<00:03, 43.30it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:08<00:07, 18.05it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 229/290 [00:11<00:02, 21.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.49it/s]
AUC score for epoch 5 : 0.7978886365890503
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:01<00:06,  3.61it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 10.97it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.00107904334124344
 18%|███████████████████████████████▌                                                                                                                                             | 53/290 [00:04<00:07, 31.42it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:06<00:09, 21.13it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 151/290 [00:08<00:03, 39.68it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:10<00:01, 61.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.65it/s]
AUC score for epoch 6 : 0.7996882796287537
Best AUC score is 0.8047065734863281
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:10,  2.45it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:03<00:03,  5.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.02it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:05<00:06, 36.35it/s]
 36%|█████████████████████████████████████████████████████████████                                                                                                               | 103/290 [00:07<00:09, 18.95it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 162/290 [00:09<00:03, 33.69it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 233/290 [00:10<00:01, 39.75it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:12<00:00, 50.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.67it/s]
AUC score for epoch 7 : 0.799832820892334
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:04<00:03,  5.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.47it/s]
train loss = 0.0007144326539543856
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|████▊                                                                                                                                                                         | 8/290 [00:03<01:26,  3.26it/s]
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:05<00:17, 13.93it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:07<00:04, 40.88it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                          | 164/290 [00:09<00:03, 39.83it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 217/290 [00:11<00:02, 28.55it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:12<00:00, 66.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.80it/s]
AUC score for epoch 8 : 0.7994840145111084
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 13.66it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007983030310632395
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:04<00:35,  7.68it/s]
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:06<00:10, 21.05it/s]
 48%|███████████████████████████████████████████████████████████████████████████████████                                                                                         | 140/290 [00:08<00:03, 41.25it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:09<00:02, 43.08it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 249/290 [00:12<00:01, 28.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.67it/s]
AUC score for epoch 9 : 0.799569845199585
Best AUC score is 0.8047065734863281
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:01<00:06,  3.85it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:03<00:00,  9.42it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006834583140776626
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:04<00:09, 25.51it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:05<00:09, 20.78it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                      | 171/290 [00:08<00:04, 28.36it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 237/290 [00:10<00:01, 28.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.17it/s]
AUC score for epoch 10 : 0.800180196762085
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00, 13.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.40it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.40it/s]
train loss = 0.0008211815407516301
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:03<00:09, 26.92it/s]
 29%|█████████████████████████████████████████████████▌                                                                                                                           | 83/290 [00:05<00:07, 26.53it/s]
 45%|█████████████████████████████████████████████████████████████████████████████▋                                                                                              | 131/290 [00:07<00:04, 35.86it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 208/290 [00:09<00:03, 24.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.38it/s]
AUC score for epoch 11 : 0.7986027598381042
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:02<00:01,  8.26it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0012720290324068628
 12%|█████████████████████▍                                                                                                                                                       | 36/290 [00:04<00:12, 20.36it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:06<00:06, 32.48it/s]
 45%|█████████████████████████████████████████████████████████████████████████████                                                                                               | 130/290 [00:08<00:05, 27.55it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:09<00:02, 42.98it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 76.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.65it/s]
AUC score for epoch 12 : 0.799525260925293
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:03<00:01,  8.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.70it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006821541257003057
 17%|█████████████████████████████▊                                                                                                                                               | 50/290 [00:05<00:08, 26.85it/s]
 34%|███████████████████████████████████████████████████████████▎                                                                                                                | 100/290 [00:07<00:05, 33.83it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 156/290 [00:09<00:03, 35.36it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 212/290 [00:11<00:01, 39.76it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 267/290 [00:13<00:00, 36.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.34it/s]
AUC score for epoch 13 : 0.7985655069351196
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:02,  7.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.43it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:05<00:17, 15.04it/s]
 25%|██████████████████████████████████████████▉                                                                                                                                  | 72/290 [00:07<00:10, 20.57it/s]
 44%|███████████████████████████████████████████████████████████████████████████▎                                                                                                | 127/290 [00:09<00:08, 18.18it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:11<00:02, 41.42it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:13<00:00, 48.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.90it/s]
AUC score for epoch 14 : 0.7983861565589905
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:11,  2.02it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 12.15it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006057068832368324
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:04<00:06, 34.83it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:06<00:03, 44.38it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:08<00:02, 36.42it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:10<00:01, 36.47it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 43.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.28it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7986503839492798
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
 27%|██████████████████████████████████████████████▌                                                                                                                              | 53/197 [00:04<00:05, 27.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 34.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 34.55it/s]
################################
TOTAL EPOCH:  11
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:02<00:03,  5.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.31it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|███████████████████████▊                                                                                                                                                     | 40/290 [00:05<00:13, 19.12it/s]
 25%|██████████████████████████████████████████▉                                                                                                                                  | 72/290 [00:07<00:10, 21.35it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:09<00:03, 37.85it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 175/290 [00:11<00:09, 11.57it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 229/290 [00:13<00:01, 32.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 18.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 18.68it/s]
AUC score for epoch 1 : 0.7997381091117859
Best AUC score is 0.8047065734863281
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:25,  1.07it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:02<00:00, 13.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.52it/s]
train loss = 0.0005965481000852638
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:03<00:12, 20.60it/s]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:05<00:06, 29.29it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▎                                                                             | 159/290 [00:07<00:02, 54.30it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 195/290 [00:09<00:02, 34.29it/s]
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 279/290 [00:12<00:00, 51.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.99it/s]
AUC score for epoch 2 : 0.7987273931503296
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 17.32it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006833793647404361
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:04<00:07, 31.18it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:06<00:03, 43.27it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:08<00:03, 35.91it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:10<00:01, 20.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.27it/s]
AUC score for epoch 3 : 0.7986820936203003
Best AUC score is 0.8047065734863281
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:11,  2.15it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00, 15.14it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006751789904748355
  2%|███▌                                                                                                                                                                          | 6/290 [00:02<01:33,  3.02it/s]
 18%|██████████████████████████████▍                                                                                                                                              | 51/290 [00:04<00:08, 27.92it/s]
 39%|███████████████████████████████████████████████████████████████████▌                                                                                                        | 114/290 [00:06<00:05, 31.86it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:08<00:03, 35.03it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 235/290 [00:10<00:01, 37.16it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:12<00:00, 29.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.77it/s]
AUC score for epoch 4 : 0.798913300037384
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:59,  2.20s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:04<00:00, 10.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006476098611269013
  6%|█████████▌                                                                                                                                                                   | 16/290 [00:03<00:37,  7.25it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:05<00:07, 29.46it/s]
 45%|█████████████████████████████████████████████████████████████████████████████                                                                                               | 130/290 [00:07<00:05, 28.96it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:09<00:02, 40.93it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 260/290 [00:11<00:00, 33.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.69it/s]
AUC score for epoch 5 : 0.7991988062858582
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:29,  1.10s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01, 10.73it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.44it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005963593243255413
 14%|█████████████████████████                                                                                                                                                    | 42/290 [00:03<00:08, 30.65it/s]
 39%|███████████████████████████████████████████████████████████████████▌                                                                                                        | 114/290 [00:05<00:03, 49.02it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:07<00:08, 17.64it/s]
 78%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 225/290 [00:09<00:01, 52.10it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:10<00:00, 59.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.34it/s]
AUC score for epoch 6 : 0.7989421486854553
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:04<00:12,  1.88it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00,  6.63it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008612826308568142
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:04<00:07, 30.44it/s]
 38%|█████████████████████████████████████████████████████████████████▊                                                                                                          | 111/290 [00:06<00:03, 44.86it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                             | 187/290 [00:08<00:02, 41.21it/s]
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                | 263/290 [00:10<00:00, 33.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.33it/s]
AUC score for epoch 7 : 0.7994543313980103
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:03<01:37,  3.60s/it]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:05<00:01,  6.33it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007932091445711974
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:02<00:12, 21.19it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:04<00:05, 36.34it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:06<00:03, 47.67it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:08<00:02, 34.26it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉             | 268/290 [00:10<00:00, 31.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.03it/s]
AUC score for epoch 8 : 0.7989203333854675
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:05<00:02,  6.24it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007123166215023957
 23%|████████████████████████████████████████▌                                                                                                                                    | 68/290 [00:03<00:05, 42.41it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:05<00:10, 18.14it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 157/290 [00:08<00:05, 24.08it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 209/290 [00:09<00:01, 47.71it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:11<00:00, 43.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.37it/s]
AUC score for epoch 9 : 0.7986726760864258
Best AUC score is 0.8047065734863281
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:32,  1.22s/it]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:15,  1.53it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 13.24it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008263280355354904
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:04<00:13, 18.57it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:06<00:05, 35.64it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:08<00:05, 28.68it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:11<00:04, 25.94it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 230/290 [00:12<00:02, 26.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 19.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 19.29it/s]
AUC score for epoch 10 : 0.7987735271453857
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:01, 10.55it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00,  8.65it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00,  8.65it/s]
train loss = 0.0007074669047142379
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 15%|█████████████████████████▋                                                                                                                                                   | 43/290 [00:05<00:11, 21.39it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:07<00:07, 25.58it/s]
 49%|███████████████████████████████████████████████████████████████████████████████████▋                                                                                        | 141/290 [00:09<00:05, 24.85it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:10<00:02, 39.65it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:13<00:00, 46.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.58it/s]
AUC score for epoch 11 : 0.7985938191413879
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:12,  1.97it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:04<00:02,  5.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  8.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  8.25it/s]
train loss = 0.0006455819509158443
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:04<00:17, 14.73it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:06<00:11, 20.59it/s]
 43%|██████████████████████████████████████████████████████████████████████████▏                                                                                                 | 125/290 [00:08<00:05, 32.95it/s]
 65%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                            | 188/290 [00:10<00:03, 27.45it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:12<00:00, 45.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.08it/s]
AUC score for epoch 12 : 0.7985634803771973
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:03<00:01,  8.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.25it/s]
train loss = 0.000750221183157659
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:05<00:28,  9.54it/s]
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:06<00:06, 36.63it/s]
 45%|█████████████████████████████████████████████████████████████████████████████▋                                                                                              | 131/290 [00:09<00:05, 30.49it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 198/290 [00:11<00:01, 46.16it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:13<00:00, 54.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.56it/s]
AUC score for epoch 13 : 0.7983719706535339
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:01,  9.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 11.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 11.44it/s]
train loss = 0.0007811470651566717
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:04<00:21, 12.38it/s]
 28%|████████████████████████████████████████████████▉                                                                                                                            | 82/290 [00:07<00:10, 19.89it/s]
 39%|███████████████████████████████████████████████████████████████████                                                                                                         | 113/290 [00:08<00:15, 11.28it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:11<00:02, 44.27it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 262/290 [00:12<00:00, 54.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.64it/s]
AUC score for epoch 14 : 0.7973709106445312
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:56,  2.10s/it]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 12.57it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 12.57it/s]
train loss = 0.0009258787914794604
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:04<00:23, 11.20it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:06<00:06, 29.40it/s]
 47%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 137/290 [00:07<00:02, 51.95it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:10<00:04, 18.53it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:12<00:00, 43.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.78it/s]
AUC score for epoch 15 : 0.7995161414146423
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                           | 111/197 [00:04<00:01, 78.17it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                           | 111/197 [00:04<00:01, 78.17it/s]
################################
TOTAL EPOCH:  12
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 34.33it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:12,  2.10it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:01,  9.80it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:01,  9.80it/s]
train loss = 0.002604616157311414
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:06<00:07, 29.46it/s]
 35%|███████████████████████████████████████████████████████████▉                                                                                                                | 101/290 [00:07<00:05, 33.19it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:10<00:05, 28.11it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                | 208/290 [00:12<00:01, 41.60it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 278/290 [00:14<00:00, 43.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 18.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:15<00:00, 18.53it/s]
AUC score for epoch 1 : 0.7955605387687683
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00,  9.93it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00,  9.93it/s]
train loss = 0.0011970380167310526
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:04<00:13, 19.68it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:06<00:09, 21.71it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:08<00:07, 19.85it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 198/290 [00:10<00:01, 47.48it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:12<00:00, 62.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.55it/s]
AUC score for epoch 2 : 0.8010474443435669
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:17,  1.54it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00,  9.16it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00,  9.16it/s]
train loss = 0.0006272231195388096
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:03<00:05, 39.56it/s]
 38%|████████████████████████████████████████████████████████████████▋                                                                                                           | 109/290 [00:06<00:10, 16.80it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:08<00:04, 29.50it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:10<00:01, 34.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.88it/s]
AUC score for epoch 3 : 0.8013340830802917
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:02<00:01, 12.61it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:02<00:01, 12.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.39it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:05<00:11, 22.00it/s]
 33%|████████████████████████████████████████████████████████▋                                                                                                                    | 95/290 [00:07<00:10, 18.45it/s]
 45%|█████████████████████████████████████████████████████████████████████████████                                                                                               | 130/290 [00:09<00:11, 14.18it/s]
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 213/290 [00:11<00:01, 40.00it/s]
 91%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 264/290 [00:13<00:00, 40.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.71it/s]
AUC score for epoch 4 : 0.8002816438674927
Best AUC score is 0.8047065734863281
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:14,  1.81it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:03<00:10,  2.03it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:05,  2.88it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:05,  2.88it/s]
train loss = 0.0005711136930455853
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:04<00:15, 17.07it/s]
 36%|█████████████████████████████████████████████████████████████                                                                                                               | 103/290 [00:06<00:04, 41.60it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                                                | 154/290 [00:08<00:03, 34.93it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 212/290 [00:10<00:02, 35.75it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 57.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.73it/s]
AUC score for epoch 5 : 0.8000870943069458
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:04<00:02,  6.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.43it/s]
train loss = 0.000601034243507976
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 18%|███████████████████████████████                                                                                                                                              | 52/290 [00:03<00:05, 41.21it/s]
 38%|█████████████████████████████████████████████████████████████████▊                                                                                                          | 111/290 [00:05<00:05, 33.27it/s]
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                           | 190/290 [00:07<00:02, 45.74it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 252/290 [00:09<00:01, 30.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.64it/s]
AUC score for epoch 6 : 0.7996618747711182
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 11.32it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 11.32it/s]
train loss = 0.0006108438974479213
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|██▍                                                                                                                                                                           | 4/290 [00:02<02:16,  2.10it/s]
 24%|█████████████████████████████████████████▊                                                                                                                                   | 70/290 [00:04<00:07, 27.84it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:06<00:03, 50.67it/s]
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                         | 193/290 [00:08<00:01, 51.45it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 267/290 [00:10<00:00, 41.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.71it/s]
AUC score for epoch 7 : 0.7992002367973328
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:36,  1.37s/it]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:00, 12.83it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:00, 12.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:05<00:07, 30.13it/s]
 41%|███████████████████████████████████████████████████████████████████████▏                                                                                                    | 120/290 [00:07<00:05, 33.77it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:09<00:04, 22.36it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:11<00:00, 67.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.06it/s]
AUC score for epoch 8 : 0.8016422986984253
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:04,  5.12it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.79it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.79it/s]
train loss = 0.0007502685849820929
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:03<00:15, 16.59it/s]
 35%|███████████████████████████████████████████████████████████▉                                                                                                                | 101/290 [00:05<00:05, 32.38it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:07<00:02, 45.96it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                       | 224/290 [00:09<00:02, 24.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
AUC score for epoch 9 : 0.8005756139755249
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:52,  1.94s/it]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:05<00:09,  2.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.74it/s]
train loss = 0.0006320853592894439
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:03<00:20, 13.41it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:05<00:10, 21.64it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:07<00:02, 51.39it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 246/290 [00:09<00:00, 48.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.87it/s]
AUC score for epoch 10 : 0.7994946837425232
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:07<00:15,  1.37it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:08<00:00,  7.46it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:08<00:00,  7.46it/s]
train loss = 0.0005863196368279335
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  2%|███                                                                                                                                                                           | 5/290 [00:02<01:43,  2.76it/s]
 26%|████████████████████████████████████████████▋                                                                                                                                | 75/290 [00:04<00:06, 35.03it/s]
 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                                                      | 172/290 [00:06<00:01, 70.94it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:09<00:02, 22.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.80it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.80it/s]
AUC score for epoch 11 : 0.7987849712371826
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:04<00:09,  2.32it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00,  8.49it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00,  8.49it/s]
train loss = 0.0005775818935944699
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:02<00:15, 17.26it/s]
 33%|█████████████████████████████████████████████████████████▎                                                                                                                   | 96/290 [00:04<00:05, 34.13it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 156/290 [00:06<00:02, 49.54it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 223/290 [00:08<00:01, 51.90it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:10<00:00, 58.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.31it/s]
AUC score for epoch 12 : 0.7990092635154724
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:09,  2.49it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 12.71it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 12.71it/s]
train loss = 0.0010212512570433319
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  2%|████▏                                                                                                                                                                         | 7/290 [00:02<01:07,  4.21it/s]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:04<00:03, 61.19it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:06<00:02, 50.47it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 235/290 [00:08<00:02, 23.51it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:10<00:00, 27.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.51it/s]
AUC score for epoch 13 : 0.7994335889816284
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:04<00:02,  6.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.93it/s]
train loss = 0.00076120605912625
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 24%|█████████████████████████████████████████▏                                                                                                                                   | 69/290 [00:03<00:04, 44.62it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:05<00:04, 36.77it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                              | 211/290 [00:07<00:01, 50.85it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:09<00:00, 43.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.81it/s]
AUC score for epoch 14 : 0.8017078638076782
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:02<00:01, 11.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.85it/s]
train loss = 0.0008011355717566662
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:03<00:11, 22.02it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:05<00:03, 47.37it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:07<00:02, 47.63it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 243/290 [00:10<00:01, 32.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.71it/s]
AUC score for epoch 15 : 0.8011934757232666
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 54.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 54.73it/s]
################################
TOTAL EPOCH:  13
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:03<00:44,  1.70s/it]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:06<00:02,  4.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.19it/s]
train loss = 0.0008781048319568592
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:03<00:07, 32.04it/s]
 33%|█████████████████████████████████████████████████████████▎                                                                                                                   | 96/290 [00:05<00:07, 24.26it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:07<00:02, 40.28it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                       | 224/290 [00:09<00:02, 28.71it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:11<00:00, 48.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.17it/s]
AUC score for epoch 1 : 0.8025094270706177
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:26,  1.02s/it]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:04<00:15,  1.44it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:07<00:01,  6.06it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007519715997789587
 11%|███████████████████                                                                                                                                                          | 32/290 [00:04<00:16, 15.43it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:06<00:05, 34.60it/s]
 45%|█████████████████████████████████████████████████████████████████████████████▋                                                                                              | 131/290 [00:08<00:07, 21.91it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:09<00:02, 46.20it/s]
 83%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                            | 242/290 [00:12<00:01, 33.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.46it/s]
AUC score for epoch 2 : 0.8003427982330322
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:04<00:45,  1.74s/it]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:06<00:00,  8.22it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:06<00:00,  8.22it/s]
train loss = 0.0006596571963330332
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▉                                                                                                                                                                       | 10/290 [00:02<00:49,  5.71it/s]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:04<00:05, 36.61it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:06<00:03, 41.40it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 209/290 [00:08<00:03, 20.50it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:10<00:01, 30.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.76it/s]
AUC score for epoch 3 : 0.7994844913482666
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:16,  2.84s/it]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:03,  4.34it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:06<00:00,  7.80it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:06<00:00,  7.80it/s]
train loss = 0.0006432924045449388
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:04<00:13, 19.54it/s]
 24%|█████████████████████████████████████████▊                                                                                                                                   | 70/290 [00:06<00:08, 27.41it/s]
 44%|████████████████████████████████████████████████████████████████████████████▌                                                                                               | 129/290 [00:08<00:03, 41.18it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:10<00:02, 41.52it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:12<00:00, 61.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.38it/s]
AUC score for epoch 4 : 0.7992734909057617
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01,  9.81it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.59it/s]
train loss = 0.0006262029377726971
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▉                                                                                                                                                                 | 20/290 [00:03<00:18, 14.44it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:05<00:09, 22.77it/s]
 46%|██████████████████████████████████████████████████████████████████████████████▎                                                                                             | 132/290 [00:07<00:03, 48.42it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:09<00:04, 21.46it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 247/290 [00:11<00:01, 22.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 13.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 20.31it/s]
AUC score for epoch 5 : 0.7997114062309265
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:04<00:01,  9.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.64it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.64it/s]
train loss = 0.0008552292025082611
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:02<00:13, 20.19it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:04<00:06, 30.87it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                                                | 154/290 [00:07<00:03, 40.03it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 199/290 [00:08<00:02, 41.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 57.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.28it/s]
AUC score for epoch 6 : 0.8008481860160828
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:01<00:02,  7.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.56it/s]
train loss = 0.0008027331142719569
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▉                                                                                                                                                                 | 20/290 [00:03<00:23, 11.70it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:05<00:11, 20.17it/s]
 42%|████████████████████████████████████████████████████████████████████████▎                                                                                                   | 122/290 [00:07<00:05, 32.16it/s]
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                           | 190/290 [00:09<00:02, 48.71it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:11<00:00, 53.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.13it/s]
AUC score for epoch 7 : 0.79966801404953
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:02<00:02,  6.36it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 10.48it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 10.48it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:03<00:08, 29.49it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:06<00:04, 40.83it/s]
 63%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                              | 184/290 [00:08<00:02, 46.55it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 249/290 [00:10<00:01, 38.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
AUC score for epoch 8 : 0.7990934252738953
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:49,  1.84s/it]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 14.49it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 14.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<12:56,  2.69s/it]
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:04<00:11, 20.22it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:06<00:03, 43.34it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:08<00:02, 31.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.12it/s]
AUC score for epoch 9 : 0.7992250919342041
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:14,  1.78it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:05<00:07,  2.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.15it/s]
train loss = 0.0007180089232861064
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:03<00:05, 40.40it/s]
 47%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 137/290 [00:05<00:03, 39.27it/s]
 58%|████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                       | 169/290 [00:07<00:06, 18.73it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 229/290 [00:09<00:01, 44.72it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:11<00:00, 52.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.93it/s]
AUC score for epoch 10 : 0.7978382706642151
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
train loss = 0.0005954370000316496
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:05<00:07, 30.94it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:07<00:04, 39.95it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:09<00:03, 35.14it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 234/290 [00:10<00:01, 44.25it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:12<00:00, 37.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 20.79it/s]
AUC score for epoch 11 : 0.7985578775405884
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:03,  5.82it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:04<00:00, 12.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.35it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 24%|█████████████████████████████████████████▏                                                                                                                                   | 69/290 [00:04<00:05, 37.38it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:06<00:04, 35.99it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:08<00:02, 46.13it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:10<00:02, 18.47it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 19.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.96it/s]
AUC score for epoch 12 : 0.7979453206062317
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:02<00:00, 22.17it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:02<00:00, 22.17it/s]
train loss = 0.000905564746062737
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|███████▏                                                                                                                                                                     | 12/290 [00:02<00:46,  6.00it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:04<00:06, 34.47it/s]
 46%|██████████████████████████████████████████████████████████████████████████████▉                                                                                             | 133/290 [00:06<00:04, 38.60it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 209/290 [00:08<00:01, 41.49it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:10<00:00, 40.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
AUC score for epoch 13 : 0.8004161715507507
Best AUC score is 0.8047065734863281
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:36,  1.35s/it]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01, 10.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.30it/s]
train loss = 0.0010052802057803742
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:04<00:07, 32.70it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:07<00:04, 34.80it/s]
 65%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                            | 188/290 [00:09<00:02, 42.08it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 256/290 [00:11<00:00, 42.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.91it/s]
AUC score for epoch 14 : 0.7982001304626465
Best AUC score is 0.8047065734863281
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:26,  1.00it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:02<00:02,  6.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.74it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:02<00:13, 19.42it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:04<00:04, 45.29it/s]
 47%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 137/290 [00:06<00:03, 41.45it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 223/290 [00:08<00:01, 47.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.74it/s]
AUC score for epoch 15 : 0.7989961504936218
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 173/197 [00:03<00:00, 163.14it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 173/197 [00:03<00:00, 163.14it/s]
################################
TOTAL EPOCH:  14
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 51.63it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:23,  1.08it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:11,  1.98it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:07<00:02,  3.51it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001142907902249135
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:15, 17.54it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:04<00:07, 28.02it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:06<00:01, 55.48it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:08<00:00, 68.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.75it/s]
AUC score for epoch 1 : 0.7989853024482727
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:09,  2.51it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:06,  2.83it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006397023202485538
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:03<00:07, 32.23it/s]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:05<00:05, 34.84it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:07<00:05, 28.53it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:09<00:00, 69.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.40it/s]
AUC score for epoch 2 : 0.7979224920272827
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:03<01:27,  3.25s/it]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:06<00:42,  1.69s/it]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:07<00:00, 15.01it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:07<00:00, 15.01it/s]
train loss = 0.0006389092595782131
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:02<00:10, 25.00it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:04<00:04, 38.28it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:07<00:01, 56.66it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 229/290 [00:09<00:01, 31.10it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:10<00:00, 39.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.58it/s]
AUC score for epoch 3 : 0.798283576965332
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:42,  1.56s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01, 10.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006484531799547508
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:03<00:08, 29.93it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:06<00:11, 17.14it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:07<00:04, 26.18it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:09<00:02, 38.90it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:11<00:00, 71.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.24it/s]
AUC score for epoch 4 : 0.7987753748893738
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:04<00:14,  1.64it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:06<00:03,  4.46it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:07<00:00, 11.11it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:07<00:00, 11.11it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:04<00:16, 15.19it/s]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:06<00:06, 32.08it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 199/290 [00:08<00:01, 67.79it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:10<00:00, 57.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.58it/s]
AUC score for epoch 5 : 0.7990023493766785
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:22,  1.14it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:05,  2.92it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:07<00:00,  4.38it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:07<00:00,  4.38it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  5%|████████▎                                                                                                                                                                    | 14/290 [00:02<00:32,  8.61it/s]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:04<00:03, 53.80it/s]
 53%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 153/290 [00:06<00:04, 33.14it/s]
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                  | 205/290 [00:08<00:01, 47.75it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:10<00:00, 57.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.42it/s]
AUC score for epoch 6 : 0.8010620474815369
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:03<00:03,  4.42it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00,  4.80it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00,  4.80it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|██████████████▉                                                                                                                                                              | 25/290 [00:02<00:16, 16.27it/s]
 41%|██████████████████████████████████████████████████████████████████████▌                                                                                                     | 119/290 [00:06<00:03, 50.00it/s]
 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                | 181/290 [00:07<00:02, 46.25it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:10<00:01, 44.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.18it/s]
AUC score for epoch 7 : 0.7908094525337219
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:19,  1.26it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:06<00:01,  5.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.37it/s]
train loss = 0.0011106122754946618
  0%|▌                                                                                                                                                                             | 1/290 [00:01<08:47,  1.82s/it]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:03<00:06, 34.74it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:05<00:02, 61.61it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 246/290 [00:07<00:01, 31.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.52it/s]
AUC score for epoch 8 : 0.791010320186615
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:09,  2.45it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:04<00:01,  5.38it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005740286152493874
  9%|████████████████                                                                                                                                                             | 27/290 [00:02<00:10, 24.38it/s]
 41%|███████████████████████████████████████████████████████████████████████▏                                                                                                    | 120/290 [00:04<00:04, 35.36it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:06<00:02, 34.74it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:08<00:01, 23.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.59it/s]
AUC score for epoch 9 : 0.7932047843933105
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:06<00:02,  6.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.74it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.74it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|███████▊                                                                                                                                                                     | 13/290 [00:02<00:43,  6.42it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:04<00:04, 43.85it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                                             | 160/290 [00:07<00:03, 36.34it/s]
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 269/290 [00:09<00:00, 73.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.93it/s]
AUC score for epoch 10 : 0.7938568592071533
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:05<00:11,  1.82it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.76it/s]
train loss = 0.0004817970610539695
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:03<00:08, 28.08it/s]
 33%|████████████████████████████████████████████████████████▋                                                                                                                    | 95/290 [00:05<00:07, 26.44it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 145/290 [00:07<00:04, 32.92it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:09<00:00, 64.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.94it/s]
AUC score for epoch 11 : 0.7944389581680298
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:12,  2.06it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:04<00:00, 11.79it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:04<00:00, 11.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|██████████████▎                                                                                                                                                              | 24/290 [00:02<00:12, 20.95it/s]
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:04<00:03, 59.33it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:06<00:01, 55.25it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:08<00:01, 32.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.66it/s]
AUC score for epoch 12 : 0.7948511838912964
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:06<00:01,  7.70it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000574770756689499
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:04<00:08, 27.11it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:06<00:02, 47.06it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                       | 224/290 [00:08<00:01, 44.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.16it/s]
AUC score for epoch 13 : 0.7955100536346436
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:04<00:02,  6.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
train loss = 0.000493022074806504
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 15%|██████████████████████████▏                                                                                                                                                  | 44/290 [00:03<00:07, 31.28it/s]
 48%|██████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 139/290 [00:05<00:02, 63.02it/s]
 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 215/290 [00:07<00:02, 29.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.05it/s]
AUC score for epoch 14 : 0.7957829236984253
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:43,  1.63s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.42it/s]
train loss = 0.0004944080636570496
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                    | 42/290 [00:03<00:12, 19.32it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:05<00:06, 29.44it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 178/290 [00:07<00:02, 43.29it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:09<00:00, 34.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.60it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.7959233522415161
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
 22%|██████████████████████████████████████▋                                                                                                                                      | 44/197 [00:02<00:05, 30.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 54.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 54.22it/s]
################################
TOTAL EPOCH:  15
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:09,  2.56s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:05<00:01,  8.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.96it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:03<00:06, 37.58it/s]
 44%|███████████████████████████████████████████████████████████████████████████▎                                                                                                | 127/290 [00:05<00:04, 36.81it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                      | 199/290 [00:06<00:02, 35.28it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:08<00:00, 71.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.00it/s]
AUC score for epoch 1 : 0.8015373945236206
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:03<00:16,  1.45it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:05<00:00, 10.19it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0010397018621525994
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:14, 18.60it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:04<00:03, 47.13it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 180/290 [00:06<00:02, 51.51it/s]
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 274/290 [00:08<00:00, 71.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.82it/s]
AUC score for epoch 2 : 0.7994456887245178
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:05<00:04,  3.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00, 13.26it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009807496951127956
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:02<00:09, 26.09it/s]
 36%|█████████████████████████████████████████████████████████████                                                                                                               | 103/290 [00:04<00:05, 34.57it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:06<00:02, 48.53it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:09<00:00, 70.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.12it/s]
AUC score for epoch 3 : 0.7993457317352295
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:03<00:07,  2.83it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:05<00:01,  6.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.68it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▊                                                                                                                                            | 55/290 [00:03<00:07, 31.98it/s]
 43%|██████████████████████████████████████████████████████████████████████████▏                                                                                                 | 125/290 [00:05<00:04, 38.23it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████                                                                            | 162/290 [00:06<00:03, 40.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
AUC score for epoch 4 : 0.8008206486701965
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:58,  2.16s/it]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:04<00:02,  6.75it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009186384517566434
 25%|██████████████████████████████████████████▉                                                                                                                                  | 72/290 [00:04<00:07, 28.86it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:05<00:02, 57.70it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:08<00:01, 41.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.91it/s]
AUC score for epoch 5 : 0.8008002042770386
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:05<00:04,  4.12it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:06<00:01,  5.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007774766210267055
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:02<00:10, 24.03it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:04<00:06, 31.67it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 180/290 [00:06<00:02, 47.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 59.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.64it/s]
AUC score for epoch 6 : 0.8026260137557983
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.67it/s]
train loss = 0.000722236317025298
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:03<00:05, 37.66it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 156/290 [00:05<00:02, 55.65it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:07<00:00, 83.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.55it/s]
AUC score for epoch 7 : 0.8001725077629089
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:04,  4.29it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.51it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.51it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|████▊                                                                                                                                                                         | 8/290 [00:03<01:26,  3.27it/s]
 33%|█████████████████████████████████████████████████████████▊                                                                                                                   | 97/290 [00:05<00:04, 40.94it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:06<00:02, 48.51it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:09<00:00, 34.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.01it/s]
AUC score for epoch 8 : 0.7999632358551025
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:11,  2.10it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:04<00:10,  1.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 25%|██████████████████████████████████████████▉                                                                                                                                  | 72/290 [00:02<00:03, 60.03it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:04<00:01, 66.28it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:06<00:00, 61.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.05it/s]
AUC score for epoch 9 : 0.8000789880752563
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:01<00:03,  6.49it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00,  8.86it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006684042039393846
 12%|█████████████████████▍                                                                                                                                                       | 36/290 [00:03<00:13, 18.79it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:04<00:04, 40.37it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:07<00:02, 43.17it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:08<00:00, 50.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.66it/s]
AUC score for epoch 10 : 0.7994304299354553
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:05<00:01,  9.21it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000536718731122424
  0%|▌                                                                                                                                                                             | 1/290 [00:02<11:29,  2.39s/it]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:04<00:04, 45.71it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 173/290 [00:06<00:01, 76.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.64it/s]
AUC score for epoch 11 : 0.799340546131134
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:07,  2.93it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.15it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007420959040505945
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:03<00:14, 17.71it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:05<00:06, 31.88it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:07<00:02, 34.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.78it/s]
AUC score for epoch 12 : 0.7993013858795166
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:04,  4.61it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.63it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005713480246153527
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:03<00:13, 18.64it/s]
 37%|██████████████████████████████████████████████████████████████▊                                                                                                             | 106/290 [00:05<00:04, 43.77it/s]
 69%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                     | 200/290 [00:07<00:01, 59.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.21it/s]
AUC score for epoch 13 : 0.8000556826591492
Best AUC score is 0.8047065734863281
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:23,  1.10it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:03<00:00, 10.46it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007062591040656636
 21%|███████████████████████████████████▊                                                                                                                                         | 60/290 [00:02<00:05, 44.19it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 157/290 [00:04<00:01, 82.25it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉       | 278/290 [00:06<00:00, 72.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.00it/s]
AUC score for epoch 14 : 0.8012591004371643
Best AUC score is 0.8047065734863281
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:02<00:01, 11.16it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006182581429519425
  0%|▌                                                                                                                                                                             | 1/290 [00:02<09:38,  2.00s/it]
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:03<00:12, 20.16it/s]
 47%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 137/290 [00:05<00:02, 61.05it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:07<00:01, 54.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.57it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8008894920349121
Best AUC score is 0.8047065734863281
BEST TEST AUC:  0.8047065734863281
Loading the best model
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                  | 139/197 [00:04<00:00, 96.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 40.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 40.08it/s]
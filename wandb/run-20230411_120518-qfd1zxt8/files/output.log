################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 23/25 [00:07<00:00, 12.73it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.25it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.37it/s]
AUC score for epoch 1 : 0.8000785112380981
Saving the best model
Best AUC score is 0.8000785112380981
Epoch 2

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.51it/s]
train loss = 0.9167868971824646
Performing evaluation of epoch 2



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.96it/s]
AUC score for epoch 2 : 0.8033207058906555
Saving the best model
Best AUC score is 0.8033207058906555
Epoch 3

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.7924215698242187



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.83it/s]
AUC score for epoch 3 : 0.8036221265792847
Saving the best model
Best AUC score is 0.8036221265792847
Epoch 4

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.81it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.5923552823066711




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.45it/s]
AUC score for epoch 4 : 0.8045089244842529
Saving the best model
Best AUC score is 0.8045089244842529
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.04it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.36339914679527285




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.92it/s]
AUC score for epoch 5 : 0.8043379187583923
Best AUC score is 0.8045089244842529
Epoch 6

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.50it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.19820329010486604




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.07it/s]
AUC score for epoch 6 : 0.8037468791007996
Best AUC score is 0.8045089244842529
Epoch 7

 92%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████              | 23/25 [00:05<00:00, 11.96it/s]
train loss = 0.09810054942965507
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.19it/s]



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.38it/s]
AUC score for epoch 7 : 0.8040674924850464
Best AUC score is 0.8045089244842529
Epoch 8


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.66it/s]
train loss = 0.04876866862177849
Performing evaluation of epoch 8




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.62it/s]
AUC score for epoch 8 : 0.8029972910881042
Best AUC score is 0.8045089244842529
Epoch 9

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.63it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.03450067296624184




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.30it/s]
AUC score for epoch 9 : 0.8035885691642761
Best AUC score is 0.8045089244842529
Epoch 10

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:05<00:00,  4.62it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.019946005418896674




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.01it/s]
AUC score for epoch 10 : 0.8033416271209717
Best AUC score is 0.8045089244842529
Epoch 11


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00, 13.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.10it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.09it/s]
AUC score for epoch 11 : 0.8026240468025208
Best AUC score is 0.8045089244842529
Epoch 12

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.59it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.011793385539203883




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.58it/s]
AUC score for epoch 12 : 0.8025563359260559
Best AUC score is 0.8045089244842529
Epoch 13

 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 19/25 [00:06<00:00, 10.11it/s]
train loss = 0.009948414545506238
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:07<00:00,  3.48it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 32.12it/s]
AUC score for epoch 13 : 0.804785966873169
Saving the best model
Best AUC score is 0.804785966873169
Epoch 14

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:03<00:00,  6.30it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.006869337167590857





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.23it/s]
AUC score for epoch 14 : 0.8032001852989197
Best AUC score is 0.804785966873169
Epoch 15

 76%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                         | 19/25 [00:03<00:00, 12.13it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 25/25 [00:04<00:00,  5.86it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.52it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8040577173233032
Best AUC score is 0.804785966873169
BEST TEST AUC:  0.804785966873169
Loading the best model

 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                    | 119/197 [00:02<00:00, 87.98it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 61.44it/s]

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.61it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.008418514775777501




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.97it/s]
AUC score for epoch 1 : 0.8047580718994141
Best AUC score is 0.804785966873169
Epoch 2

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.93it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.006832480347449226




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.90it/s]
AUC score for epoch 2 : 0.8042482137680054
Best AUC score is 0.804785966873169
Epoch 3

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00, 19.12it/s]
train loss = 0.00608701425205384
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.91it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.81it/s]
AUC score for epoch 3 : 0.8032913208007812
Best AUC score is 0.804785966873169
Epoch 4

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.91it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005785666156693229




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.40it/s]
AUC score for epoch 4 : 0.8040938377380371
Best AUC score is 0.804785966873169
Epoch 5


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.80it/s]
train loss = 0.003874793673665928
Performing evaluation of epoch 5



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.60it/s]
AUC score for epoch 5 : 0.8038551807403564
Best AUC score is 0.804785966873169
Epoch 6

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.69it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003598614047015352




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.34it/s]
AUC score for epoch 6 : 0.8042048811912537
Best AUC score is 0.804785966873169
Epoch 7


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.22it/s]
train loss = 0.0033763069908932914
Performing evaluation of epoch 7




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.50it/s]
AUC score for epoch 7 : 0.8030690550804138
Best AUC score is 0.804785966873169
Epoch 8



 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00,  9.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.20it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.26it/s]
AUC score for epoch 8 : 0.8035659790039062
Best AUC score is 0.804785966873169
Epoch 9

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002739985053527302




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.29it/s]
AUC score for epoch 9 : 0.8029084205627441
Best AUC score is 0.804785966873169
Epoch 10


 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:00, 12.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.29it/s]
AUC score for epoch 10 : 0.8029420375823975
Best AUC score is 0.804785966873169
Epoch 11


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.13it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005846726329764351




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.35it/s]
AUC score for epoch 11 : 0.8068810701370239
Saving the best model
Best AUC score is 0.8068810701370239
Epoch 12


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.20it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0022381612673468354




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.26it/s]
AUC score for epoch 12 : 0.8030127286911011
Best AUC score is 0.8068810701370239
Epoch 13


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.57it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002011551118422566




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.32it/s]
AUC score for epoch 13 : 0.8033782243728638
Best AUC score is 0.8068810701370239
Epoch 14



100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.98it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0017232887247311218




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.65it/s]
AUC score for epoch 14 : 0.8037189841270447
Best AUC score is 0.8068810701370239
Epoch 15

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.10it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0018264191707463137




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.74it/s]
AUC score for epoch 15 : 0.8036359548568726
Best AUC score is 0.8068810701370239
BEST TEST AUC:  0.8068810701370239
Loading the best model
Getting prediction on unlabelled dataset:

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 56.43it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
Epoch 1

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.66it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.002316830654828144




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.39it/s]
AUC score for epoch 1 : 0.8050873279571533
Best AUC score is 0.8068810701370239
Epoch 2

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.68it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001809728830786688




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.46it/s]
AUC score for epoch 2 : 0.8043217658996582
Best AUC score is 0.8068810701370239
Epoch 3


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.14it/s]
train loss = 0.0016859753564598837
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.42it/s]
AUC score for epoch 3 : 0.8042983412742615
Best AUC score is 0.8068810701370239
Epoch 4

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.75it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.003882531051723553




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.81it/s]
AUC score for epoch 4 : 0.8075968623161316
Saving the best model
Best AUC score is 0.8075968623161316
Epoch 5


 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 11.07it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.53it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.26it/s]
AUC score for epoch 5 : 0.8053756356239319
Best AUC score is 0.8075968623161316
Epoch 6

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.96it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001606959367303976





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.98it/s]
AUC score for epoch 6 : 0.8047828674316406
Best AUC score is 0.8075968623161316
Epoch 7


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.84it/s]
train loss = 0.0014408360792523517
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.31it/s]
AUC score for epoch 7 : 0.8044320344924927
Best AUC score is 0.8075968623161316
Epoch 8


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.49it/s]
train loss = 0.0015084241354738229
Performing evaluation of epoch 8




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.60it/s]
AUC score for epoch 8 : 0.804954469203949
Best AUC score is 0.8075968623161316
Epoch 9


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.99it/s]
train loss = 0.0017792828044288658
Performing evaluation of epoch 9




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.49it/s]
AUC score for epoch 9 : 0.8046379089355469
Best AUC score is 0.8075968623161316
Epoch 10

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0012933367231328572




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.33it/s]
AUC score for epoch 10 : 0.8054941892623901
Best AUC score is 0.8075968623161316
Epoch 11

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.53it/s]
train loss = 0.0013193980349959539
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.69it/s]
AUC score for epoch 11 : 0.8052874803543091
Best AUC score is 0.8075968623161316
Epoch 12


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.14it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0012561853945953771




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.68it/s]
AUC score for epoch 12 : 0.8051149845123291
Best AUC score is 0.8075968623161316
Epoch 13

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001288234958857564





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.82it/s]
AUC score for epoch 13 : 0.8051421642303467
Best AUC score is 0.8075968623161316
Epoch 14


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.12it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0018430973723297939





100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.23it/s]
AUC score for epoch 14 : 0.8051812648773193
Best AUC score is 0.8075968623161316
Epoch 15

100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.92it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0014040631899011455




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.40it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8049762845039368
Best AUC score is 0.8075968623161316
BEST TEST AUC:  0.8075968623161316
Loading the best model

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 69.00it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
Epoch 1


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.73it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0023518188952168983




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.51it/s]
AUC score for epoch 1 : 0.802355170249939
Best AUC score is 0.8075968623161316
Epoch 2


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.93it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0019269107599809235




100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.10it/s]
AUC score for epoch 2 : 0.804082453250885
Best AUC score is 0.8075968623161316
Epoch 3


 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 18.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:56,  1.44s/it]



100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.45it/s]
AUC score for epoch 3 : 0.8038157224655151
Best AUC score is 0.8075968623161316
Epoch 4


100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.32it/s]
train loss = 0.0015666052079593232
Performing evaluation of epoch 4
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:03<00:02, 60.38it/s]
 91%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏              | 265/290 [00:05<00:00, 72.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.23it/s]
AUC score for epoch 4 : 0.8036304712295532
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:04<00:01,  9.81it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001386765024757811
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:02<00:07, 32.88it/s]
 53%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 153/290 [00:04<00:01, 71.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:06<00:00, 88.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.69it/s]
AUC score for epoch 5 : 0.8044992685317993
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:04<00:08,  2.59it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0013803632485048314
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:02<00:13, 19.83it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████                                                                                      | 145/290 [00:04<00:02, 68.98it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 237/290 [00:06<00:00, 59.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.54it/s]
AUC score for epoch 6 : 0.8030239939689636
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:56,  2.10s/it]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:22,  1.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.11it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.00110084458719939
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:03<00:06, 32.97it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:05<00:02, 47.18it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:07<00:00, 70.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.82it/s]
AUC score for epoch 7 : 0.803183913230896
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:04<01:51,  4.14s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.86it/s]
  2%|███                                                                                                                                                                           | 5/290 [00:01<01:08,  4.13it/s]
  2%|███                                                                                                                                                                           | 5/290 [00:01<01:08,  4.13it/s]
 34%|███████████████████████████████████████████████████████████▎                                                                                                                | 100/290 [00:03<00:03, 61.49it/s]
 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 251/290 [00:05<00:00, 71.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.25it/s]
AUC score for epoch 8 : 0.7998080849647522
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:15,  2.81s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
  8%|█████████████                                                                                                                                                                | 22/290 [00:01<00:11, 23.56it/s]
  8%|█████████████                                                                                                                                                                | 22/290 [00:01<00:11, 23.56it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:03<00:02, 67.20it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                              | 211/290 [00:05<00:01, 73.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.37it/s]
AUC score for epoch 9 : 0.8023585081100464
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0015546990242520614
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:03<00:05, 34.80it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 186/290 [00:05<00:02, 42.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.41it/s]
AUC score for epoch 10 : 0.8050758838653564
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 12.58it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0011562845798575186
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:02<00:08, 30.93it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 191/290 [00:04<00:01, 73.07it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 275/290 [00:06<00:00, 49.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.68it/s]
AUC score for epoch 11 : 0.8041427731513977
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.56it/s]
train loss = 0.0015882177561122393
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:03<00:03, 49.73it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 212/290 [00:05<00:01, 69.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.01it/s]
AUC score for epoch 12 : 0.8035604953765869
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:20,  1.20it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 16.79it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009617106240641858
 26%|████████████████████████████████████████████▏                                                                                                                                | 74/290 [00:03<00:03, 57.43it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:05<00:02, 46.44it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:06<00:00, 94.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.38it/s]
AUC score for epoch 13 : 0.8051669597625732
Best AUC score is 0.8075968623161316
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:04<00:44,  1.70s/it]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:05<00:01,  8.31it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001163829500520868
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:02<00:08, 30.97it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:03<00:02, 62.33it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:06<00:01, 62.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.51it/s]
AUC score for epoch 14 : 0.8036171793937683
Best AUC score is 0.8075968623161316
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:26,  1.03it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:07,  3.26it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:05<00:00, 16.99it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0020903760887449607
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:03<00:02, 88.88it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:05<00:03, 33.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 42.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.47it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8039684295654297
Best AUC score is 0.8075968623161316
BEST TEST AUC:  0.8075968623161316
Loading the best model
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 68.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 68.94it/s]
################################
TOTAL EPOCH:  5
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.06it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:22,  1.32s/it]
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:22,  1.32s/it]
 22%|█████████████████████████████████████▌                                                                                                                                       | 63/290 [00:03<00:07, 29.77it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:05<00:03, 40.03it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:07<00:00, 83.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.60it/s]
AUC score for epoch 1 : 0.8079794645309448
Saving the best model
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:17,  1.40it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 15.42it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001774648853045489
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:03<00:03, 61.96it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                      | 171/290 [00:05<00:03, 32.94it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:07<00:00, 68.89it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.08it/s]
AUC score for epoch 2 : 0.8048135042190552
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:05<00:00,  8.05it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0015006342395541392
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:02<00:07, 32.78it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:04<00:01, 79.20it/s]
 94%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌         | 274/290 [00:06<00:00, 29.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.93it/s]
AUC score for epoch 3 : 0.8045550584793091
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.51it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.51it/s]
train loss = 0.002431871317509961
  4%|███████▏                                                                                                                                                                     | 12/290 [00:01<00:23, 12.02it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:03<00:03, 46.47it/s]
 92%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊              | 266/290 [00:05<00:00, 95.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.68it/s]
AUC score for epoch 4 : 0.8060579299926758
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.32it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.77it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:03<00:01, 88.07it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 234/290 [00:05<00:00, 71.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.29it/s]
AUC score for epoch 5 : 0.8018758893013
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:47,  1.74s/it]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:04,  4.27it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:04,  4.27it/s]
train loss = 0.0012648605833029641
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:02<00:02, 74.20it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:04<00:03, 36.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 38.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.75it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.75it/s]
AUC score for epoch 6 : 0.8033086657524109
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:54,  2.02s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01, 10.91it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01, 10.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.67it/s]
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:01<00:07, 33.01it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:03<00:02, 57.54it/s]
 98%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:05<00:00, 102.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 52.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 52.25it/s]
AUC score for epoch 7 : 0.8028705716133118
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:10,  2.33it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:10,  2.33it/s]
train loss = 0.0009573573936774794
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.82it/s]
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:01<00:10, 24.18it/s]
 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                      | 171/290 [00:03<00:01, 93.49it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:05<00:00, 69.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 48.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 48.03it/s]
AUC score for epoch 8 : 0.8029232025146484
Best AUC score is 0.8079794645309448
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:42,  1.57s/it]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01, 10.57it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01, 10.57it/s]
train loss = 0.0009550398161601541
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:02<00:19, 13.81it/s]
 52%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                                                 | 152/290 [00:04<00:01, 76.56it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:06<00:00, 96.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.74it/s]
AUC score for epoch 9 : 0.8034709692001343
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:01, 11.11it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:01, 11.11it/s]
train loss = 0.0016139960581702845
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:11, 22.07it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:04<00:02, 57.53it/s]
 93%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 269/290 [00:06<00:00, 64.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.48it/s]
AUC score for epoch 10 : 0.8044131994247437
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:08,  2.75it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00,  9.97it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00,  9.97it/s]
train loss = 0.0010650504056164728
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 28%|███████████████████████████████████████████████▋                                                                                                                             | 80/290 [00:02<00:03, 55.59it/s]
 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 222/290 [00:05<00:01, 60.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.95it/s]
AUC score for epoch 11 : 0.8064672350883484
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:02<00:06,  3.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.17it/s]
train loss = 0.001713568639908252
  4%|██████▌                                                                                                                                                                      | 11/290 [00:01<00:26, 10.36it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:03<00:01, 87.06it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:05<00:00, 90.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 47.93it/s]
AUC score for epoch 12 : 0.8055782914161682
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:02<00:03,  5.34it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00,  7.58it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00,  7.58it/s]
train loss = 0.003627648365051885
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:43,  1.40s/it]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:03<00:14, 16.68it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 175/290 [00:05<00:01, 84.92it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:07<00:00, 59.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.83it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.83it/s]
AUC score for epoch 13 : 0.8060451745986938
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 17.61it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:05<00:00, 17.61it/s]
train loss = 0.001808416553623309
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:02<00:05, 43.07it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                          | 164/290 [00:04<00:02, 60.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.13it/s]
AUC score for epoch 14 : 0.7990120649337769
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:17,  1.48it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 12.61it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 12.61it/s]
train loss = 0.0018265394069853105
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:03<00:06, 33.31it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:05<00:03, 45.19it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:07<00:01, 44.43it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:07<00:00, 81.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
AUC score for epoch 15 : 0.803145170211792
Best AUC score is 0.8079794645309448
BEST TEST AUC:  0.8079794645309448
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
################################
TOTAL EPOCH:  6
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 66.16it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:04<01:50,  4.10s/it]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:04<01:50,  4.10s/it]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|██████████████▎                                                                                                                                                              | 24/290 [00:01<00:14, 18.68it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                                             | 160/290 [00:03<00:01, 87.62it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:05<00:00, 71.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.88it/s]
AUC score for epoch 1 : 0.8071681261062622
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:02<00:07,  3.03it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:02<00:07,  3.03it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:01<00:10, 24.62it/s]
 42%|████████████████████████████████████████████████████████████████████████▎                                                                                                   | 122/290 [00:03<00:04, 40.03it/s]
 85%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                          | 246/290 [00:06<00:00, 63.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.07it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.07it/s]
AUC score for epoch 2 : 0.8039023876190186
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:29,  1.12s/it]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00,  9.23it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:05<00:00,  9.23it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.52it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:03<00:06, 36.51it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:04<00:02, 52.73it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 262/290 [00:06<00:00, 82.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.25it/s]
AUC score for epoch 3 : 0.804338812828064
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:01<00:03,  5.83it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 11.35it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 11.35it/s]
train loss = 0.0011513585736143536
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:02<00:06, 40.69it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:04<00:05, 28.84it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 262/290 [00:06<00:00, 93.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.95it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.95it/s]
AUC score for epoch 4 : 0.8037705421447754
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:02<00:03,  5.40it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:02<00:03,  5.40it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:02<00:09, 26.95it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 165/290 [00:04<00:02, 60.65it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:05<00:00, 54.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 46.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 46.09it/s]
AUC score for epoch 5 : 0.8032519221305847
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 13.06it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 13.06it/s]
train loss = 0.0010298657185298257
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|███████████████████████▎                                                                                                                                                     | 39/290 [00:03<00:08, 28.60it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:05<00:01, 77.16it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 249/290 [00:07<00:00, 59.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.96it/s]
AUC score for epoch 6 : 0.8036003708839417
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:30,  1.16s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 14.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 14.88it/s]
train loss = 0.0009402588413130226
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:02<00:05, 41.75it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:04<00:02, 53.93it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                    | 229/290 [00:06<00:00, 65.15it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:07<00:00, 73.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.88it/s]
AUC score for epoch 7 : 0.8032865524291992
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 15.67it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 15.67it/s]
train loss = 0.0009466877714398184
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:02<00:03, 60.55it/s]
 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                          | 219/290 [00:04<00:00, 91.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.98it/s]
AUC score for epoch 8 : 0.8032500743865967
Best AUC score is 0.8079794645309448
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:22,  1.23it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:03<00:00,  9.28it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:03<00:00,  9.28it/s]
train loss = 0.0011405372060835361
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:03<00:02, 69.45it/s]
 76%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                         | 220/290 [00:05<00:01, 38.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.64it/s]
AUC score for epoch 9 : 0.8040399551391602
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:08<00:00,  3.41it/s]
train loss = 0.0008934852189018524
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:02<00:02, 83.81it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 255/290 [00:04<00:00, 81.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 50.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 50.01it/s]
AUC score for epoch 10 : 0.8047120571136475
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:14,  1.71it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:06,  2.71it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:06,  2.71it/s]
train loss = 0.0012044568658373983
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 24%|█████████████████████████████████████████▏                                                                                                                                   | 69/290 [00:02<00:04, 48.10it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 178/290 [00:04<00:02, 42.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 46.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 46.41it/s]
AUC score for epoch 11 : 0.803127646446228
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 12.88it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 12.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.26it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▊                                                                                       | 143/290 [00:03<00:01, 87.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 55.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 55.17it/s]
AUC score for epoch 12 : 0.8031711578369141
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00, 18.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00, 18.87it/s]
train loss = 0.0009531865237347249
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 37%|██████████████████████████████████████████████████████████████▊                                                                                                             | 106/290 [00:03<00:03, 61.05it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 207/290 [00:04<00:01, 53.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.70it/s]
AUC score for epoch 13 : 0.8046805262565613
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:10,  2.35it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 12.89it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 12.89it/s]
train loss = 0.0009603729538087334
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 23%|████████████████████████████████████████▌                                                                                                                                    | 68/290 [00:02<00:06, 32.06it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 207/290 [00:05<00:01, 71.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.86it/s]
AUC score for epoch 14 : 0.8042570352554321
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:25,  1.02s/it]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001281381183486831
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:02<00:05, 38.57it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:04<00:01, 72.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:05<00:00, 48.54it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8046862483024597
Best AUC score is 0.8079794645309448
BEST TEST AUC:  0.8079794645309448
Loading the best model
 37%|████████████████████████████████████████████████████████████████                                                                                                             | 73/197 [00:01<00:01, 65.38it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                             | 73/197 [00:01<00:01, 65.38it/s]
################################
TOTAL EPOCH:  7
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 70.76it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:18,  1.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 15.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00, 15.95it/s]
train loss = 0.0020004982008166344
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 32%|██████████████████████████████████████████████████████▉                                                                                                                      | 92/290 [00:03<00:04, 47.96it/s]
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 213/290 [00:05<00:00, 84.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.46it/s]
AUC score for epoch 1 : 0.8039388060569763
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:07<00:01,  7.73it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:07<00:01,  7.73it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:02<00:09, 27.12it/s]
 57%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                         | 166/290 [00:04<00:01, 84.76it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 237/290 [00:06<00:01, 51.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.15it/s]
AUC score for epoch 2 : 0.8050129413604736
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:03<00:12,  1.86it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01,  5.75it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:04<00:01,  5.75it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████                                                                                                                                                          | 32/290 [00:02<00:08, 31.42it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:04<00:06, 32.59it/s]
 66%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                           | 190/290 [00:06<00:01, 51.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.54it/s]
AUC score for epoch 3 : 0.8048647046089172
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:03,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.05it/s]
train loss = 0.0011099977335626526
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|███████████████████████████████████▊                                                                                                                                         | 60/290 [00:05<00:06, 34.44it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:07<00:07, 23.39it/s]
 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 222/290 [00:09<00:01, 38.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.66it/s]
AUC score for epoch 4 : 0.8040838241577148
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:20,  1.24it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 12.89it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 12.89it/s]
train loss = 0.001077879051860821
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:02<00:05, 44.09it/s]
 47%|█████████████████████████████████████████████████████████████████████████████████▎                                                                                          | 137/290 [00:04<00:02, 51.60it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:06<00:00, 107.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.00it/s]
AUC score for epoch 5 : 0.8052150011062622
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.65it/s]
train loss = 0.0010394107188663579
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:01<00:16, 16.50it/s]
 44%|███████████████████████████████████████████████████████████████████████████▎                                                                                                | 127/290 [00:03<00:02, 56.97it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:05<00:00, 92.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.03it/s]
AUC score for epoch 6 : 0.8050441145896912
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:04<00:01,  8.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
train loss = 0.0012367885397647374
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:01<00:11, 23.05it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:03<00:01, 81.37it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:05<00:00, 56.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 42.36it/s]
AUC score for epoch 7 : 0.8047415614128113
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:10,  2.18it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:10,  2.18it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.29it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:02<00:04, 47.57it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:04<00:01, 87.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.67it/s]
AUC score for epoch 8 : 0.8054180145263672
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:18,  1.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.05it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.05it/s]
train loss = 0.000916386696709586
  0%|▌                                                                                                                                                                             | 1/290 [00:01<07:27,  1.55s/it]
 43%|█████████████████████████████████████████████████████████████████████████▌                                                                                                  | 124/290 [00:03<00:02, 62.97it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:05<00:01, 50.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.79it/s]
AUC score for epoch 9 : 0.8047091960906982
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.86it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.86it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:04<00:10, 23.74it/s]
 53%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 153/290 [00:06<00:02, 64.12it/s]
 89%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                   | 257/290 [00:08<00:00, 64.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.53it/s]
AUC score for epoch 10 : 0.8055012226104736
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:15,  1.64it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:04<00:00, 11.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0010227412421954796
 12%|████████████████████▉                                                                                                                                                        | 35/290 [00:02<00:07, 33.29it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:03<00:03, 60.38it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 180/290 [00:05<00:02, 37.92it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:07<00:00, 78.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.67it/s]
AUC score for epoch 11 : 0.8048349618911743
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:02,  5.47it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:02,  5.47it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:04<00:21, 12.62it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:06<00:05, 36.91it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:08<00:03, 40.28it/s]
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 201/290 [00:09<00:01, 44.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.31it/s]
AUC score for epoch 12 : 0.8048218488693237
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:02<00:02,  7.18it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008661893350238513
 21%|███████████████████████████████████▊                                                                                                                                         | 60/290 [00:03<00:07, 29.00it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:05<00:06, 30.70it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:07<00:01, 54.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.92it/s]
AUC score for epoch 13 : 0.8044319748878479
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:04<00:05,  3.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.60it/s]
train loss = 0.0008662978133153436
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:03<00:24, 11.16it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:05<00:08, 27.51it/s]
 46%|██████████████████████████████████████████████████████████████████████████████▎                                                                                             | 132/290 [00:07<00:04, 34.84it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                | 209/290 [00:09<00:01, 46.09it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:11<00:00, 33.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.97it/s]
AUC score for epoch 14 : 0.8049106597900391
Best AUC score is 0.8079794645309448
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:01<00:03,  6.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  8.27it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  8.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|██████▌                                                                                                                                                                      | 11/290 [00:02<00:32,  8.69it/s]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:03<00:04, 40.50it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:05<00:02, 49.33it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 207/290 [00:08<00:03, 23.43it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:09<00:00, 62.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.18it/s]
AUC score for epoch 15 : 0.8043633103370667
Best AUC score is 0.8079794645309448
BEST TEST AUC:  0.8079794645309448
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 171/197 [00:03<00:00, 102.23it/s]
 87%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 171/197 [00:03<00:00, 102.23it/s]
################################
TOTAL EPOCH:  8
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 47.90it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:02<00:00, 13.22it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0017101718840422109
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:02<00:09, 27.84it/s]
 39%|███████████████████████████████████████████████████████████████████▌                                                                                                        | 114/290 [00:04<00:03, 46.30it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                                                              | 158/290 [00:06<00:05, 26.09it/s]
 71%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                  | 205/290 [00:07<00:02, 39.81it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:09<00:00, 66.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.90it/s]
AUC score for epoch 1 : 0.8057073950767517
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00, 14.62it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00, 14.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.25it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:03<00:26, 10.19it/s]
 26%|████████████████████████████████████████████▏                                                                                                                                | 74/290 [00:05<00:06, 34.93it/s]
 53%|███████████████████████████████████████████████████████████████████████████████████████████▎                                                                                | 154/290 [00:07<00:03, 38.36it/s]
 76%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                          | 219/290 [00:09<00:02, 29.36it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:11<00:00, 73.55it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.57it/s]
AUC score for epoch 2 : 0.8040549755096436
Best AUC score is 0.8079794645309448
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:28,  1.04s/it]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 10.83it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 10.83it/s]
train loss = 0.0010428020427103288
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<13:00,  2.70s/it]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:04<00:08, 28.38it/s]
 38%|█████████████████████████████████████████████████████████████████▊                                                                                                          | 111/290 [00:06<00:04, 41.62it/s]
 62%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                | 181/290 [00:09<00:04, 26.16it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 247/290 [00:10<00:01, 28.64it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:12<00:00, 32.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.43it/s]
AUC score for epoch 3 : 0.8043206930160522
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:25,  1.02it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:04<00:00, 14.17it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:04<00:00, 14.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▉                                                                                                                                                                 | 20/290 [00:02<00:15, 17.42it/s]
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:04<00:12, 17.77it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:06<00:03, 41.20it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:08<00:02, 34.44it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:10<00:00, 54.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.39it/s]
AUC score for epoch 4 : 0.8038809299468994
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:02<00:00, 17.60it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:02<00:00, 17.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  8.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  8.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|████████████████                                                                                                                                                             | 27/290 [00:03<00:14, 18.46it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:05<00:06, 34.66it/s]
 48%|██████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 139/290 [00:07<00:05, 25.63it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:09<00:02, 42.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 57.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.90it/s]
AUC score for epoch 5 : 0.8026896119117737
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00, 14.16it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009398435171793348
  0%|▌                                                                                                                                                                             | 1/290 [00:02<12:23,  2.57s/it]
 24%|█████████████████████████████████████████▏                                                                                                                                   | 69/290 [00:04<00:07, 28.57it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:06<00:04, 29.51it/s]
 73%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                             | 213/290 [00:08<00:03, 24.81it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:10<00:00, 36.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.46it/s]
AUC score for epoch 6 : 0.803665280342102
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:05<00:20,  1.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.96it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:03<00:19, 13.52it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:06<00:08, 26.36it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:08<00:03, 39.81it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:10<00:01, 58.68it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:11<00:00, 58.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.27it/s]
AUC score for epoch 7 : 0.8024056553840637
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:02<00:04,  4.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.91it/s]
train loss = 0.0012696921767201275
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:03<00:10, 23.88it/s]
 35%|████████████████████████████████████████████████████████████▍                                                                                                               | 102/290 [00:05<00:05, 34.07it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                                                              | 158/290 [00:07<00:03, 35.11it/s]
 73%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 212/290 [00:09<00:03, 24.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.45it/s]
AUC score for epoch 8 : 0.8033692836761475
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:02<00:01, 11.38it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000827627896796912
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:04<00:09, 24.43it/s]
 48%|██████████████████████████████████████████████████████████████████████████████████▍                                                                                         | 139/290 [00:06<00:03, 44.43it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 203/290 [00:08<00:02, 41.09it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 258/290 [00:10<00:00, 36.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.93it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.93it/s]
AUC score for epoch 9 : 0.805852472782135
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:14,  1.78it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:03<00:00, 15.52it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:03<00:00, 15.52it/s]
train loss = 0.001280038891958871
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|█████████████████████████████▊                                                                                                                                               | 50/290 [00:03<00:09, 25.97it/s]
 33%|████████████████████████████████████████████████████████▋                                                                                                                    | 95/290 [00:04<00:08, 22.93it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:07<00:02, 44.52it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 262/290 [00:09<00:00, 50.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.31it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.31it/s]
AUC score for epoch 10 : 0.8019952178001404
Best AUC score is 0.8079794645309448
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:09,  2.70it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00, 13.27it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00, 13.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|█▊                                                                                                                                                                            | 3/290 [00:02<03:29,  1.37it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:04<00:06, 33.93it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:06<00:10, 17.38it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▏                                                                                    | 147/290 [00:07<00:07, 17.95it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:10<00:01, 41.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.44it/s]
AUC score for epoch 11 : 0.8004199862480164
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:12,  2.69s/it]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 15.54it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 15.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 32%|██████████████████████████████████████████████████████▉                                                                                                                      | 92/290 [00:03<00:03, 52.77it/s]
 52%|████████████████████████████████████████████████████████████████████████████████████████▉                                                                                   | 150/290 [00:05<00:02, 52.00it/s]
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 221/290 [00:07<00:01, 39.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.81it/s]
AUC score for epoch 12 : 0.8053228259086609
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:04<00:01,  9.50it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009053609444111187
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:04<00:10, 23.51it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:05<00:06, 30.64it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 156/290 [00:08<00:08, 15.36it/s]
 74%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                            | 215/290 [00:10<00:04, 16.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.78it/s]
AUC score for epoch 13 : 0.8040269613265991
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:03<00:12,  1.94it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.08it/s]
train loss = 0.0007709558859850014
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:03<00:05, 40.60it/s]
 46%|██████████████████████████████████████████████████████████████████████████████▉                                                                                             | 133/290 [00:05<00:04, 37.24it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                       | 196/290 [00:07<00:02, 31.51it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:09<00:00, 58.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.32it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.32it/s]
AUC score for epoch 14 : 0.8051189184188843
Best AUC score is 0.8079794645309448
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:17,  1.57it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00,  9.33it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:03<00:00,  9.33it/s]
train loss = 0.0008137996316820915
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|████▊                                                                                                                                                                         | 8/290 [00:02<01:05,  4.31it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:04<00:05, 42.08it/s]
 51%|███████████████████████████████████████████████████████████████████████████████████████▊                                                                                    | 148/290 [00:06<00:01, 76.48it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 247/290 [00:08<00:00, 58.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.12it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8029937744140625
Best AUC score is 0.8079794645309448
BEST TEST AUC:  0.8079794645309448
Loading the best model
 23%|███████████████████████████████████████▌                                                                                                                                     | 45/197 [00:02<00:04, 33.00it/s]
 23%|███████████████████████████████████████▌                                                                                                                                     | 45/197 [00:02<00:04, 33.00it/s]
################################
TOTAL EPOCH:  9
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 54.86it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:02,  2.33s/it]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.22it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.22it/s]
train loss = 0.0018329266022192314
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|██████▌                                                                                                                                                                      | 11/290 [00:03<00:51,  5.40it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:05<00:10, 22.65it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:06<00:08, 23.30it/s]
 57%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                         | 166/290 [00:09<00:04, 26.45it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 236/290 [00:11<00:01, 52.02it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 48.73it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.41it/s]
AUC score for epoch 1 : 0.8039750456809998
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 13.91it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 13.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.61it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.61it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:02<00:11, 22.25it/s]
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:04<00:11, 19.63it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:06<00:05, 28.46it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:09<00:05, 22.49it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:10<00:01, 33.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
AUC score for epoch 2 : 0.7957821488380432
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:34,  1.27s/it]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:03<00:02,  6.32it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
train loss = 0.00169346622923123
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:03<00:07, 31.53it/s]
 42%|████████████████████████████████████████████████████████████████████████▉                                                                                                   | 123/290 [00:05<00:07, 21.61it/s]
 67%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                         | 193/290 [00:07<00:02, 34.74it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:09<00:00, 46.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.74it/s]
AUC score for epoch 3 : 0.8023762106895447
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:01, 10.53it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007696582574031449
 11%|███████████████████                                                                                                                                                          | 32/290 [00:04<00:14, 17.87it/s]
 38%|█████████████████████████████████████████████████████████████████▏                                                                                                          | 110/290 [00:06<00:04, 41.54it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 165/290 [00:08<00:02, 50.62it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                 | 261/290 [00:10<00:00, 36.37it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.50it/s]
AUC score for epoch 4 : 0.8032987713813782
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:13,  1.80it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:04<00:00,  7.21it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007760266266164503
 12%|█████████████████████▍                                                                                                                                                       | 36/290 [00:02<00:07, 34.84it/s]
 27%|██████████████████████████████████████████████▌                                                                                                                              | 78/290 [00:04<00:08, 25.12it/s]
 46%|███████████████████████████████████████████████████████████████████████████████▍                                                                                            | 134/290 [00:06<00:03, 43.47it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:08<00:02, 38.02it/s]
 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                | 263/290 [00:10<00:00, 42.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.87it/s]
AUC score for epoch 5 : 0.8036888837814331
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:20,  1.35it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:29,  1.20s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:06<00:01,  9.27it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.00090628643270715
  6%|██████████▋                                                                                                                                                                  | 18/290 [00:02<00:24, 11.14it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:04<00:15, 14.54it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▊                                                                                       | 143/290 [00:06<00:02, 49.23it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 217/290 [00:08<00:01, 51.66it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 277/290 [00:10<00:00, 37.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.53it/s]
AUC score for epoch 6 : 0.8049800395965576
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:05<00:00,  9.95it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.66it/s]
train loss = 0.0009681352405875389
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|████████████████                                                                                                                                                             | 27/290 [00:03<00:15, 16.47it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:05<00:18, 12.54it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:07<00:09, 18.42it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:09<00:02, 38.35it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 270/290 [00:11<00:00, 60.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 24.11it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 24.11it/s]
AUC score for epoch 7 : 0.8059568405151367
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:03<00:02,  7.44it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.47it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.47it/s]
train loss = 0.0007365105370159394
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:03<00:14, 17.65it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:05<00:05, 37.35it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:07<00:11, 13.73it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:09<00:02, 41.17it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:11<00:00, 48.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.87it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.87it/s]
AUC score for epoch 8 : 0.8058403134346008
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:02<00:01, 10.01it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007099258655216545
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:03<00:08, 27.86it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:06<00:03, 48.67it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 195/290 [00:08<00:02, 33.21it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:09<00:00, 53.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.24it/s]
AUC score for epoch 9 : 0.8057831525802612
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:03<00:01, 10.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.17it/s]
train loss = 0.0007776837384361508
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:03<00:22, 12.13it/s]
 29%|██████████████████████████████████████████████████                                                                                                                           | 84/290 [00:05<00:05, 35.21it/s]
 44%|███████████████████████████████████████████████████████████████████████████▎                                                                                                | 127/290 [00:07<00:05, 28.20it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:09<00:01, 59.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 33.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.25it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.25it/s]
AUC score for epoch 10 : 0.8060658574104309
Best AUC score is 0.8079794645309448
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:09,  2.60it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:02,  5.48it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009387546098358664
 13%|███████████████████████▎                                                                                                                                                     | 39/290 [00:04<00:09, 27.46it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:06<00:06, 28.72it/s]
 52%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                                                 | 152/290 [00:08<00:03, 36.64it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:10<00:03, 26.23it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 256/290 [00:12<00:00, 43.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.19it/s]
AUC score for epoch 11 : 0.8058207631111145
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 12.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.22it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.22it/s]
train loss = 0.0021594237893753287
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|█▏                                                                                                                                                                            | 2/290 [00:03<07:21,  1.53s/it]
 18%|███████████████████████████████▌                                                                                                                                             | 53/290 [00:05<00:09, 25.50it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:07<00:03, 50.16it/s]
 65%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                            | 188/290 [00:09<00:02, 38.38it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 260/290 [00:11<00:00, 53.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.97it/s]
AUC score for epoch 12 : 0.805114209651947
Best AUC score is 0.8079794645309448
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:03<00:01, 11.10it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.76it/s]
train loss = 0.001131393669181437
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 18%|███████████████████████████████▌                                                                                                                                             | 53/290 [00:03<00:08, 27.18it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:05<00:02, 55.40it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:07<00:01, 43.77it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:09<00:00, 57.97it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.01it/s]
AUC score for epoch 13 : 0.809931218624115
Saving the best model
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:02<00:01, 10.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.38it/s]
train loss = 0.0007592890708890211
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|███████▏                                                                                                                                                                     | 12/290 [00:03<00:42,  6.52it/s]
 28%|████████████████████████████████████████████████▎                                                                                                                            | 81/290 [00:05<00:06, 32.95it/s]
 57%|██████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                         | 166/290 [00:07<00:02, 46.46it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:09<00:01, 44.68it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████         | 275/290 [00:11<00:00, 28.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.86it/s]
AUC score for epoch 14 : 0.8083082437515259
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:29,  1.11s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:03<00:01, 10.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.41it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.41it/s]
train loss = 0.0007743089185428939
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|██▍                                                                                                                                                                           | 4/290 [00:03<03:05,  1.55it/s]
 26%|█████████████████████████████████████████████▎                                                                                                                               | 76/290 [00:05<00:05, 40.41it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▋                                                                              | 158/290 [00:07<00:03, 40.10it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 230/290 [00:09<00:02, 29.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.14it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8068127632141113
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                                                            | 109/197 [00:02<00:00, 102.14it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▌                                                                            | 109/197 [00:02<00:00, 102.14it/s]
################################
TOTAL EPOCH:  10
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 55.55it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:28,  1.05s/it]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 16.06it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0009449573314798597
  0%|▌                                                                                                                                                                             | 1/290 [00:02<10:04,  2.09s/it]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:04<00:05, 39.76it/s]
 48%|█████████████████████████████████████████████████████████████████████████████████▊                                                                                          | 138/290 [00:06<00:04, 32.92it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:08<00:05, 17.77it/s]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 253/290 [00:10<00:00, 42.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.33it/s]
AUC score for epoch 1 : 0.8073943257331848
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:03<00:35,  1.38s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 15.21it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 15.21it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:15, 17.13it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:05<00:05, 35.09it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 151/290 [00:06<00:03, 38.22it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:09<00:05, 19.95it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 249/290 [00:11<00:01, 26.07it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:12<00:00, 41.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.91it/s]
AUC score for epoch 2 : 0.8057374358177185
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:19,  2.96s/it]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:05<01:06,  2.55s/it]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                | 15/28 [00:07<00:02,  5.45it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:09<00:00,  6.29it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:09<00:00,  6.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:09<00:00,  2.97it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▍                                                                                                                                                                        | 9/290 [00:03<01:11,  3.92it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:04<00:05, 41.53it/s]
 49%|████████████████████████████████████████████████████████████████████████████████████▏                                                                                       | 142/290 [00:07<00:03, 37.55it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:09<00:01, 50.23it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:10<00:00, 68.57it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.90it/s]
AUC score for epoch 3 : 0.8056932687759399
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:03<00:06,  3.60it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.76it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:05<00:24, 10.37it/s]
 31%|█████████████████████████████████████████████████████                                                                                                                        | 89/290 [00:07<00:07, 28.20it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:09<00:05, 27.18it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 252/290 [00:11<00:00, 66.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.39it/s]
AUC score for epoch 4 : 0.8052226901054382
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:03<01:24,  3.14s/it]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:05<00:02,  6.79it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00,  9.33it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:06<00:00,  9.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.77it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|███████▏                                                                                                                                                                     | 12/290 [00:03<00:55,  5.03it/s]
 28%|████████████████████████████████████████████████▎                                                                                                                            | 81/290 [00:05<00:06, 31.95it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:07<00:04, 36.30it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 186/290 [00:09<00:02, 35.32it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 240/290 [00:11<00:01, 28.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.60it/s]
AUC score for epoch 5 : 0.8044978976249695
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:02<00:10,  2.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 11.46it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006585177314783712
 16%|███████████████████████████▍                                                                                                                                                 | 46/290 [00:04<00:13, 17.46it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:06<00:03, 56.37it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 198/290 [00:08<00:02, 44.03it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                              | 239/290 [00:10<00:02, 18.23it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.64it/s]
AUC score for epoch 6 : 0.8048554062843323
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:06,  3.34it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.52it/s]
train loss = 0.0006121436817920767
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|████████████████                                                                                                                                                             | 27/290 [00:03<00:16, 15.86it/s]
 30%|███████████████████████████████████████████████████▎                                                                                                                         | 86/290 [00:05<00:04, 50.39it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:07<00:01, 72.46it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 255/290 [00:09<00:00, 35.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.09it/s]
AUC score for epoch 7 : 0.8048449754714966
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:04<00:16,  1.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.66it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 15%|█████████████████████████▋                                                                                                                                                   | 43/290 [00:04<00:11, 21.98it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:05<00:04, 40.48it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:07<00:02, 42.37it/s]
 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                             | 214/290 [00:10<00:02, 26.22it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.42it/s]
AUC score for epoch 8 : 0.804927408695221
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:46,  1.72s/it]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:04<00:01,  7.86it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007879557316690418
  0%|▌                                                                                                                                                                             | 1/290 [00:02<09:58,  2.07s/it]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:04<00:29,  8.89it/s]
 39%|███████████████████████████████████████████████████████████████████▌                                                                                                        | 114/290 [00:06<00:03, 55.70it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 180/290 [00:08<00:04, 23.22it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:10<00:00, 93.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.71it/s]
AUC score for epoch 9 : 0.804588258266449
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 46%|████████████████████████████████████████████████████████████████████████████████▊                                                                                             | 13/28 [00:04<00:01,  8.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.53it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:04<00:12, 18.87it/s]
 43%|██████████████████████████████████████████████████████████████████████████▏                                                                                                 | 125/290 [00:07<00:03, 46.31it/s]
 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 201/290 [00:09<00:03, 29.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.30it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.30it/s]
AUC score for epoch 10 : 0.8054158091545105
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:18,  1.39it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00, 14.55it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.001210208672481323
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:03<00:06, 36.39it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 151/290 [00:05<00:02, 67.98it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                         | 194/290 [00:08<00:03, 29.58it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                    | 256/290 [00:10<00:01, 30.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.65it/s]
AUC score for epoch 11 : 0.8079872131347656
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:06,  3.43it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007054473535390571
 18%|███████████████████████████████▌                                                                                                                                             | 53/290 [00:03<00:06, 35.48it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:06<00:07, 24.63it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:08<00:02, 40.90it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 270/290 [00:10<00:00, 49.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.43it/s]
AUC score for epoch 12 : 0.8066263198852539
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:07,  2.49s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.11it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007475211657167945
  1%|██▍                                                                                                                                                                           | 4/290 [00:03<03:04,  1.55it/s]
 24%|█████████████████████████████████████████▊                                                                                                                                   | 70/290 [00:05<00:09, 23.70it/s]
 37%|██████████████████████████████████████████████████████████████▊                                                                                                             | 106/290 [00:07<00:08, 20.84it/s]
 60%|██████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 173/290 [00:09<00:04, 25.50it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:11<00:02, 27.32it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:12<00:00, 60.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.41it/s]
AUC score for epoch 13 : 0.8040217161178589
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 57%|███████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                          | 16/28 [00:04<00:01,  8.84it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0010079419007524848
  1%|█▊                                                                                                                                                                            | 3/290 [00:04<05:09,  1.08s/it]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:06<00:10, 21.86it/s]
 41%|█████████████████████████████████████████████████████████████████████▉                                                                                                      | 118/290 [00:07<00:05, 32.10it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:09<00:08, 18.11it/s]
 77%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                        | 222/290 [00:11<00:01, 41.57it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:13<00:00, 39.76it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:14<00:00, 19.88it/s]
AUC score for epoch 14 : 0.8055832982063293
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:05<00:02,  5.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.35it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.35it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|██▍                                                                                                                                                                           | 4/290 [00:03<02:58,  1.60it/s]
 23%|███████████████████████████████████████▉                                                                                                                                     | 67/290 [00:05<00:06, 33.16it/s]
 34%|██████████████████████████████████████████████████████████▍                                                                                                                  | 98/290 [00:06<00:06, 30.31it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:08<00:03, 33.69it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:11<00:01, 40.39it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋  | 286/290 [00:13<00:00, 44.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 21.03it/s]
AUC score for epoch 15 : 0.805499255657196
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 28%|█████████████████████████████████████████████████▏                                                                                                                           | 56/197 [00:03<00:04, 33.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 39.92it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 39.92it/s]
################################
TOTAL EPOCH:  11
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:40,  1.50s/it]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:03<00:03,  4.62it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.33it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.33it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|██████▌                                                                                                                                                                      | 11/290 [00:04<00:49,  5.64it/s]
 32%|██████████████████████████████████████████████████████▉                                                                                                                      | 92/290 [00:06<00:04, 47.42it/s]
 56%|███████████████████████████████████████████████████████████████████████████████████████████████▍                                                                            | 161/290 [00:08<00:03, 33.77it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 217/290 [00:10<00:02, 27.71it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:11<00:00, 55.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.74it/s]
AUC score for epoch 1 : 0.8077278137207031
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:15,  1.64it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00,  7.59it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.005264163262576663
  0%|▌                                                                                                                                                                             | 1/290 [00:02<13:07,  2.73s/it]
 22%|██████████████████████████████████████▏                                                                                                                                      | 64/290 [00:04<00:07, 29.73it/s]
 44%|███████████████████████████████████████████████████████████████████████████▉                                                                                                | 128/290 [00:06<00:06, 26.53it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                    | 202/290 [00:08<00:02, 42.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.78it/s]
AUC score for epoch 2 : 0.8074405789375305
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:05<00:16,  1.39it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.88it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.88it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:04<00:12, 19.45it/s]
 38%|████████████████████████████████████████████████████████████████▋                                                                                                           | 109/290 [00:06<00:06, 29.38it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:08<00:09, 15.97it/s]
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 221/290 [00:10<00:01, 45.74it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:11<00:00, 55.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:13<00:00, 22.20it/s]
AUC score for epoch 3 : 0.8078286647796631
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:12,  1.92it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:03<00:00, 11.91it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000513057666207065
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:03<00:12, 20.20it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:05<00:07, 29.14it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:07<00:05, 29.06it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 203/290 [00:09<00:03, 28.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.78it/s]
AUC score for epoch 4 : 0.8057535290718079
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:01<00:06,  3.45it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.16it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  2%|████▏                                                                                                                                                                         | 7/290 [00:03<01:32,  3.06it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:05<00:06, 33.86it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:07<00:03, 47.08it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:09<00:01, 56.58it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 277/290 [00:11<00:00, 45.06it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.43it/s]
AUC score for epoch 5 : 0.8058679699897766
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:01,  8.25it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.83it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:03<00:06, 35.76it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:05<00:03, 45.63it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:07<00:02, 42.37it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 243/290 [00:09<00:01, 25.74it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 15.84it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.99it/s]
AUC score for epoch 6 : 0.8057976961135864
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:01<00:07,  3.07it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:04<00:00, 10.12it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<10:28,  2.17s/it]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<10:28,  2.17s/it]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:04<00:13, 17.09it/s]
 32%|███████████████████████████████████████████████████████▍                                                                                                                     | 93/290 [00:05<00:05, 33.75it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:07<00:03, 38.38it/s]
 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                           | 217/290 [00:09<00:01, 40.48it/s]
 87%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                      | 252/290 [00:11<00:01, 27.88it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.39it/s]
AUC score for epoch 7 : 0.8056992888450623
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:04<01:59,  4.43s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|███████████████████████████████████▊                                                                                                                                         | 60/290 [00:04<00:10, 22.68it/s]
 39%|██████████████████████████████████████████████████████████████████▍                                                                                                         | 112/290 [00:05<00:05, 30.70it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                   | 177/290 [00:08<00:02, 41.29it/s]
 80%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                 | 233/290 [00:09<00:02, 19.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.20it/s]
AUC score for epoch 8 : 0.8058667182922363
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:16,  1.57it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:03<00:00, 18.15it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007212929672927462
  6%|██████████▋                                                                                                                                                                  | 18/290 [00:02<00:24, 10.98it/s]
 25%|███████████████████████████████████████████▌                                                                                                                                 | 73/290 [00:04<00:08, 26.62it/s]
 55%|██████████████████████████████████████████████████████████████████████████████████████████████▉                                                                             | 160/290 [00:06<00:02, 43.72it/s]
 74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 216/290 [00:08<00:02, 29.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 32.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.45it/s]
AUC score for epoch 9 : 0.8079323768615723
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:16,  2.83s/it]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:04<00:00, 15.43it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0007059093020091366
  5%|████████▎                                                                                                                                                                    | 14/290 [00:03<00:40,  6.85it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:05<00:03, 50.32it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:07<00:03, 38.08it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:09<00:01, 32.94it/s]
 94%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉          | 273/290 [00:11<00:00, 33.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 23.61it/s]
AUC score for epoch 10 : 0.806851863861084
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:18,  1.39it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:03<00:00, 14.89it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.42it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.42it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 17%|████████████████████████████▋                                                                                                                                                | 48/290 [00:03<00:08, 29.12it/s]
 40%|█████████████████████████████████████████████████████████████████████▍                                                                                                      | 117/290 [00:05<00:08, 21.21it/s]
 63%|████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                               | 183/290 [00:07<00:02, 37.09it/s]
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 279/290 [00:09<00:00, 66.47it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.38it/s]
AUC score for epoch 11 : 0.8060815334320068
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 11.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005930970343927454
  9%|████████████████                                                                                                                                                             | 27/290 [00:03<00:15, 16.74it/s]
 39%|███████████████████████████████████████████████████████████████████                                                                                                         | 113/290 [00:05<00:03, 47.25it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                  | 178/290 [00:07<00:02, 49.07it/s]
 85%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                         | 247/290 [00:10<00:01, 36.79it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.20it/s]
AUC score for epoch 12 : 0.8061106204986572
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:03<00:01,  9.66it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  3%|█████▉                                                                                                                                                                       | 10/290 [00:02<00:41,  6.75it/s]
 29%|██████████████████████████████████████████████████▋                                                                                                                          | 85/290 [00:03<00:05, 37.17it/s]
 53%|██████████████████████████████████████████████████████████████████████████████████████████▋                                                                                 | 153/290 [00:05<00:02, 48.75it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:08<00:00, 54.49it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.64it/s]
AUC score for epoch 13 : 0.8061915040016174
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:02<00:06,  3.33it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:01,  7.70it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.95it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006620412043827985
 18%|███████████████████████████████                                                                                                                                              | 52/290 [00:03<00:06, 37.00it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:05<00:05, 31.78it/s]
 68%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                       | 197/290 [00:07<00:01, 51.79it/s]
 82%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 238/290 [00:09<00:02, 22.63it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.08it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 25.08it/s]
AUC score for epoch 14 : 0.8079760670661926
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 96%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊      | 27/28 [00:06<00:00, 16.01it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.30it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  2%|███                                                                                                                                                                           | 5/290 [00:03<02:19,  2.05it/s]
 24%|█████████████████████████████████████████▏                                                                                                                                   | 69/290 [00:05<00:07, 29.79it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:07<00:03, 41.67it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:09<00:01, 34.07it/s]
 96%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 277/290 [00:10<00:00, 46.64it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.48it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.48it/s]
AUC score for epoch 15 : 0.806902289390564
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                  | 85/197 [00:03<00:01, 77.86it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                  | 85/197 [00:03<00:01, 77.86it/s]
################################
TOTAL EPOCH:  12
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 42.30it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:28,  1.05s/it]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:03<00:02,  6.00it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:03<00:02,  6.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.85it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.85it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:03<00:24, 10.92it/s]
 31%|██████████████████████████████████████████████████████▎                                                                                                                      | 91/290 [00:05<00:06, 30.56it/s]
 54%|█████████████████████████████████████████████████████████████████████████████████████████████                                                                               | 157/290 [00:07<00:05, 26.02it/s]
 74%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                            | 216/290 [00:09<00:02, 29.28it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:10<00:00, 65.15it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.53it/s]
AUC score for epoch 1 : 0.797163188457489
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:03,  5.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.57it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.57it/s]
train loss = 0.001807751767046284
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 15%|█████████████████████████▋                                                                                                                                                   | 43/290 [00:03<00:08, 29.91it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:05<00:03, 57.04it/s]
 64%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 186/290 [00:07<00:02, 48.86it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                   | 258/290 [00:09<00:00, 46.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.86it/s]
AUC score for epoch 2 : 0.8041174411773682
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:04<00:00, 13.77it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 22/28 [00:04<00:00, 13.77it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.71it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  4%|███████▏                                                                                                                                                                     | 12/290 [00:03<00:50,  5.46it/s]
 18%|███████████████████████████████                                                                                                                                              | 52/290 [00:04<00:10, 22.86it/s]
 52%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                                                 | 152/290 [00:07<00:02, 64.06it/s]
 90%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                 | 260/290 [00:09<00:00, 58.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.17it/s]
AUC score for epoch 3 : 0.805666983127594
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:02<00:02,  8.31it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:02<00:02,  8.31it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.02it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.02it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|████████████████▋                                                                                                                                                            | 28/290 [00:03<00:14, 17.59it/s]
 35%|███████████████████████████████████████████████████████████▉                                                                                                                | 101/290 [00:05<00:05, 37.32it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 175/290 [00:07<00:02, 51.41it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 248/290 [00:09<00:01, 31.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.16it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.16it/s]
AUC score for epoch 4 : 0.8053821921348572
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:04,  4.16it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:05<00:04,  4.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.08it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.08it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  8%|█████████████▋                                                                                                                                                               | 23/290 [00:02<00:12, 20.57it/s]
 30%|███████████████████████████████████████████████████▉                                                                                                                         | 87/290 [00:04<00:04, 43.71it/s]
 50%|█████████████████████████████████████████████████████████████████████████████████████▍                                                                                      | 144/290 [00:06<00:03, 42.48it/s]
 76%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                         | 221/290 [00:08<00:01, 43.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.42it/s]
AUC score for epoch 5 : 0.8052600622177124
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:01, 10.53it/s]
 43%|██████████████████████████████████████████████████████████████████████████▌                                                                                                   | 12/28 [00:02<00:01, 10.53it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.28it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00,  7.28it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|████████████████████████████████▏                                                                                                                                            | 54/290 [00:03<00:08, 27.71it/s]
 48%|███████████████████████████████████████████████████████████████████████████████████                                                                                         | 140/290 [00:05<00:03, 41.95it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:07<00:00, 60.20it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:09<00:00, 36.59it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.09it/s]
AUC score for epoch 6 : 0.8054406046867371
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 14.76it/s]
 93%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌            | 26/28 [00:04<00:00, 14.76it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.83it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.83it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 15%|█████████████████████████▋                                                                                                                                                   | 43/290 [00:02<00:08, 27.61it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:04<00:06, 27.59it/s]
 59%|████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                       | 170/290 [00:07<00:03, 32.47it/s]
 82%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                               | 237/290 [00:09<00:01, 35.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.71it/s]
AUC score for epoch 7 : 0.8056884407997131
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:34,  1.29s/it]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:00, 12.69it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:00, 12.69it/s]
train loss = 0.0006995776077798967
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<11:55,  2.48s/it]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:04<00:03, 60.97it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                 | 180/290 [00:06<00:03, 35.80it/s]
 87%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                      | 253/290 [00:08<00:01, 35.05it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.42it/s]
AUC score for epoch 8 : 0.8083128929138184
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:03,  4.69it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:04<00:03,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.19it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:02<00:09, 26.49it/s]
 35%|███████████████████████████████████████████████████████████▉                                                                                                                | 101/290 [00:04<00:03, 49.49it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:06<00:02, 46.64it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:08<00:00, 78.20it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.02it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.02it/s]
AUC score for epoch 9 : 0.8069262504577637
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:15,  1.69it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:02<00:04,  4.75it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:04<00:00, 11.60it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:04<00:00, 11.60it/s]
train loss = 0.0005443959432471145
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|████████████████████████████                                                                                                                                                 | 47/290 [00:02<00:07, 34.36it/s]
 38%|████████████████████████████████████████████████████████████████▋                                                                                                           | 109/290 [00:03<00:04, 40.03it/s]
 67%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                        | 195/290 [00:06<00:01, 63.96it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:08<00:00, 46.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.94it/s]
AUC score for epoch 10 : 0.8065674304962158
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:14,  1.52it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:14,  1.52it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 19%|█████████████████████████████████▍                                                                                                                                           | 56/290 [00:02<00:05, 41.85it/s]
 47%|████████████████████████████████████████████████████████████████████████████████▋                                                                                           | 136/290 [00:04<00:02, 57.07it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                   | 204/290 [00:06<00:03, 25.36it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:08<00:00, 63.24it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.27it/s]
AUC score for epoch 11 : 0.8064872622489929
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:01<00:10,  2.41it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:04<00:00, 11.47it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:04<00:00, 11.47it/s]
train loss = 0.0005824049814171823
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:02<00:04, 49.79it/s]
 64%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                              | 185/290 [00:04<00:01, 55.26it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                  | 232/290 [00:06<00:02, 24.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 36.00it/s]
AUC score for epoch 12 : 0.8064080476760864
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:26,  1.04s/it]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:26,  1.04s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.96it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.96it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|███████████▎                                                                                                                                                                 | 19/290 [00:02<00:18, 14.92it/s]
 43%|█████████████████████████████████████████████████████████████████████████▌                                                                                                  | 124/290 [00:03<00:03, 49.76it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:05<00:01, 31.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.91it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.91it/s]
AUC score for epoch 13 : 0.8061183094978333
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:01,  9.45it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:01,  9.45it/s]
train loss = 0.0007675684360687488
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 23%|███████████████████████████████████████▎                                                                                                                                     | 66/290 [00:02<00:05, 42.30it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:04<00:01, 73.32it/s]
 92%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎             | 267/290 [00:06<00:00, 51.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.58it/s]
AUC score for epoch 14 : 0.8053481578826904
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:00, 14.98it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:00, 14.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.19it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:02<00:05, 41.10it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 207/290 [00:04<00:01, 74.35it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.50it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.50it/s]
AUC score for epoch 15 : 0.8050897717475891
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
 30%|████████████████████████████████████████████████████▋                                                                                                                        | 60/197 [00:01<00:02, 59.23it/s]
 30%|████████████████████████████████████████████████████▋                                                                                                                        | 60/197 [00:01<00:02, 59.23it/s]
################################
TOTAL EPOCH:  13
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 72.54it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:03<00:10,  2.15it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.04it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.04it/s]
train loss = 0.0009459570283070207
  7%|████████████▌                                                                                                                                                                | 21/290 [00:01<00:13, 20.43it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:03<00:03, 53.46it/s]
 81%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                 | 234/290 [00:05<00:00, 72.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.60it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.60it/s]
AUC score for epoch 1 : 0.8072506785392761
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:37,  1.37s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 10.20it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 10.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.91it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 18%|███████████████████████████████                                                                                                                                              | 52/290 [00:02<00:05, 43.11it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                          | 164/290 [00:04<00:02, 58.05it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:06<00:00, 60.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.56it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 43.56it/s]
AUC score for epoch 2 : 0.8061501979827881
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:00<00:09,  2.84it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:03<00:05,  3.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006562251208898877
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:04<00:03, 60.21it/s]
 66%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                          | 192/290 [00:06<00:01, 54.37it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 288/290 [00:07<00:00, 89.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.70it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.70it/s]
AUC score for epoch 3 : 0.8051092028617859
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006965058460731857
 12%|████████████████████▉                                                                                                                                                        | 35/290 [00:02<00:09, 26.26it/s]
 52%|████████████████████████████████████████████████████████████████████████████████████████▉                                                                                   | 150/290 [00:04<00:02, 53.06it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:06<00:00, 59.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.62it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.62it/s]
AUC score for epoch 4 : 0.8052340745925903
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 17.47it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 17.47it/s]
train loss = 0.0016090243557950348
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:03<00:15, 16.73it/s]
 51%|████████████████████████████████████████████████████████████████████████████████████████▎                                                                                   | 149/290 [00:05<00:01, 76.88it/s]
 74%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                             | 214/290 [00:07<00:01, 45.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.21it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.21it/s]
AUC score for epoch 5 : 0.8030337691307068
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00, 10.04it/s]
 71%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                 | 20/28 [00:03<00:00, 10.04it/s]
train loss = 0.000637605701090901
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|███████████████████▋                                                                                                                                                         | 33/290 [00:02<00:09, 28.52it/s]
 47%|████████████████████████████████████████████████████████████████████████████████                                                                                            | 135/290 [00:04<00:02, 63.60it/s]
 80%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                   | 231/290 [00:06<00:01, 41.28it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.77it/s]
AUC score for epoch 6 : 0.8036679625511169
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.24it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.24it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.29it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.29it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|█████████████████████████████████████▌                                                                                                                                       | 63/290 [00:03<00:05, 44.22it/s]
 60%|███████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                    | 175/290 [00:05<00:01, 66.67it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████      | 280/290 [00:07<00:00, 53.34it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.39it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.39it/s]
AUC score for epoch 7 : 0.8039348721504211
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:02<00:04,  4.89it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:02<00:04,  4.89it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  6%|█████████▌                                                                                                                                                                   | 16/290 [00:02<00:19, 14.22it/s]
 31%|█████████████████████████████████████████████████████▋                                                                                                                       | 90/290 [00:04<00:04, 44.08it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                 | 206/290 [00:06<00:01, 48.87it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:07<00:00, 36.86it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.94it/s]
AUC score for epoch 8 : 0.8041225671768188
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:04<00:01,  7.06it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:04<00:01,  7.06it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.58it/s]
  3%|████▊                                                                                                                                                                         | 8/290 [00:01<00:46,  6.11it/s]
 39%|███████████████████████████████████████████████████████████████████▌                                                                                                        | 114/290 [00:03<00:02, 68.26it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 240/290 [00:05<00:00, 58.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.41it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.41it/s]
AUC score for epoch 9 : 0.8043962121009827
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:01,  7.61it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:03<00:01,  7.61it/s]
train loss = 0.0008703739243043986
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                | 21/290 [00:02<00:12, 22.08it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:04<00:02, 63.61it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                    | 202/290 [00:06<00:02, 32.41it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:07<00:00, 72.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.26it/s]
AUC score for epoch 10 : 0.8050332069396973
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.46it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.46it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|▌                                                                                                                                                                             | 1/290 [00:02<09:55,  2.06s/it]
 30%|████████████████████████████████████████████████████▍                                                                                                                        | 88/290 [00:03<00:05, 37.58it/s]
 77%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                       | 223/290 [00:06<00:01, 66.09it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 40.40it/s]
AUC score for epoch 11 : 0.8070598244667053
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:02<00:02,  7.45it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006209468701854348
 17%|█████████████████████████████▊                                                                                                                                               | 50/290 [00:02<00:06, 39.48it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:04<00:04, 42.85it/s]
 68%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                      | 198/290 [00:05<00:01, 65.82it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.94it/s]
AUC score for epoch 12 : 0.8062177300453186
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 12.90it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:03<00:00, 12.90it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 11%|██████████████████▍                                                                                                                                                          | 31/290 [00:02<00:09, 27.07it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:04<00:03, 47.16it/s]
 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                     | 254/290 [00:06<00:00, 66.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.18it/s]
AUC score for epoch 13 : 0.8057029247283936
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:02<00:22,  1.15it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:04<00:00,  8.17it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:04<00:00,  8.17it/s]
train loss = 0.0006104741031387155
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|██████████████▉                                                                                                                                                              | 25/290 [00:02<00:17, 15.21it/s]
 28%|████████████████████████████████████████████████▎                                                                                                                            | 81/290 [00:04<00:08, 25.90it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 151/290 [00:06<00:03, 41.98it/s]
 90%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                | 262/290 [00:09<00:00, 60.18it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.13it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.13it/s]
AUC score for epoch 14 : 0.8063745498657227
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:25,  1.04it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:03<00:08,  2.49it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006271406372044501
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:01<00:08, 29.18it/s]
 35%|████████████████████████████████████████████████████████████▍                                                                                                               | 102/290 [00:04<00:08, 22.41it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                     | 227/290 [00:06<00:00, 73.71it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.96it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
AUC score for epoch 15 : 0.8051939606666565
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
 46%|███████████████████████████████████████████████████████████████████████████████▉                                                                                             | 91/197 [00:02<00:01, 81.77it/s]
 46%|███████████████████████████████████████████████████████████████████████████████▉                                                                                             | 91/197 [00:02<00:01, 81.77it/s]
################################
TOTAL EPOCH:  14
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 63.85it/s]
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 21%|█████████████████████████████████████▌                                                                                                                                         | 6/28 [00:04<00:09,  2.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 10.87it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00, 10.87it/s]
train loss = 0.0014054992809958225
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 26%|█████████████████████████████████████████████▎                                                                                                                               | 76/290 [00:03<00:04, 45.13it/s]
 61%|████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                   | 176/290 [00:05<00:01, 72.80it/s]
 98%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍   | 284/290 [00:07<00:00, 66.96it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.72it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.72it/s]
AUC score for epoch 1 : 0.8029782176017761
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:02<00:15,  1.66it/s]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:04<00:06,  3.00it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.58it/s]
train loss = 0.0006883042889447617
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|███████████████████████████████████▏                                                                                                                                         | 59/290 [00:03<00:07, 31.33it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:05<00:02, 42.81it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏           | 270/290 [00:07<00:00, 83.38it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.78it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.78it/s]
AUC score for epoch 2 : 0.8031166791915894
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 13.62it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 13.62it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▎                                                                                                                                                           | 29/290 [00:02<00:10, 24.32it/s]
 36%|██████████████████████████████████████████████████████████████▎                                                                                                             | 105/290 [00:03<00:04, 40.23it/s]
 63%|███████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                | 182/290 [00:06<00:02, 39.76it/s]
 99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:07<00:00, 104.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.99it/s]
AUC score for epoch 3 : 0.8043006062507629
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<01:15,  2.80s/it]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:04<00:00, 12.61it/s]
 64%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                              | 18/28 [00:04<00:00, 12.61it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  1%|█▊                                                                                                                                                                            | 3/290 [00:02<03:07,  1.53it/s]
 32%|████████████████████████████████████████████████████████                                                                                                                     | 94/290 [00:04<00:04, 43.63it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:06<00:03, 28.33it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:08<00:00, 38.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.53it/s]
AUC score for epoch 4 : 0.8050991296768188
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:07<00:01,  8.98it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:07<00:01,  8.98it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  5%|████████▉                                                                                                                                                                    | 15/290 [00:02<00:23, 11.83it/s]
 26%|█████████████████████████████████████████████▎                                                                                                                               | 76/290 [00:04<00:08, 25.92it/s]
 57%|█████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                          | 165/290 [00:06<00:02, 44.75it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:08<00:00, 70.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.98it/s]
AUC score for epoch 5 : 0.802558422088623
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:22,  1.09it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.20it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.20it/s]
train loss = 0.000653705297736451
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 27%|███████████████████████████████████████████████▏                                                                                                                             | 79/290 [00:03<00:05, 35.51it/s]
 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                 | 179/290 [00:05<00:02, 49.24it/s]
 88%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                    | 255/290 [00:07<00:00, 38.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.44it/s]
AUC score for epoch 6 : 0.8027081489562988
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:03<00:02,  6.26it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:03<00:02,  6.26it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.80it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  5.80it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:02<00:13, 19.45it/s]
 42%|███████████████████████████████████████████████████████████████████████▊                                                                                                    | 121/290 [00:04<00:03, 47.85it/s]
 71%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                 | 207/290 [00:06<00:02, 32.65it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.33it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.33it/s]
AUC score for epoch 7 : 0.8038018345832825
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 39%|████████████████████████████████████████████████████████████████████▎                                                                                                         | 11/28 [00:02<00:02,  7.98it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.59it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.59it/s]
train loss = 0.0009348782155679405
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:03<00:07, 31.53it/s]
 43%|█████████████████████████████████████████████████████████████████████████▌                                                                                                  | 124/290 [00:05<00:04, 34.36it/s]
 79%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                   | 230/290 [00:07<00:01, 56.63it/s]
 99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏ | 287/290 [00:08<00:00, 61.99it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.17it/s]
AUC score for epoch 8 : 0.8037000298500061
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:04<00:30,  1.22s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.69it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|████████████████                                                                                                                                                             | 27/290 [00:02<00:13, 18.82it/s]
 52%|█████████████████████████████████████████████████████████████████████████████████████████▌                                                                                  | 151/290 [00:04<00:02, 50.95it/s]
 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                            | 243/290 [00:06<00:01, 40.43it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.68it/s]
AUC score for epoch 9 : 0.8034089803695679
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:18,  1.42it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:03<00:00, 10.39it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:03<00:00, 10.39it/s]
train loss = 0.0006695770290597076
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:03<00:08, 26.94it/s]
 52%|██████████████████████████████████████████████████████████████████████████████████████████▏                                                                                 | 152/290 [00:04<00:02, 65.98it/s]
 83%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                             | 240/290 [00:07<00:00, 57.98it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.45it/s]
AUC score for epoch 10 : 0.8047844171524048
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00, 13.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00, 13.30it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.56it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:07<00:00,  3.56it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 22%|██████████████████████████████████████▊                                                                                                                                      | 65/290 [00:02<00:04, 48.01it/s]
 38%|█████████████████████████████████████████████████████████████████▊                                                                                                          | 111/290 [00:04<00:05, 29.91it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 218/290 [00:06<00:01, 49.19it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.53it/s]
AUC score for epoch 11 : 0.8030625581741333
Best AUC score is 0.809931218624115
 14%|█████████████████████████                                                                                                                                                      | 4/28 [00:01<00:06,  3.92it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:03<00:02,  5.92it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:03<00:02,  5.92it/s]
train loss = 0.0007347845540997307
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████▌                                                                                                                                          | 58/290 [00:02<00:06, 34.59it/s]
 43%|██████████████████████████████████████████████████████████████████████████▋                                                                                                 | 126/290 [00:04<00:03, 41.48it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:05<00:02, 43.53it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:08<00:00, 73.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.68it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.68it/s]
AUC score for epoch 12 : 0.8044601678848267
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:36,  1.36s/it]
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:04<00:14,  1.54it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.43it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.43it/s]
train loss = 0.000802638721194983
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  9%|███████████████▌                                                                                                                                                             | 26/290 [00:03<00:18, 14.61it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:05<00:01, 72.08it/s]
 96%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍      | 279/290 [00:07<00:00, 80.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 37.66it/s]
AUC score for epoch 13 : 0.8019890785217285
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 36%|██████████████████████████████████████████████████████████████▏                                                                                                               | 10/28 [00:03<00:04,  3.89it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005524571377983582
 14%|████████████████████████▍                                                                                                                                                    | 41/290 [00:02<00:07, 33.25it/s]
 45%|█████████████████████████████████████████████████████████████████████████████                                                                                               | 130/290 [00:04<00:03, 53.11it/s]
 70%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                   | 203/290 [00:06<00:02, 41.87it/s]
 86%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                       | 250/290 [00:08<00:02, 13.61it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.58it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.58it/s]
AUC score for epoch 14 : 0.802070140838623
Best AUC score is 0.809931218624115
  7%|████████████▌                                                                                                                                                                  | 2/28 [00:01<00:24,  1.06it/s]
 11%|██████████████████▊                                                                                                                                                            | 3/28 [00:03<00:34,  1.39s/it]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.78it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.78it/s]
train loss = 0.0006019107510967712
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 26%|████████████████████████████████████████████▏                                                                                                                                | 74/290 [00:02<00:04, 53.38it/s]
 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                               | 209/290 [00:05<00:00, 102.40it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.12it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 41.12it/s]
AUC score for epoch 15 : 0.8036049604415894
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
  1%|▉                                                                                                                                                                             | 1/197 [00:01<05:04,  1.55s/it]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 73.81it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:02<00:00, 73.81it/s]
################################
TOTAL EPOCH:  15
################################
Length of normal dataset:  878
Length of anomaly dataset:  878
Length of unlabelled dataset remaining:  197
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:06<00:00, 13.46it/s]
 82%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                               | 23/28 [00:06<00:00, 13.46it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 20%|██████████████████████████████████                                                                                                                                           | 57/290 [00:02<00:05, 44.03it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:04<00:02, 49.89it/s]
 79%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                    | 228/290 [00:07<00:01, 60.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.67it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.67it/s]
AUC score for epoch 1 : 0.8066230416297913
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:48,  1.80s/it]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:05<00:01,  8.91it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:06<00:00,  4.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 16%|██████████████████████████▊                                                                                                                                                  | 45/290 [00:02<00:08, 29.77it/s]
 36%|█████████████████████████████████████████████████████████████▋                                                                                                              | 104/290 [00:04<00:05, 32.78it/s]
 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                          | 218/290 [00:06<00:01, 71.14it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.36it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.36it/s]
AUC score for epoch 2 : 0.8068133592605591
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 86%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                        | 24/28 [00:05<00:00, 15.66it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.000606535464092823
 12%|████████████████████▎                                                                                                                                                        | 34/290 [00:02<00:12, 20.16it/s]
 46%|██████████████████████████████████████████████████████████████████████████████▎                                                                                             | 132/290 [00:04<00:03, 44.32it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                | 235/290 [00:06<00:00, 56.03it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.45it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.45it/s]
AUC score for epoch 3 : 0.8068498969078064
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:24,  1.09it/s]
 61%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                    | 17/28 [00:02<00:01, 10.78it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0008289517604030802
 10%|█████████████████▉                                                                                                                                                           | 30/290 [00:02<00:09, 26.64it/s]
 37%|███████████████████████████████████████████████████████████████▍                                                                                                            | 107/290 [00:04<00:03, 60.50it/s]
 81%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                | 236/290 [00:06<00:00, 57.01it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.90it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.90it/s]
AUC score for epoch 4 : 0.8064967393875122
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:03<00:05,  3.74it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0006053689534642867
 17%|█████████████████████████████▏                                                                                                                                               | 49/290 [00:04<00:10, 23.42it/s]
 37%|████████████████████████████████████████████████████████████████                                                                                                            | 108/290 [00:05<00:03, 56.92it/s]
 65%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                            | 189/290 [00:07<00:02, 49.14it/s]
 93%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋           | 271/290 [00:09<00:00, 59.46it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.52it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.52it/s]
AUC score for epoch 5 : 0.8074304461479187
Best AUC score is 0.809931218624115
  4%|██████▎                                                                                                                                                                        | 1/28 [00:00<00:22,  1.21it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:02<00:00, 12.72it/s]
 68%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                        | 19/28 [00:02<00:00, 12.72it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▍                                                                                                                                        | 61/290 [00:04<00:08, 26.01it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:06<00:01, 73.52it/s]
 98%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████   | 285/290 [00:08<00:00, 75.26it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.44it/s]
AUC score for epoch 6 : 0.8066068291664124
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
train loss = 0.0005957287991934988
 13%|██████████████████████▋                                                                                                                                                      | 38/290 [00:02<00:07, 34.77it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                        | 168/290 [00:03<00:01, 74.83it/s]
 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋     | 281/290 [00:06<00:00, 49.53it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.51it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 41.51it/s]
AUC score for epoch 7 : 0.8056515455245972
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 16.73it/s]
 75%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                           | 21/28 [00:03<00:00, 16.73it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 21%|████████████████████████████████████▉                                                                                                                                        | 62/290 [00:02<00:06, 37.86it/s]
 50%|██████████████████████████████████████████████████████████████████████████████████████▌                                                                                     | 146/290 [00:04<00:04, 34.48it/s]
 95%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋        | 276/290 [00:06<00:00, 90.29it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 39.27it/s]
AUC score for epoch 8 : 0.8056407570838928
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.17it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.17it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 18%|███████████████████████████████                                                                                                                                              | 52/290 [00:02<00:05, 44.77it/s]
 52%|████████████████████████████████████████████████████████████████████████████████████████▉                                                                                   | 150/290 [00:04<00:02, 69.50it/s]
 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎    | 282/290 [00:05<00:00, 98.77it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.10it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 45.10it/s]
AUC score for epoch 9 : 0.8043727278709412
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 29%|██████████████████████████████████████████████████                                                                                                                             | 8/28 [00:03<00:05,  3.99it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.16it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.16it/s]
train loss = 0.0005422968419484927
  3%|█████▍                                                                                                                                                                        | 9/290 [00:01<00:38,  7.28it/s]
 34%|███████████████████████████████████████████████████████████▎                                                                                                                | 100/290 [00:03<00:03, 54.28it/s]
 70%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                    | 202/290 [00:05<00:01, 68.08it/s]
 89%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                  | 259/290 [00:07<00:00, 35.17it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.85it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.85it/s]
AUC score for epoch 10 : 0.8043646216392517
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:01<00:43,  1.62s/it]
 32%|████████████████████████████████████████████████████████▎                                                                                                                      | 9/28 [00:04<00:05,  3.75it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.37it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  5.37it/s]
train loss = 0.0005474714562296867
 13%|██████████████████████                                                                                                                                                       | 37/290 [00:02<00:07, 33.29it/s]
 54%|████████████████████████████████████████████████████████████████████████████████████████████▌                                                                               | 156/290 [00:03<00:01, 71.95it/s]
 98%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊    | 283/290 [00:05<00:00, 74.66it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.94it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.94it/s]
AUC score for epoch 11 : 0.8047454953193665
Best AUC score is 0.809931218624115
 18%|███████████████████████████████▎                                                                                                                                               | 5/28 [00:01<00:06,  3.71it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00, 12.38it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:03<00:00, 12.38it/s]
train loss = 0.0006736663958041131
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:08,  1.28s/it]
 24%|██████████████████████████████████████████▎                                                                                                                                  | 71/290 [00:03<00:05, 38.04it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:05<00:03, 34.52it/s]
100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍| 289/290 [00:07<00:00, 55.44it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 38.42it/s]
AUC score for epoch 12 : 0.80454421043396
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
  4%|██████▎                                                                                                                                                                        | 1/28 [00:02<00:57,  2.12s/it]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 15.09it/s]
 89%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                  | 25/28 [00:05<00:00, 15.09it/s]
train loss = 0.0006900655862409621
  0%|▌                                                                                                                                                                             | 1/290 [00:01<06:07,  1.27s/it]
 34%|███████████████████████████████████████████████████████████                                                                                                                  | 99/290 [00:03<00:02, 67.23it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                        | 249/290 [00:05<00:00, 62.42it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:06<00:00, 44.27it/s]
AUC score for epoch 13 : 0.8054919242858887
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 25%|███████████████████████████████████████████▊                                                                                                                                   | 7/28 [00:05<00:07,  2.63it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.72it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:05<00:00,  4.72it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
  0%|                                                                                                                                                                                      | 0/290 [00:00<?, ?it/s]
 31%|█████████████████████████████████████████████████████▋                                                                                                                       | 90/290 [00:02<00:04, 49.94it/s]
 58%|███████████████████████████████████████████████████████████████████████████████████████████████████                                                                         | 167/290 [00:04<00:03, 32.09it/s]
 86%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                         | 248/290 [00:06<00:01, 31.69it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.27it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 34.27it/s]
AUC score for epoch 14 : 0.8049424886703491
Best AUC score is 0.809931218624115
  0%|                                                                                                                                                                                       | 0/28 [00:00<?, ?it/s]
 50%|███████████████████████████████████████████████████████████████████████████████████████                                                                                       | 14/28 [00:02<00:00, 14.19it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.68it/s]
100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:04<00:00,  6.68it/s]
train loss = 0.0007571541614847124
  9%|██████████████▉                                                                                                                                                              | 25/290 [00:01<00:11, 23.03it/s]
 25%|███████████████████████████████████████████▌                                                                                                                                 | 73/290 [00:03<00:07, 30.29it/s]
 56%|████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                           | 163/290 [00:05<00:01, 64.20it/s]
 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                      | 226/290 [00:07<00:01, 34.00it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.04it/s]
AUC score for epoch 15 : 0.8012860417366028
Best AUC score is 0.809931218624115
BEST TEST AUC:  0.809931218624115
Loading the best model
  0%|                                                                                                                                                                                      | 0/197 [00:00<?, ?it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 61.54it/s]
100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 197/197 [00:03<00:00, 61.54it/s]
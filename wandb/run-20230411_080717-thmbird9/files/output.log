################################
TOTAL EPOCH:  1
################################
Length of normal dataset:  800
Length of anomaly dataset:  800
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:05<00:00, 18.82it/s]
train loss = 0.8669114947319031
  0%|                                                                           | 0/290 [00:00<?, ?it/s]





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.92it/s]
AUC score for epoch 1 : 0.7982815504074097
Saving the best model
Best AUC score is 0.7982815504074097
Epoch 2


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 39.08it/s]
100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 20.17it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]






100%|█████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.93it/s]
AUC score for epoch 2 : 0.8035589456558228
Saving the best model
Best AUC score is 0.8035589456558228
Epoch 3

100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 20.90it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.08994477590546011




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.63it/s]
AUC score for epoch 3 : 0.8085812330245972
Saving the best model
Best AUC score is 0.8085812330245972
Epoch 4

100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 20.81it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.0339740681136027




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.98it/s]
AUC score for epoch 4 : 0.808181881904602
Best AUC score is 0.8085812330245972
Epoch 5


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 22.23it/s]
train loss = 0.025588456881232558
Performing evaluation of epoch 5





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.71it/s]
AUC score for epoch 5 : 0.810539186000824
Saving the best model
Best AUC score is 0.810539186000824
Epoch 6


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:05<00:00, 19.16it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.013064058147137984




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.73it/s]
AUC score for epoch 6 : 0.8105207681655884
Best AUC score is 0.810539186000824
Epoch 7


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 21.39it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.012331140393507667





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 26.31it/s]
AUC score for epoch 7 : 0.8126806616783142
Saving the best model
Best AUC score is 0.8126806616783142
Epoch 8


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 21.61it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.021045102676725946





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.81it/s]
AUC score for epoch 8 : 0.81645667552948
Saving the best model
Best AUC score is 0.81645667552948
Epoch 9


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 21.76it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.015913267105352135





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.63it/s]
AUC score for epoch 9 : 0.8154157400131226
Best AUC score is 0.81645667552948
Epoch 10


100%|█████████████████████████████████████████████████████████████████| 100/100 [00:04<00:00, 23.31it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.0107045556983212






100%|█████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.62it/s]
  0%|                                                                           | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.820410430431366
Saving the best model
Best AUC score is 0.820410430431366
BEST TEST AUC:  0.820410430431366
Loading the best model


100%|█████████████████████████████████████████████████████████████████| 197/197 [00:05<00:00, 37.20it/s]
################################
TOTAL EPOCH:  2
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.99it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.01619795280386738





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:12<00:00, 22.54it/s]
AUC score for epoch 1 : 0.8201755285263062
Best AUC score is 0.820410430431366
Epoch 2


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.44it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.004481944895260746





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.83it/s]
AUC score for epoch 2 : 0.8192586898803711
Best AUC score is 0.820410430431366
Epoch 3


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.98it/s]
train loss = 0.013859288787491443
  0%|                                                                           | 0/290 [00:00<?, ?it/s]




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.71it/s]
AUC score for epoch 3 : 0.8198584318161011
Best AUC score is 0.820410430431366
Epoch 4


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.74it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.002335065603533405






100%|█████████████████████████████████████████████████████████████████| 290/290 [00:11<00:00, 24.24it/s]
AUC score for epoch 4 : 0.8217747211456299
Saving the best model
Best AUC score is 0.8217747211456299
Epoch 5


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.16it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.003953099528804333





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.94it/s]
AUC score for epoch 5 : 0.8223924040794373
Saving the best model
Best AUC score is 0.8223924040794373
Epoch 6


 96%|██████████████████████████████████████████████████████████████▌  | 101/105 [00:05<00:00, 45.35it/s]
100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.36it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.65it/s]
AUC score for epoch 6 : 0.8185628056526184
Best AUC score is 0.8223924040794373
Epoch 7


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.49it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.003088819213388931




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 29.97it/s]
AUC score for epoch 7 : 0.8233228921890259
Saving the best model
Best AUC score is 0.8233228921890259
Epoch 8


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.81it/s]
train loss = 0.012320238466574145
Performing evaluation of epoch 8




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.15it/s]
AUC score for epoch 8 : 0.8256021738052368
Saving the best model
Best AUC score is 0.8256021738052368
Epoch 9


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.47it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.008594311952003322




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 28.84it/s]
AUC score for epoch 9 : 0.8212157487869263
Best AUC score is 0.8256021738052368
Epoch 10


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.45it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.003500688262699571




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.43it/s]
  0%|                                                                           | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.8249008655548096
Best AUC score is 0.8256021738052368
BEST TEST AUC:  0.8256021738052368
Loading the best model

100%|█████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 40.42it/s]
################################
TOTAL EPOCH:  3
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.61it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.006451014886399553




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.40it/s]
AUC score for epoch 1 : 0.8188024163246155
Best AUC score is 0.8256021738052368
Epoch 2


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 21.22it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.007683606165422437





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.54it/s]
AUC score for epoch 2 : 0.823066234588623
Best AUC score is 0.8256021738052368
Epoch 3


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:06<00:00, 17.49it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.006026115242691178




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.44it/s]
AUC score for epoch 3 : 0.8215185403823853
Best AUC score is 0.8256021738052368
Epoch 4

100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.60it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.012170434587391182




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 30.50it/s]
AUC score for epoch 4 : 0.8219369649887085
Best AUC score is 0.8256021738052368
Epoch 5



100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.68it/s]
train loss = 0.004306240521587564
  0%|                                                                           | 0/290 [00:00<?, ?it/s]





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.85it/s]
AUC score for epoch 5 : 0.8181807994842529
Best AUC score is 0.8256021738052368
Epoch 6


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.20it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.014644824825587594





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.53it/s]
AUC score for epoch 6 : 0.8258692622184753
Saving the best model
Best AUC score is 0.8258692622184753
Epoch 7


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.50it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.007981079511366607




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 32.80it/s]
AUC score for epoch 7 : 0.8206062316894531
Best AUC score is 0.8258692622184753
Epoch 8


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.94it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.0039598861810407554





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:09<00:00, 31.27it/s]
AUC score for epoch 8 : 0.8249114751815796
Best AUC score is 0.8258692622184753
Epoch 9


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 19.38it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.006062706938246265





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 27.79it/s]
AUC score for epoch 9 : 0.8222618699073792
Best AUC score is 0.8258692622184753
Epoch 10


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:04<00:00, 22.44it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.0037403740189758884





100%|█████████████████████████████████████████████████████████████████| 290/290 [00:10<00:00, 26.50it/s]
  0%|                                                                           | 0/197 [00:00<?, ?it/s]
AUC score for epoch 10 : 0.8227069973945618
Best AUC score is 0.8258692622184753
BEST TEST AUC:  0.8258692622184753
Loading the best model


100%|█████████████████████████████████████████████████████████████████| 197/197 [00:04<00:00, 41.73it/s]
################################
TOTAL EPOCH:  4
################################
Length of normal dataset:  839
Length of anomaly dataset:  839
Length of unlabelled dataset remaining:  197
Epoch 1


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.03it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.006143759259360931




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 35.12it/s]
AUC score for epoch 1 : 0.8230063915252686
Best AUC score is 0.8258692622184753
Epoch 2



100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 18.02it/s]
train loss = 0.005743050711489992
Performing evaluation of epoch 2




100%|█████████████████████████████████████████████████████████████████| 290/290 [00:07<00:00, 36.49it/s]
AUC score for epoch 2 : 0.8221908807754517
Best AUC score is 0.8258692622184753
Epoch 3


100%|█████████████████████████████████████████████████████████████████| 105/105 [00:05<00:00, 20.30it/s]
  0%|                                                                           | 0/290 [00:00<?, ?it/s]
train loss = 0.01020452209770502



100%|█████████████████████████████████████████████████████████████████| 290/290 [00:08<00:00, 33.39it/s]
AUC score for epoch 3 : 0.8217368721961975
Best AUC score is 0.8258692622184753
Epoch 4

  3%|█▊                                                              | 3/105 [05:25<3:04:41, 108.64s/it]
Traceback (most recent call last):
  File "main.py", line 289, in <module>
    best_auc, model = train_once(train_anomaly_dl, train_normal_dl, val_dl, train_bs, valid_bs, epochs, num_feats, curr_best_auc)
  File "main.py", line 141, in train_once
    loss = train(epoch, model, optimizer, device, [train_anomaly_dl, train_normal_dl], train_bs)
  File "main.py", line 33, in train
    for anomaly, normal in tqdm(zip(anomaly_dl, normal_dl), total=l):
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/tqdm/std.py", line 1178, in __iter__
    for obj in iterable:
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 628, in __next__
    data = self._next_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1316, in _next_data
    idx, data = self._get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1272, in _get_data
    success, data = self._try_get_data()
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1120, in _try_get_data
    data = self._data_queue.get(timeout=timeout)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/queue.py", line 179, in get
    self.not_empty.wait(remaining)
  File "/local/scratch/v_eshaan_mandal/miniconda3/envs/clip_feats/lib/python3.8/threading.py", line 306, in wait
    gotit = waiter.acquire(True, timeout)
KeyboardInterrupt